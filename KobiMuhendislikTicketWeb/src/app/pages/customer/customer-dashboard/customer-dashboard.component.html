<div class="customer-dashboard">
  <div class="page-header">
    <h1>
      <span class="welcome-text">Hoş Geldiniz</span>
      @if (currentUser?.companyName) {
        <span class="company-name">, {{ currentUser?.companyName }}</span>
      }
    </h1>
    <p>Destek taleplerinizi buradan takip edebilirsiniz.</p>
  </div>

  @if (isLoading) {
    <div class="loading-container">
      <div class="loading-spinner"></div>
      <p>Yükleniyor...</p>
    </div>
  } @else {
    <!-- Stats Cards -->
    <div class="stats-grid">
      <div class="stat-card total">
        <div class="stat-icon">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/>
            <polyline points="14 2 14 8 20 8"/>
          </svg>
        </div>
        <div class="stat-info">
          <span class="stat-value">{{ stats.totalTickets }}</span>
          <span class="stat-label">Toplam Ticket</span>
        </div>
      </div>

      <div class="stat-card open">
        <div class="stat-icon">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"/>
            <path d="M12 6v6l4 2"/>
          </svg>
        </div>
        <div class="stat-info">
          <span class="stat-value">{{ stats.openTickets }}</span>
          <span class="stat-label">Açık Ticket</span>
        </div>
      </div>

      <div class="stat-card progress">
        <div class="stat-icon">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M12 2v4M12 18v4M4.93 4.93l2.83 2.83M16.24 16.24l2.83 2.83M2 12h4M18 12h4M4.93 19.07l2.83-2.83M16.24 7.76l2.83-2.83"/>
          </svg>
        </div>
        <div class="stat-info">
          <span class="stat-value">{{ stats.inProgressTickets }}</span>
          <span class="stat-label">İşlemde</span>
        </div>
      </div>

      <div class="stat-card closed">
        <div class="stat-icon">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
            <polyline points="22 4 12 14.01 9 11.01"/>
          </svg>
        </div>
        <div class="stat-info">
          <span class="stat-value">{{ stats.closedTickets }}</span>
          <span class="stat-label">Çözüldü/Kapatıldı</span>
        </div>
      </div>

      <div class="stat-card assets">
        <div class="stat-icon">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="2" y="7" width="20" height="14" rx="2" ry="2"/>
            <path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"/>
          </svg>
        </div>
        <div class="stat-info">
          <span class="stat-value">{{ stats.totalAssets }}</span>
          <span class="stat-label">Varlıklarım</span>
        </div>
      </div>
    </div>

    <!-- Quick Actions -->
    <div class="quick-actions">
      <h2>Hızlı İşlemler</h2>
      <div class="actions-grid">
        <a routerLink="/customer/tickets/new" class="action-card">
          <div class="action-icon create">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"/>
              <line x1="12" y1="8" x2="12" y2="16"/>
              <line x1="8" y1="12" x2="16" y2="12"/>
            </svg>
          </div>
          <div class="action-info">
            <span class="action-title">Yeni Destek Talebi</span>
            <span class="action-desc">Yeni bir destek talebi oluşturun</span>
          </div>
        </a>

        <a routerLink="/customer/tickets" class="action-card">
          <div class="action-icon tickets">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/>
              <polyline points="14 2 14 8 20 8"/>
              <line x1="16" y1="13" x2="8" y2="13"/>
              <line x1="16" y1="17" x2="8" y2="17"/>
            </svg>
          </div>
          <div class="action-info">
            <span class="action-title">Taleplerim</span>
            <span class="action-desc">Tüm taleplerinizi görüntüleyin</span>
          </div>
        </a>

        <a routerLink="/customer/assets" class="action-card">
          <div class="action-icon assets">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="2" y="7" width="20" height="14" rx="2" ry="2"/>
              <path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"/>
            </svg>
          </div>
          <div class="action-info">
            <span class="action-title">Varlıklarım</span>
            <span class="action-desc">Kayıtlı varlıklarınızı görün</span>
          </div>
        </a>
      </div>
    </div>

    <!-- Recent Tickets -->
    <div class="recent-tickets">
      <div class="section-header">
        <h2>Son Taleplerim</h2>
        <a routerLink="/customer/tickets" class="view-all">Tümünü Gör</a>
      </div>

      @if (recentTickets.length === 0) {
        <div class="empty-state">
          <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
            <path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/>
            <polyline points="14 2 14 8 20 8"/>
          </svg>
          <p>Henüz destek talebiniz bulunmuyor.</p>
          <a routerLink="/customer/tickets/new" class="btn-primary">Yeni Talep Oluştur</a>
        </div>
      } @else {
        <div class="tickets-table">
          <table>
            <thead>
              <tr>
                <th>Başlık</th>
                <th>Durum</th>
                <th>Öncelik</th>
                <th>Tarih</th>
                <th></th>
              </tr>
            </thead>
            <tbody>
              @for (ticket of recentTickets; track ticket.id) {
                <tr>
                  <td class="ticket-title">{{ ticket.title }}</td>
                  <td>
                    <span class="badge" [ngClass]="getStatusClass(ticket.status)">
                      {{ ticket.status }}
                    </span>
                  </td>
                  <td>
                    <span class="badge" [ngClass]="getPriorityClass(ticket.priority)">
                      {{ ticket.priority }}
                    </span>
                  </td>
                  <td class="date">{{ ticket.createdAt | date:'dd.MM.yyyy' }}</td>
                  <td class="action">
                    <a [routerLink]="['/customer/tickets', ticket.id]" class="btn-view">Detay</a>
                  </td>
                </tr>
              }
            </tbody>
          </table>
        </div>

        <div class="tickets-cards">
          @for (ticket of recentTickets; track ticket.id) {
            <div class="ticket-card">
              <div class="ticket-card-header">
                <h3 class="ticket-card-title">{{ ticket.title }}</h3>
                <span class="badge" [ngClass]="getStatusClass(ticket.status)">
                  {{ ticket.status }}
                </span>
              </div>

              <div class="ticket-card-meta">
                <div class="meta-item">
                  <span class="meta-label">Öncelik</span>
                  <span class="badge" [ngClass]="getPriorityClass(ticket.priority)">
                    {{ ticket.priority }}
                  </span>
                </div>
                <div class="meta-item">
                  <span class="meta-label">Tarih</span>
                  <span class="meta-value">{{ ticket.createdAt | date:'dd.MM.yyyy' }}</span>
                </div>
              </div>

              <div class="ticket-card-actions">
                <a [routerLink]="['/customer/tickets', ticket.id]" class="btn-view">Detay</a>
              </div>
            </div>
          }
        </div>
      }
    </div>
  }
</div>
