import './polyfills.server.mjs';
import{a as Q}from"./chunk-URJ5WDQA.mjs";import{a as X}from"./chunk-O7OTTCDM.mjs";import{a as J}from"./chunk-LV727ALH.mjs";import"./chunk-2ZDBELSD.mjs";import{k as K,n as q}from"./chunk-RBKH3TAP.mjs";import{G as V,Ma as b,Na as u,Oa as z,Pa as T,Qa as W,Ra as O,Ta as y,V as L,Va as G,Wa as M,Xa as k,Ya as n,Za as r,_a as m,da as g,db as h,e as U,ea as D,fc as H,ic as Y,jb as l,kb as x,lb as f,oa as B,sb as j,ub as $,ya as o,za as w}from"./chunk-Q22LFSCO.mjs";import{a as N,b as R}from"./chunk-VVCT4QZE.mjs";var at=(a,d)=>d.title,Z=(a,d)=>d.label,tt=(a,d)=>d.id,et=a=>["/admin/tickets",a];function rt(a,d){a&1&&(n(0,"div",4),m(1,"div",5),n(2,"p"),l(3,"Veriler y\xFCkleniyor..."),r()())}function ot(a,d){if(a&1&&(n(0,"div",6),l(1),r()),a&2){let t=h(2);o(),f(" ",t.errorMessage," ")}}function lt(a,d){a&1&&(g(),n(0,"svg",44),m(1,"path",45)(2,"polyline",46),r())}function ct(a,d){a&1&&(g(),n(0,"svg",44),m(1,"circle",47)(2,"line",48)(3,"line",49),r())}function st(a,d){a&1&&(g(),n(0,"svg",44),m(1,"path",50)(2,"path",51)(3,"path",52)(4,"path",53)(5,"path",54)(6,"path",55)(7,"path",56)(8,"path",57),r())}function dt(a,d){a&1&&(g(),n(0,"svg",44),m(1,"path",58)(2,"polyline",59),r())}function mt(a,d){a&1&&(g(),n(0,"svg",44),m(1,"path",60)(2,"circle",61)(3,"path",62)(4,"path",63),r())}function gt(a,d){a&1&&(g(),n(0,"svg",33),m(1,"polyline",65)(2,"polyline",66),r())}function pt(a,d){a&1&&(g(),n(0,"svg",33),m(1,"polyline",67)(2,"polyline",68),r())}function ht(a,d){if(a&1&&(n(0,"div",64),b(1,gt,3,0,":svg:svg",33)(2,pt,3,0),n(3,"span"),l(4),r()()),a&2){let t=h().$implicit;W("increase",t.changeType==="increase")("decrease",t.changeType==="decrease"),o(),y(1,t.changeType==="increase"?1:2),o(3),f("%",t.change,"")}}function ut(a,d){if(a&1&&(n(0,"div",38)(1,"div",39),b(2,lt,3,0)(3,ct,4,0)(4,st,9,0)(5,dt,3,0)(6,mt,5,0),r(),n(7,"div",40)(8,"span",41),l(9),r(),n(10,"span",42),l(11),r()(),b(12,ht,5,6,"div",43),r()),a&2){let t,e=d.$implicit;O("stat-card--"+e.color),o(2),y(2,(t=e.icon)==="ticket"?2:t==="open"?3:t==="processing"?4:t==="resolved"?5:t==="users"?6:-1),o(7),x(e.title),o(2),x(e.value),o(),y(12,e.change>0?12:-1)}}function xt(a,d){if(a&1&&(g(),m(0,"line",69),n(1,"text",70),l(2),r()),a&2){let t=d.$implicit,e=h(2);u("y1",180-t*150/5)("y2",180-t*150/5),o(),u("y",185-t*150/5),o(),x(e.getMonthlyScaleValue(t))}}function ft(a,d){if(a&1&&(g(),n(0,"text",72),l(1),r()),a&2){let t=h(),e=t.$implicit,i=t.$index,c=h(2);u("x",50+i*52+13)("y",180-e.opened*c.getMonthlyPixelPerUnit()-5),o(),f(" ",e.opened," ")}}function _t(a,d){if(a&1&&(g(),n(0,"text",73),l(1),r()),a&2){let t=h(),e=t.$implicit,i=t.$index,c=h(2);u("x",50+i*52+26)("y",180-e.resolved*c.getMonthlyPixelPerUnit()-5),o(),f(" ",e.resolved," ")}}function bt(a,d){if(a&1&&(g(),n(0,"g"),m(1,"rect",71),b(2,ft,2,3,":svg:text",72),m(3,"rect",71),b(4,_t,2,3,":svg:text",73),n(5,"text",74),l(6),r()()),a&2){let t=d.$implicit,e=d.$index,i=h(2);u("data-index",e),o(),u("x",50+e*52+8)("y",180-t.opened*i.getMonthlyPixelPerUnit())("width",10)("height",t.opened*i.getMonthlyPixelPerUnit())("fill","url(#openGradient)")("rx",2),o(),y(2,t.opened>0?2:-1),o(),u("x",50+e*52+21)("y",180-t.resolved*i.getMonthlyPixelPerUnit())("width",10)("height",t.resolved*i.getMonthlyPixelPerUnit())("fill","url(#resolvedGradient)")("rx",2),o(),y(4,t.resolved>0?4:-1),o(),u("x",50+e*52+15),o(),f(" ",t.label," ")}}function yt(a,d){if(a&1&&(g(),m(0,"line",69),n(1,"text",70),l(2),r()),a&2){let t=d.$implicit,e=h(2);u("y1",180-t*150/7)("y2",180-t*150/7),o(),u("y",185-t*150/7),o(),x(e.getWeeklyScaleValue(t))}}function Ct(a,d){if(a&1&&(g(),n(0,"text",75),l(1),r()),a&2){let t=h(),e=t.$implicit,i=t.$index,c=h(2);u("x",50+i*60+15)("y",180-e.opened*c.getWeeklyPixelPerUnit()-5),o(),f(" ",e.opened," ")}}function vt(a,d){if(a&1&&(g(),n(0,"text",76),l(1),r()),a&2){let t=h(),e=t.$implicit,i=t.$index,c=h(2);u("x",50+i*60+33)("y",180-e.resolved*c.getWeeklyPixelPerUnit()-5),o(),f(" ",e.resolved," ")}}function Mt(a,d){if(a&1&&(g(),n(0,"g"),m(1,"rect",71),b(2,Ct,2,3,":svg:text",75),m(3,"rect",71),b(4,vt,2,3,":svg:text",76),n(5,"text",77),l(6),r()()),a&2){let t=d.$implicit,e=d.$index,i=h(2);u("data-index",e),o(),u("x",50+e*60+8)("y",180-t.opened*i.getWeeklyPixelPerUnit())("width",14)("height",t.opened*i.getWeeklyPixelPerUnit())("fill","url(#openGradient2)")("rx",2),o(),y(2,t.opened>0?2:-1),o(),u("x",50+e*60+26)("y",180-t.resolved*i.getWeeklyPixelPerUnit())("width",14)("height",t.resolved*i.getWeeklyPixelPerUnit())("fill","url(#resolvedGradient2)")("rx",2),o(),y(4,t.resolved>0?4:-1),o(),u("x",50+e*60+25),o(),x(t.label)}}function kt(a,d){a&1&&(n(0,"div",37),g(),n(1,"svg",78),m(2,"path",45)(3,"polyline",46),r(),D(),n(4,"p"),l(5,"Hen\xFCz ticket bulunmuyor."),r()())}function St(a,d){if(a&1&&(n(0,"tr")(1,"td")(2,"span",82),l(3),r()(),n(4,"td"),l(5),r(),n(6,"td"),l(7),r(),n(8,"td")(9,"span",83),l(10),r()(),n(11,"td")(12,"span",83),l(13),r()(),n(14,"td"),l(15),r(),n(16,"td")(17,"a",84),l(18," Detay "),r()()()),a&2){let t=d.$implicit,e=h(3);o(3),x(e.formatTicketId(t.id,t.ticketCode)),o(2),x(t.title),o(2),x(t.tenantName||"Bilinmiyor"),o(2),O("badge--"+e.getStatusClass(t.status)),T("background-color",e.getStatusColor(t.status))("color",e.getStatusColor(t.status)?"#fff":null),o(),f(" ",e.getStatusText(t.status)," "),o(2),O("badge--"+e.getPriorityClass(t.priority)),T("background-color",e.getPriorityColor(t.priority))("color",e.getPriorityColor(t.priority)?"#fff":null),o(),f(" ",e.getPriorityText(t.priority)," "),o(2),x(e.formatDate(t.createdDate)),o(2),z("routerLink",$(19,et,t.id))}}function Pt(a,d){if(a&1&&(n(0,"div",81)(1,"div",85)(2,"span",82),l(3),r(),n(4,"span",83),l(5),r()(),n(6,"h3",86),l(7),r(),n(8,"div",87)(9,"div",88)(10,"span",89),l(11,"M\xFC\u015Fteri"),r(),n(12,"span",90),l(13),r()(),n(14,"div",88)(15,"span",89),l(16,"\xD6ncelik"),r(),n(17,"span",83),l(18),r()(),n(19,"div",88)(20,"span",89),l(21,"Tarih"),r(),n(22,"span",90),l(23),r()()(),n(24,"div",91)(25,"a",84),l(26,"Detay"),r()()()),a&2){let t=d.$implicit,e=h(3);o(3),x(e.formatTicketId(t.id,t.ticketCode)),o(),O("badge--"+e.getStatusClass(t.status)),T("background-color",e.getStatusColor(t.status))("color",e.getStatusColor(t.status)?"#fff":null),o(),f(" ",e.getStatusText(t.status)," "),o(2),x(t.title),o(6),x(t.tenantName||"Bilinmiyor"),o(4),O("badge--"+e.getPriorityClass(t.priority)),T("background-color",e.getPriorityColor(t.priority))("color",e.getPriorityColor(t.priority)?"#fff":null),o(),f(" ",e.getPriorityText(t.priority)," "),o(5),x(e.formatDate(t.createdDate)),o(2),z("routerLink",$(19,et,t.id))}}function Ot(a,d){if(a&1&&(n(0,"table",79)(1,"thead")(2,"tr")(3,"th"),l(4,"ID"),r(),n(5,"th"),l(6,"Konu"),r(),n(7,"th"),l(8,"M\xFC\u015Fteri"),r(),n(9,"th"),l(10,"Durum"),r(),n(11,"th"),l(12,"\xD6ncelik"),r(),n(13,"th"),l(14,"Tarih"),r(),n(15,"th"),l(16,"\u0130\u015Flemler"),r()()(),n(17,"tbody"),M(18,St,19,21,"tr",null,tt),r()(),n(20,"div",80),M(21,Pt,27,21,"div",81,tt),r()),a&2){let t=h(2);o(18),k(t.recentTickets),o(3),k(t.recentTickets)}}function Dt(a,d){if(a&1&&(b(0,ot,2,1,"div",6),n(1,"div",7),M(2,ut,13,6,"div",8,at),r(),n(4,"div",9)(5,"div",10)(6,"div",11)(7,"h3"),l(8,"Son 2 Ayl\u0131k Haftal\u0131k Ticket Trend'i"),r(),n(9,"span",12),l(10,"A\xE7\u0131lan vs \xC7\xF6z\xFClen (8 hafta)"),r()(),n(11,"div",13),g(),n(12,"svg",14)(13,"defs")(14,"linearGradient",15),m(15,"stop",16)(16,"stop",17),r(),n(17,"linearGradient",18),m(18,"stop",19)(19,"stop",20),r()(),M(20,xt,3,4,null,null,G),m(22,"line",21)(23,"line",22),M(24,bt,7,17,":svg:g",null,Z),r()(),D(),n(26,"div",23)(27,"div",24),m(28,"span",25),n(29,"span"),l(30,"A\xE7\u0131lan"),r()(),n(31,"div",24),m(32,"span",26),n(33,"span"),l(34,"\xC7\xF6z\xFClen"),r()()()(),n(35,"div",10)(36,"div",11)(37,"h3"),l(38,"Son 7 G\xFCnl\xFCk Ticket Trend'i"),r(),n(39,"span",12),l(40,"A\xE7\u0131lan vs \xC7\xF6z\xFClen"),r()(),n(41,"div",13),g(),n(42,"svg",14)(43,"defs")(44,"linearGradient",27),m(45,"stop",16)(46,"stop",17),r(),n(47,"linearGradient",28),m(48,"stop",19)(49,"stop",20),r()(),M(50,yt,3,4,null,null,G),m(52,"line",21)(53,"line",22),M(54,Mt,7,17,":svg:g",null,Z),r()(),D(),n(56,"div",23)(57,"div",24),m(58,"span",25),n(59,"span"),l(60,"A\xE7\u0131lan"),r()(),n(61,"div",24),m(62,"span",26),n(63,"span"),l(64,"\xC7\xF6z\xFClen"),r()()()()(),n(65,"div",29)(66,"div",30)(67,"h2",31),l(68,"Son Ticketlar"),r(),n(69,"a",32),l(70," T\xFCm\xFCn\xFC G\xF6r "),g(),n(71,"svg",33),m(72,"line",34)(73,"polyline",35),r()()(),D(),n(74,"div",36),b(75,kt,6,0,"div",37)(76,Ot,23,0),r()()),a&2){let t=h();y(0,t.errorMessage?0:-1),o(2),k(t.stats),o(18),k(t.getMonthlyGridLines()),o(4),k(t.monthlyChartData),o(26),k(t.getWeeklyGridLines()),o(4),k(t.weeklyChartData),o(21),y(75,t.recentTickets.length===0?75:76)}}var Lt=(()=>{class a{constructor(t,e,i,c){this.dashboardService=t,this.signalRService=e,this.paramSvc=i,this.platformId=c,this.stats=[],this.recentTickets=[],this.monthlyChartData=[],this.weeklyChartData=[],this.monthlyMaxValue=20,this.weeklyMaxValue=28,this.isLoading=!0,this.errorMessage="",this.destroy$=new U,this.statusOptions=[],this.priorityOptions=[],this.isBrowser=Y(this.platformId)}ngOnInit(){this.paramSvc.getByGroup("TicketStatus").subscribe({next:t=>{let e=t?.data?.data||t?.data||t||[];this.statusOptions=(Array.isArray(e)?e:[]).map((i,c)=>({id:i.id,key:i.key,label:i.value,sortOrder:i.sortOrder??c+1,color:i.value2??i.color??null}))},error:()=>{this.statusOptions=[]}}),this.paramSvc.getByGroup("TicketPriority").subscribe({next:t=>{let e=t?.data?.data||t?.data||t||[];this.priorityOptions=(Array.isArray(e)?e:[]).map((i,c)=>({id:i.id,key:i.key,label:i.value,sortOrder:i.sortOrder??c+1,color:i.value2??i.color??null}))},error:()=>{this.priorityOptions=[]}}),this.loadDashboardData(),this.loadChartData(),this.initSignalR(),this.refreshInterval=setInterval(()=>{console.log("Dashboard: Periodic refresh triggered"),this.loadTicketsOnly()},3e4)}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete(),this.refreshInterval&&clearInterval(this.refreshInterval),this.signalRService.stopConnection().catch(t=>console.error("SignalR disconnect error:",t)),this.signalRService.stopDashboardConnection().catch(t=>console.error("SignalR dashboard disconnect error:",t))}initSignalR(){if(!this.isBrowser){console.log("Dashboard: SignalR - Not in browser environment");return}let t=localStorage.getItem("token")||sessionStorage.getItem("token");t?(console.log("Dashboard: SignalR - Starting connection..."),this.signalRService.startConnection(t).then(()=>{console.log("Dashboard: SignalR - Connection established"),this.subscribeToTicketUpdates()}).catch(e=>{console.error("Dashboard: SignalR ba\u011Flant\u0131 hatas\u0131:",e)}),this.signalRService.startDashboardConnection(t).then(()=>{console.log("Dashboard: SignalR Dashboard - Connection established"),this.subscribeToDashboardStats()}).catch(e=>{console.error("Dashboard: SignalR Dashboard ba\u011Flant\u0131 hatas\u0131:",e)})):console.warn("Dashboard: No auth token found for SignalR")}subscribeToTicketUpdates(){console.log("Dashboard: Subscribing to ticket updates..."),this.signalRService.ticketUpdated$.pipe(V(this.destroy$)).subscribe({next:t=>{console.log("Dashboard: Ticket update received:",t),this.handleTicketUpdate(t)},error:t=>{console.error("Dashboard: Error in ticket update subscription:",t)}})}subscribeToDashboardStats(){console.log("Dashboard: Subscribing to dashboard stats updates..."),this.signalRService.dashboardStatsUpdated$.pipe(V(this.destroy$)).subscribe({next:t=>{console.log("Dashboard: Dashboard stats update received:",t),this.updateStats(t)},error:t=>{console.error("Dashboard: Error in dashboard stats subscription:",t)}})}handleTicketUpdate(t){console.log("Dashboard: Updating ticket in list:",t.id);let e=Number(t.id),i=this.recentTickets.findIndex(c=>Number(c.id)===e);i!==-1?(console.log("Dashboard: Found ticket at index",i,"updating..."),this.recentTickets[i]=R(N({},this.recentTickets[i]),{title:t.title,status:t.status,priority:t.priority,createdDate:t.createdDate}),this.recentTickets=[...this.recentTickets]):console.log("Dashboard: Ticket not found in recent list")}loadDashboardData(){this.isLoading=!0,this.dashboardService.getStats().subscribe({next:t=>{let e;t.data?.data?e=t.data.data:t.data?e=t.data:e=t,this.updateStats(e)},error:()=>{this.errorMessage="\u0130statistikler y\xFCklenirken hata olu\u015Ftu."}}),this.loadTicketsOnly()}loadTicketsOnly(){this.dashboardService.getAllTicketsPage(1,50).subscribe({next:t=>{let e=[];t.items?e=t.items:Array.isArray(t)&&(e=t),this.recentTickets=e.slice(0,5),this.isLoading=!1},error:()=>{this.errorMessage="Ticketlar y\xFCklenirken hata olu\u015Ftu.",this.isLoading=!1}})}formatTicketId(t,e){if(e)return e;if(t==null)return"-";let i=typeof t=="number"?t:Number(t);return Number.isFinite(i)?`T${i.toString().padStart(5,"0")}`:String(t)}updateStats(t){let e=t.totalTickets||1;this.stats=[{title:"Toplam Ticket",value:t.totalTickets,icon:"ticket",color:"primary",change:0,changeType:"increase"},{title:"A\xE7\u0131k Ticketlar",value:t.openTickets,icon:"open",color:"warning",change:Math.round(t.openTickets/e*100),changeType:"increase"},{title:"\u0130\u015Flemdeki Ticketlar",value:t.processingTickets||0,icon:"processing",color:"orange",change:Math.round((t.processingTickets||0)/e*100),changeType:"increase"},{title:"\xC7\xF6z\xFClen Ticketlar",value:t.resolvedTickets,icon:"resolved",color:"success",change:Math.round(t.resolvedTickets/e*100),changeType:"increase"},{title:"M\xFC\u015Fteri Say\u0131s\u0131",value:t.totalTenants,icon:"users",color:"info",change:0,changeType:"increase"}]}getStatusText(t){let e=Number(t),i=this.statusOptions.find(s=>Number(s.sortOrder??s.id)===e||String(s.id)===String(t)||String(s.key)===String(t)||s.label===t);return i?i.label||"Bilinmiyor":{1:"A\xE7\u0131k",2:"\u0130\u015Flemde",3:"M\xFC\u015Fteri Bekleniyor",4:"\xC7\xF6z\xFCld\xFC",5:"Kapal\u0131"}[t]||"Bilinmiyor"}getStatusClass(t){let e=Number(t),i=this.statusOptions.find(s=>Number(s.sortOrder??s.id)===e||String(s.id)===String(t)||String(s.key)===String(t)||s.label===t);if(i){let s=Number(i.sortOrder??i.id);return{1:"open",2:"in-progress",3:"waiting",4:"resolved",5:"closed"}[s]??"open"}return{1:"open",2:"in-progress",3:"waiting",4:"resolved",5:"closed"}[t]||"open"}getPriorityText(t){let e=Number(t),i=this.priorityOptions.find(s=>Number(s.sortOrder??s.id)===e||String(s.id)===String(t)||String(s.key)===String(t)||s.label===t);return i?i.label||"Bilinmiyor":{1:"D\xFC\u015F\xFCk",2:"Orta",3:"Y\xFCksek",4:"Kritik"}[t]||"Bilinmiyor"}getPriorityClass(t){let e=Number(t),i=this.priorityOptions.find(s=>Number(s.sortOrder??s.id)===e||String(s.id)===String(t)||String(s.key)===String(t)||s.label===t);if(i){let s=Number(i.sortOrder??i.id);return{1:"low",2:"medium",3:"high",4:"critical"}[s]??"low"}return{1:"low",2:"medium",3:"high",4:"critical"}[t]||"low"}formatDate(t){if(!t)return"-";try{let e=new Date(t);return isNaN(e.getTime())?"-":e.toLocaleDateString("tr-TR",{day:"2-digit",month:"2-digit",year:"numeric"})}catch{return"-"}}loadChartData(){this.dashboardService.getAllTickets().subscribe({next:t=>{console.log("Chart data raw response:",t);let e=[];if(Array.isArray(t)?e=t:t?.data&&Array.isArray(t.data)?e=t.data:t?.items&&Array.isArray(t.items)&&(e=t.items),console.log("Chart data parsed tickets count:",e.length),console.log("Sample tickets:",e.slice(0,3)),e.length===0){console.warn("No tickets found, using fallback data"),this.monthlyChartData=this.generateMonthlyData(),this.weeklyChartData=this.generateWeeklyData();return}this.monthlyChartData=this.generateMonthlyDataFromTickets(e),this.weeklyChartData=this.generateWeeklyDataFromTickets(e),this.calculateChartMaxValues(),console.log("Monthly chart data:",this.monthlyChartData),console.log("Weekly chart data:",this.weeklyChartData)},error:t=>{console.error("Chart data loading error:",t),this.monthlyChartData=this.generateMonthlyData(),this.weeklyChartData=this.generateWeeklyData(),this.calculateChartMaxValues()}})}generateMonthlyDataFromTickets(t){let e=[],i=new Date;i.setHours(0,0,0,0);for(let c=7;c>=0;c--){let s=new Date(i);s.setDate(s.getDate()-c*7);let p=new Date(s);p.setDate(p.getDate()+6);let _=0,S=0;for(let I=0;I<7;I++){let A=new Date(s);A.setDate(A.getDate()+I);let it=A.getTime();for(let E of t)try{if(!E.createdDate)continue;let F=new Date(E.createdDate);F.setHours(0,0,0,0),F.getTime()===it&&(_++,E.status===4&&S++)}catch(F){console.warn("Error parsing ticket date:",E.createdDate,F)}}let P=String(s.getDate()).padStart(2,"0"),C=String(s.getMonth()+1).padStart(2,"0"),v=String(p.getDate()).padStart(2,"0"),nt=String(p.getMonth()+1).padStart(2,"0");e.push({label:`${P}.${C} - ${v}.${nt}`,opened:_,resolved:S})}return e}generateWeeklyDataFromTickets(t){let e=[],i=new Date;i.setHours(0,0,0,0);let c=["Pazar","Pazartesi","Sal\u0131","\xC7ar\u015Famba","Per\u015Fembe","Cuma","Cumartesi"];for(let s=6;s>=0;s--){let p=new Date(i);p.setDate(p.getDate()-s);let _=p.getTime(),S=0,P=0;for(let C of t)try{if(!C.createdDate)continue;let v=new Date(C.createdDate);v.setHours(0,0,0,0),v.getTime()===_&&(S++,C.status===4&&P++)}catch(v){console.warn("Error parsing ticket date:",C.createdDate,v)}e.push({label:c[p.getDay()],opened:S,resolved:P})}return e}generateMonthlyData(){let t=[],e=new Date;e.setHours(0,0,0,0);for(let i=7;i>=0;i--){let c=Math.floor(Math.random()*20)+5,s=Math.floor(Math.random()*15)+3,p=new Date(e);p.setDate(p.getDate()-i*7);let _=new Date(p);_.setDate(_.getDate()+6);let S=String(p.getDate()).padStart(2,"0"),P=String(p.getMonth()+1).padStart(2,"0"),C=String(_.getDate()).padStart(2,"0"),v=String(_.getMonth()+1).padStart(2,"0");t.push({label:`${S}.${P} - ${C}.${v}`,opened:c,resolved:s})}return t}generateWeeklyData(){let t=[],e=new Date,i=["Pazar","Pazartesi","Sal\u0131","\xC7ar\u015Famba","Per\u015Fembe","Cuma","Cumartesi"];for(let c=6;c>=0;c--){let s=new Date(e);s.setDate(s.getDate()-c);let p=Math.floor(Math.random()*15)+3,_=Math.floor(Math.random()*12)+2;t.push({label:i[s.getDay()],opened:p,resolved:_})}return t}calculateChartMaxValues(){let t=0;for(let i of this.monthlyChartData){let c=Math.max(i.opened,i.resolved);t=Math.max(t,c)}this.monthlyMaxValue=Math.ceil(t/5)*5,this.monthlyMaxValue<5&&(this.monthlyMaxValue=5);let e=0;for(let i of this.weeklyChartData){let c=Math.max(i.opened,i.resolved);e=Math.max(e,c)}this.weeklyMaxValue=Math.ceil(e/7)*7,this.weeklyMaxValue<7&&(this.weeklyMaxValue=7)}getMonthlyGridLines(){let t=[];for(let e=0;e<=5;e++)t.push(e);return t}getWeeklyGridLines(){let t=[];for(let e=0;e<=7;e++)t.push(e);return t}getMonthlyScaleValue(t){return Math.round(t*this.monthlyMaxValue/5)}getWeeklyScaleValue(t){return Math.round(t*this.weeklyMaxValue/7)}getMonthlyPixelPerUnit(){return 150/this.monthlyMaxValue}getWeeklyPixelPerUnit(){return 150/this.weeklyMaxValue}getStatusColor(t){let e=Number(t);return this.statusOptions.find(c=>Number(c.sortOrder??c.id)===e||String(c.id)===String(t)||String(c.key)===String(t)||c.label===t)?.color??null}getPriorityColor(t){let e=Number(t);return this.priorityOptions.find(c=>Number(c.sortOrder??c.id)===e||String(c.id)===String(t)||String(c.key)===String(t)||c.label===t)?.color??null}static{this.\u0275fac=function(e){return new(e||a)(w(Q),w(J),w(X),w(B))}}static{this.\u0275cmp=L({type:a,selectors:[["app-admin-dashboard"]],standalone:!0,features:[j],decls:8,vars:1,consts:[[1,"dashboard"],[1,"page-header"],[1,"page-title"],[1,"page-subtitle"],[1,"loading-container"],[1,"spinner"],[1,"alert","alert-error"],[1,"stats-grid"],[1,"stat-card",3,"class"],[1,"charts-grid"],[1,"chart-card"],[1,"chart-header"],[1,"chart-subtitle"],[1,"chart-container"],["viewBox","0 0 500 250","preserveAspectRatio","xMidYMid meet",1,"bar-chart"],["id","openGradient","x1","0%","y1","0%","x2","0%","y2","100%"],["offset","0%",2,"stop-color","#3b82f6","stop-opacity","1"],["offset","100%",2,"stop-color","#60a5fa","stop-opacity","0.6"],["id","resolvedGradient","x1","0%","y1","0%","x2","0%","y2","100%"],["offset","0%",2,"stop-color","#10b981","stop-opacity","1"],["offset","100%",2,"stop-color","#34d399","stop-opacity","0.6"],["x1","50","y1","30","x2","50","y2","180","stroke","#d1d5db","stroke-width","2"],["x1","50","y1","180","x2","480","y2","180","stroke","#d1d5db","stroke-width","2"],[1,"chart-legend"],[1,"legend-item"],[1,"legend-color",2,"background","linear-gradient(135deg, #3b82f6, #60a5fa)"],[1,"legend-color",2,"background","linear-gradient(135deg, #10b981, #34d399)"],["id","openGradient2","x1","0%","y1","0%","x2","0%","y2","100%"],["id","resolvedGradient2","x1","0%","y1","0%","x2","0%","y2","100%"],[1,"card"],[1,"card-header"],[1,"card-title"],["routerLink","/admin/tickets",1,"btn","btn-outline"],["width","16","height","16","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2"],["x1","5","y1","12","x2","19","y2","12"],["points","12 5 19 12 12 19"],[1,"table-wrapper"],[1,"empty-state"],[1,"stat-card"],[1,"stat-icon"],[1,"stat-content"],[1,"stat-title"],[1,"stat-value"],[1,"stat-change",3,"increase","decrease"],["width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2"],["d","M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"],["points","14 2 14 8 20 8"],["cx","12","cy","12","r","10"],["x1","12","y1","8","x2","12","y2","12"],["x1","12","y1","16","x2","12.01","y2","16"],["d","M12 2v4"],["d","M12 18v4"],["d","M4.93 4.93l2.83 2.83"],["d","M16.24 16.24l2.83 2.83"],["d","M2 12h4"],["d","M18 12h4"],["d","M4.93 19.07l2.83-2.83"],["d","M16.24 7.76l2.83-2.83"],["d","M22 11.08V12a10 10 0 1 1-5.93-9.14"],["points","22 4 12 14.01 9 11.01"],["d","M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"],["cx","9","cy","7","r","4"],["d","M23 21v-2a4 4 0 0 0-3-3.87"],["d","M16 3.13a4 4 0 0 1 0 7.75"],[1,"stat-change"],["points","23 6 13.5 15.5 8.5 10.5 1 18"],["points","17 6 23 6 23 12"],["points","23 18 13.5 8.5 8.5 13.5 1 6"],["points","17 18 23 18 23 12"],["x1","50","x2","480","stroke","#e5e7eb","stroke-width","1","stroke-dasharray","2,2"],["x","40","font-size","11","fill","#9ca3af","text-anchor","end"],[1,"bar-item"],["font-size","8","fill","#3b82f6","text-anchor","middle","font-weight","600"],["font-size","8","fill","#10b981","text-anchor","middle","font-weight","600"],["y","210","font-size","7","fill","#6b7280","text-anchor","middle","font-weight","500"],["font-size","9","fill","#3b82f6","text-anchor","middle","font-weight","600"],["font-size","9","fill","#10b981","text-anchor","middle","font-weight","600"],["y","205","font-size","11","fill","#6b7280","text-anchor","middle","font-weight","500"],["width","48","height","48","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","1.5"],[1,"table"],[1,"recent-tickets-cards"],[1,"recent-ticket-card"],[1,"ticket-id"],[1,"badge"],[1,"btn","btn-sm","btn-primary",3,"routerLink"],[1,"recent-ticket-card__header"],[1,"recent-ticket-card__title"],[1,"recent-ticket-card__meta"],[1,"meta-row"],[1,"meta-label"],[1,"meta-value"],[1,"recent-ticket-card__actions"]],template:function(e,i){e&1&&(n(0,"div",0)(1,"div",1)(2,"h1",2),l(3,"Dashboard"),r(),n(4,"p",3),l(5,"Ho\u015F geldiniz! \u0130\u015Fte g\xFCncel durumunuz."),r()(),b(6,rt,4,0,"div",4)(7,Dt,77,2),r()),e&2&&(o(6),y(6,i.isLoading?6:7))},dependencies:[H,q,K],styles:['.dashboard[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .3s ease}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}.page-header[_ngcontent-%COMP%]{margin-bottom:2rem}.page-header[_ngcontent-%COMP%]   .page-title[_ngcontent-%COMP%]{font-size:1.75rem;font-weight:700;color:var(--text-primary);margin:0 0 .25rem}.page-header[_ngcontent-%COMP%]   .page-subtitle[_ngcontent-%COMP%]{color:var(--text-secondary);margin:0}.loading-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:4rem 2rem}.loading-container[_ngcontent-%COMP%]   .spinner[_ngcontent-%COMP%]{width:40px;height:40px;border:3px solid var(--border-color);border-top-color:var(--primary-color);border-radius:50%;animation:_ngcontent-%COMP%_spin .8s linear infinite;margin-bottom:1rem}.loading-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--text-secondary)}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.alert[_ngcontent-%COMP%]{padding:1rem;border-radius:var(--radius-md);margin-bottom:1.5rem}.alert-error[_ngcontent-%COMP%]{background:#fef2f2;color:#dc2626;border:1px solid #fecaca}.empty-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:3rem;color:var(--text-secondary)}.empty-state[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{margin-bottom:1rem;opacity:.5}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0}.stats-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(5,1fr);gap:1.5rem;margin-bottom:2rem}@media (max-width: 1400px){.stats-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(3,1fr)}}@media (max-width: 900px){.stats-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}}@media (max-width: 576px){.stats-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}.stat-card[_ngcontent-%COMP%]{background:var(--bg-secondary);border-radius:var(--radius-lg);padding:1.5rem;display:flex;align-items:flex-start;gap:1rem;box-shadow:var(--shadow-sm);transition:all var(--transition-normal);position:relative;overflow:hidden}.stat-card[_ngcontent-%COMP%]:hover{transform:translateY(-4px);box-shadow:var(--shadow-md)}.stat-card[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:0;width:4px;height:100%}.stat-card--primary[_ngcontent-%COMP%]:before{background:var(--primary-color)}.stat-card--warning[_ngcontent-%COMP%]:before{background:var(--warning-color)}.stat-card--orange[_ngcontent-%COMP%]:before{background:#f97316}.stat-card--success[_ngcontent-%COMP%]:before{background:var(--accent-color)}.stat-card--info[_ngcontent-%COMP%]:before{background:var(--info-color)}.stat-icon[_ngcontent-%COMP%]{width:48px;height:48px;border-radius:var(--radius-md);display:flex;align-items:center;justify-content:center;flex-shrink:0}.stat-card--primary[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{background:var(--primary-light);color:var(--primary-color)}.stat-card--warning[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{background:#fff7e6;color:var(--warning-color)}.stat-card--success[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{background:#e6f9ed;color:var(--accent-color)}.stat-card--info[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{background:#e6f6fa;color:var(--info-color)}.stat-card--orange[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{background:#fff7ed;color:#f97316}.stat-content[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column}.stat-title[_ngcontent-%COMP%]{font-size:.875rem;font-weight:600;color:var(--text-primary);margin-bottom:.25rem}.stat-value[_ngcontent-%COMP%]{font-size:1.75rem;font-weight:700;color:var(--text-primary);line-height:1}.stat-change[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.25rem;font-size:.75rem;font-weight:500;padding:.25rem .5rem;border-radius:var(--radius-sm)}.stat-change.increase[_ngcontent-%COMP%]{color:var(--accent-color);background:#e6f9ed}.stat-change.decrease[_ngcontent-%COMP%]{color:var(--danger-color);background:#fef2f2}.card[_ngcontent-%COMP%]{background:var(--bg-secondary);border-radius:var(--radius-lg);box-shadow:var(--shadow-sm)}.card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:1.25rem 1.5rem;border-bottom:1px solid var(--border-light)}.card[_ngcontent-%COMP%]   .card-title[_ngcontent-%COMP%]{font-size:1.125rem;font-weight:600;color:var(--text-primary);margin:0}.table-wrapper[_ngcontent-%COMP%]{overflow-x:auto}.recent-tickets-cards[_ngcontent-%COMP%]{display:none;gap:.75rem}.recent-ticket-card[_ngcontent-%COMP%]{border:1px solid var(--border-light);border-radius:var(--radius-md);background:var(--bg-primary);padding:.875rem}.recent-ticket-card__header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;gap:.5rem;margin-bottom:.625rem}.recent-ticket-card__title[_ngcontent-%COMP%]{margin:0 0 .625rem;font-size:.9rem;color:var(--text-primary);line-height:1.35;word-break:break-word}.recent-ticket-card__meta[_ngcontent-%COMP%]{display:grid;gap:.4rem}.meta-row[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;gap:.75rem}.meta-label[_ngcontent-%COMP%]{color:var(--text-secondary);font-size:.75rem}.meta-value[_ngcontent-%COMP%]{color:var(--text-primary);font-size:.8125rem;font-weight:500;text-align:right}.recent-ticket-card__actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;margin-top:.75rem}.table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:1rem 1.5rem;text-align:left}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-size:.75rem;font-weight:600;text-transform:uppercase;letter-spacing:.5px;color:var(--text-secondary);background:var(--bg-primary)}.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:.875rem;color:var(--text-primary);border-bottom:1px solid var(--border-light)}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{transition:background var(--transition-fast)}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:var(--bg-primary)}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:last-child   td[_ngcontent-%COMP%]{border-bottom:none}.ticket-id[_ngcontent-%COMP%]{font-weight:600;color:var(--primary-color)}.badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;padding:.375rem .75rem;font-size:.75rem;font-weight:500;border-radius:9999px}.badge--open[_ngcontent-%COMP%]{background:#fff7e6;color:#d97706}.badge--in-progress[_ngcontent-%COMP%]{background:var(--primary-light);color:var(--primary-color)}.badge--waiting[_ngcontent-%COMP%]{background:#eef2ff;color:#4338ca}.badge--resolved[_ngcontent-%COMP%]{background:#e6f9ed;color:#059669}.badge--closed[_ngcontent-%COMP%]{background:var(--bg-primary);color:var(--text-secondary)}.priority[_ngcontent-%COMP%]{display:inline-flex;align-items:center;font-size:.75rem;font-weight:500}.priority--low[_ngcontent-%COMP%]{color:var(--text-secondary)}.priority--medium[_ngcontent-%COMP%]{color:var(--warning-color)}.priority--high[_ngcontent-%COMP%]{color:#ea580c}.priority--critical[_ngcontent-%COMP%]{color:var(--danger-color)}.btn[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:.5rem;padding:.5rem 1rem;border:1px solid transparent;border-radius:var(--radius-md);font-size:.875rem;font-weight:600;cursor:pointer;transition:all var(--transition-normal);text-decoration:none}.btn[_ngcontent-%COMP%]:hover{opacity:.9}.btn-primary[_ngcontent-%COMP%]{background:var(--primary-color);color:#fff}.btn-primary[_ngcontent-%COMP%]:hover{background:var(--primary-dark)}.btn-outline[_ngcontent-%COMP%]{border-color:var(--border-color);color:var(--text-primary);background:transparent}.btn-outline[_ngcontent-%COMP%]:hover{background:var(--bg-primary)}.btn-sm[_ngcontent-%COMP%]{padding:.375rem .75rem;font-size:.75rem}.charts-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);gap:1.5rem;margin-bottom:2rem}@media (max-width: 1200px){.charts-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}.chart-card[_ngcontent-%COMP%]{background:var(--bg-secondary);border-radius:var(--radius-lg);padding:1.5rem;box-shadow:var(--shadow-sm);transition:all var(--transition-normal)}.chart-card[_ngcontent-%COMP%]:hover{box-shadow:var(--shadow-md)}.chart-header[_ngcontent-%COMP%]{margin-bottom:1.5rem}.chart-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.125rem;font-weight:600;color:var(--text-primary);margin:0 0 .25rem}.chart-subtitle[_ngcontent-%COMP%]{display:block;font-size:.875rem;color:var(--text-secondary);font-weight:500}.chart-container[_ngcontent-%COMP%]{width:100%;margin-bottom:1rem;min-height:auto}.chart-container[_ngcontent-%COMP%]   .bar-chart[_ngcontent-%COMP%]{width:100%;height:auto}.chart-container[_ngcontent-%COMP%]   .bar-chart[_ngcontent-%COMP%]   .bar-item[_ngcontent-%COMP%]{transition:all var(--transition-fast);cursor:pointer}.chart-container[_ngcontent-%COMP%]   .bar-chart[_ngcontent-%COMP%]   .bar-item[_ngcontent-%COMP%]:hover{opacity:.8;filter:brightness(1.1)}.chart-legend[_ngcontent-%COMP%]{display:flex;gap:1.5rem;justify-content:center;flex-wrap:wrap;padding-top:1rem;border-top:1px solid var(--border-light)}.legend-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;font-size:.875rem;color:var(--text-secondary);font-weight:500}.legend-item[_ngcontent-%COMP%]   .legend-color[_ngcontent-%COMP%]{width:12px;height:12px;border-radius:2px;display:inline-block}.empty-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:2rem;text-align:center;color:var(--text-secondary)}.empty-state[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:48px;height:48px;margin-bottom:1rem;opacity:.5}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:.875rem}.alert[_ngcontent-%COMP%]{padding:1rem;border-radius:var(--radius-md);margin-bottom:1.5rem;font-size:.875rem}.alert-error[_ngcontent-%COMP%]{background:#fef2f2;color:var(--danger-color);border:1px solid #fecaca}@media (max-width: 768px){.table[_ngcontent-%COMP%]{display:none}.recent-tickets-cards[_ngcontent-%COMP%]{display:grid}}']})}}return a})();export{Lt as AdminDashboardComponent};
