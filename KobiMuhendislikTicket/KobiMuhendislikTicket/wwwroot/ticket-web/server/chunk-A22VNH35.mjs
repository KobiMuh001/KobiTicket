import './polyfills.server.mjs';
import{a as se}from"./chunk-RINBVYQ6.mjs";import{a as ce}from"./chunk-DXIUKFP5.mjs";import{b as ne,c as ie,f as oe,r as ae}from"./chunk-7OSF6RCL.mjs";import{a as re}from"./chunk-2E456LMH.mjs";import{a as te}from"./chunk-TW7WQT2I.mjs";import{g as X,k as Z,n as ee}from"./chunk-JGHH2ILE.mjs";import{Ab as Y,Ba as S,Db as v,Eb as y,Fa as r,Ga as P,Ta as u,Va as _,Wa as T,Xa as I,_a as f,aa as R,ab as N,bb as E,cb as D,db as i,eb as a,fb as g,ia as x,ib as O,ja as h,jb as k,ka as p,kb as m,kc as W,la as b,mc as Q,nb as H,nc as $,ob as L,oc as J,pb as G,rb as c,rc as q,sb as C,tb as M,v as B,va as j,wb as K,xb as A,yb as U}from"./chunk-5C2672OW.mjs";import{a as z,b as F,h as V}from"./chunk-VVCT4QZE.mjs";var le=["commentsContainer"],de=(o,d)=>d.id;function me(o,d){o&1&&(i(0,"div",6),g(1,"div",8),i(2,"p"),c(3,"Y\xFCkleniyor..."),a()())}function ge(o,d){o&1&&(i(0,"div",9),p(),i(1,"svg",10),g(2,"circle",11)(3,"line",12)(4,"line",13),a(),b(),i(5,"h3"),c(6,"Talep Bulunamad\u0131"),a(),i(7,"p"),c(8,"Arad\u0131\u011F\u0131n\u0131z destek talebi bulunamad\u0131 veya eri\u015Fim izniniz yok."),a(),i(9,"a",14),c(10,"Taleplerime D\xF6n"),a()())}function pe(o,d){if(o&1){let e=O();i(0,"button",48),k("click",function(){let t=x(e).$implicit,l=m(3);return h(l.openImagePreview(t))}),g(1,"img",49),i(2,"div",50)(3,"span"),c(4,"Buyutmek icin tikla"),a()()()}if(o&2){let e=d.$implicit,n=m(3);r(),_("src",n.baseUrl+"/"+e,S)("alt",n.ticket.title)}}function ue(o,d){if(o&1&&(i(0,"div",33)(1,"div",28)(2,"h3"),c(3,"Eklenen Gorseller"),a()(),i(4,"div",46),E(5,pe,5,2,"button",47,N),a()()),o&2){let e=m(2);r(5),D(e.ticketImages)}}function _e(o,d){if(o&1&&(i(0,"div",36)(1,"div",37),p(),i(2,"svg",4),g(3,"circle",11)(4,"polyline",31),a()(),b(),i(5,"div",42)(6,"span",43),c(7,"Son G\xFCncelleme"),a(),i(8,"span",44),c(9),v(10,"date"),a()()()),o&2){let e=m(2);r(9),C(y(10,1,e.ticket.updatedDate,"dd.MM.yyyy HH:mm"))}}function fe(o,d){if(o&1&&(i(0,"div",36)(1,"div",37),p(),i(2,"svg",4),g(3,"rect",51)(4,"path",52),a()(),b(),i(5,"div",42)(6,"span",43),c(7,"ilgili Varl\u0131k"),a(),i(8,"span",44),c(9),a()()()),o&2){let e=m(2);r(9),C(e.ticket.assetName)}}function Ce(o,d){if(o&1&&(i(0,"div",36)(1,"div",37),p(),i(2,"svg",4),g(3,"path",53)(4,"circle",54),a()(),b(),i(5,"div",42)(6,"span",43),c(7,"Atanan Ki\u015Fi"),a(),i(8,"span",44),c(9),a()()()),o&2){let e=m(2);r(9),C(e.ticket.assignedPerson)}}function xe(o,d){o&1&&(i(0,"div",60)(1,"p"),c(2,"Hen\xFCz mesaj bulunmuyor."),a()())}function he(o,d){o&1&&(i(0,"span",69),c(1,"Destek"),a())}function be(o,d){if(o&1&&(i(0,"div",63)(1,"div",64)(2,"span",65),c(3),a(),u(4,he,2,0,"span",66),i(5,"span",67),c(6),v(7,"date"),a()(),i(8,"p",68),c(9),a()()),o&2){let e=d.$implicit;I("admin-comment",e.isAdminReply),r(3),C(e.authorName),r(),_("ngIf",e.isAdminReply),r(2),C(y(7,6,e.createdDate,"HH:mm")),r(3),C(e.message)}}function ke(o,d){if(o&1&&E(0,be,10,9,"div",62,de),o&2){let e=m(3);D(e.comments)}}function Me(o,d){o&1&&(i(0,"div",61)(1,"div",70),p(),i(2,"svg",4),g(3,"polyline",71),a(),b(),i(4,"p"),c(5,"Bu destek talebi \xFCzerinde art\u0131k yorum yap\u0131lamaz."),a()()())}function Pe(o,d){if(o&1&&(i(0,"div",73),c(1),a()),o&2){let e=m(4);r(),M(" ",e.errorMessage," ")}}function Oe(o,d){if(o&1&&(i(0,"div",74),c(1),a()),o&2){let e=m(4);r(),M(" ",e.uploadSuccessMessage," ")}}function ve(o,d){o&1&&(p(),i(0,"svg",4),g(1,"path",83),a())}function ye(o,d){o&1&&g(0,"span",84)}function we(o,d){o&1&&(p(),i(0,"svg",4),g(1,"line",85)(2,"polygon",86),a())}function Se(o,d){o&1&&g(0,"span",84)}function Te(o,d){if(o&1){let e=O();i(0,"div",72),u(1,Pe,2,1,"div",73)(2,Oe,2,1,"div",74),i(3,"div",75)(4,"textarea",76),U("ngModelChange",function(t){x(e);let l=m(3);return A(l.newComment,t)||(l.newComment=t),h(t)}),a(),i(5,"div",77)(6,"input",78),k("change",function(t){x(e);let l=m(3);return h(l.onFileSelected(t))}),a(),i(7,"button",79),k("click",function(){x(e);let t=m(3);return h(t.triggerFileInput())}),u(8,ve,2,0,"svg",80)(9,ye,1,0,"span",81),a(),i(10,"button",82),k("click",function(){x(e);let t=m(3);return h(t.addComment())}),u(11,we,3,0,"svg",80)(12,Se,1,0,"span",81),a()()()()}if(o&2){let e=m(3);r(),f(1,e.errorMessage?1:-1),r(),f(2,e.uploadSuccessMessage?2:-1),r(2),K("ngModel",e.newComment),r(3),_("disabled",e.isUploadingFile||e.isTicketClosed()),r(),_("ngIf",!e.isUploadingFile),r(),_("ngIf",e.isUploadingFile),r(),_("disabled",!e.newComment.trim()||e.isSubmittingComment||e.isTicketClosed()),r(),_("ngIf",!e.isSubmittingComment),r(),_("ngIf",e.isSubmittingComment)}}function Ie(o,d){if(o&1){let e=O();i(0,"div",45)(1,"div",55)(2,"h3"),c(3),a(),i(4,"button",56),k("click",function(){x(e);let t=m(2);return h(t.toggleChat())}),p(),i(5,"svg",4),g(6,"line",57)(7,"line",58),a()()(),b(),i(8,"div",59,0),u(10,xe,3,0,"div",60)(11,ke,2,0),a(),u(12,Me,6,0,"div",61)(13,Te,13,9),a()}if(o&2){let e=m(2);r(3),M("Mesajlar (",e.comments.length,")"),r(7),f(10,e.comments.length===0?10:11),r(2),f(12,e.isTicketClosed()?12:13)}}function Ee(o,d){o&1&&(i(0,"div",87),p(),i(1,"svg",88),g(2,"path",25),a(),b(),i(3,"p"),c(4,"Destek ekibiyle ileti\u015Fime ge\xE7mek i\xE7in yukar\u0131daki butonu kullan\u0131n."),a()())}function De(o,d){if(o&1){let e=O();i(0,"div",15)(1,"div",16)(2,"div",17)(3,"div",18)(4,"span",19),c(5),a(),i(6,"h1"),c(7),a()(),i(8,"div",20)(9,"div",21)(10,"span",22),c(11),a(),i(12,"span",22),c(13),a()(),i(14,"button",23),k("click",function(){x(e);let t=m();return h(t.toggleChat())}),p(),i(15,"svg",24),g(16,"path",25),a(),c(17),a()()(),b(),i(18,"div",26)(19,"div",27)(20,"div",28)(21,"h3"),c(22,"Talep A\xE7\u0131klamas\u0131"),a(),i(23,"span",29),p(),i(24,"svg",30),g(25,"circle",11)(26,"polyline",31),a(),c(27),v(28,"date"),a()(),b(),i(29,"div",32)(30,"p"),c(31),a()()(),u(32,ue,7,0,"div",33),a()(),i(33,"div",34)(34,"div",35)(35,"div",36)(36,"div",37),p(),i(37,"svg",4),g(38,"rect",38)(39,"line",39)(40,"line",40)(41,"line",41),a()(),b(),i(42,"div",42)(43,"span",43),c(44,"Olu\u015Fturulma"),a(),i(45,"span",44),c(46),v(47,"date"),a()()(),u(48,_e,11,4,"div",36)(49,fe,10,1,"div",36)(50,Ce,10,1,"div",36),a(),u(51,Ie,14,3,"div",45)(52,Ee,5,0),a()()}if(o&2){let e=m();r(5),M("#",e.ticket.id,""),r(2),C(e.ticket.title),r(3),T("background-color",e.getStatusColor(e.ticket.status))("color",e.getStatusColor(e.ticket.status)?"#fff":null),_("ngClass",e.getStatusClass(e.ticket.status)),r(),C(e.ticket.statusText),r(),T("background-color",e.getPriorityColor(e.ticket.priority))("color",e.getPriorityColor(e.ticket.priority)?"#fff":null),_("ngClass",e.getPriorityClass(e.ticket.priority)),r(),C(e.ticket.priorityText),r(),I("active",e.showChat),r(3),M(" ",e.showChat?"Sohbeti Gizle":"Mesaj G\xF6nder"," "),r(10),M(" ",y(28,25,e.ticket.createdDate,"dd MMM yyyy, HH:mm")," "),r(4),C(e.ticket.description),r(),f(32,e.ticketImages.length>0?32:-1),r(14),C(y(47,28,e.ticket.createdDate,"dd.MM.yyyy HH:mm")),r(2),f(48,e.ticket.updatedDate?48:-1),r(),f(49,e.ticket.assetName?49:-1),r(),f(50,e.ticket.assignedPerson?50:-1),r(),f(51,e.showChat?51:52)}}function ze(o,d){if(o&1){let e=O();i(0,"div",89),k("click",function(){x(e);let t=m();return h(t.showImagePreview=!1)}),i(1,"div",90),k("click",function(t){return x(e),h(t.stopPropagation())}),i(2,"button",91),k("click",function(){x(e);let t=m();return h(t.showImagePreview=!1)}),c(3,"x"),a(),g(4,"img",92),a()()}if(o&2){let e=m();r(4),_("src",e.baseUrl+"/"+e.selectedImagePath,S)}}var Je=(()=>{class o{constructor(e,n,t,l,s){this.ticketService=e,this.signalRService=n,this.systemParameterService=t,this.route=l,this.ticket=null,this.comments=[],this.ticketImages=[],this.isLoading=!0,this.isSubmittingComment=!1,this.showChat=!1,this.newComment="",this.errorMessage="",this.baseUrl=te.baseUrl,this.statusOptions=[],this.priorityOptions=[],this.selectedFiles=[],this.isUploadingFile=!1,this.uploadSuccessMessage="",this.showImagePreview=!1,this.selectedImagePath=null,this.ticketId="",this.isSignalRConnected=!1,this.shouldScrollToBottom=!1,this.isBrowser=q(s)}ngOnInit(){let e=this.route.snapshot.paramMap.get("id");e&&(this.ticketId=e,this.loadLookups(),this.loadTicket(e),this.loadComments(e),this.loadImages(e),this.isBrowser&&this.initSignalR(),this.refreshInterval=setInterval(()=>{console.log("Customer-Detail: Periodic comments refresh triggered"),this.loadComments(e)},2e3))}loadLookups(){this.systemParameterService.getByGroup("TicketStatus").subscribe({next:e=>{let n=e.data||e||[];this.statusOptions=(n||[]).map(t=>({id:t.id,key:t.key,numericKey:t.numericKey??(typeof t.key=="number"?t.key:Number.isFinite(Number(t.key))?Number(t.key):null),label:t.numericKey!=null?t.value??t.description??t.key:"",sortOrder:t.sortOrder,color:t.numericKey!=null?t.value2??t.color??null:null})),this.ticket&&(this.ticket.statusText=this.getStatusText(this.ticket.status))},error:()=>{}}),this.systemParameterService.getByGroup("TicketPriority").subscribe({next:e=>{let n=e.data||e||[];this.priorityOptions=(n||[]).map(t=>({id:t.id,key:t.key,numericKey:t.numericKey??(typeof t.key=="number"?t.key:Number.isFinite(Number(t.key))?Number(t.key):null),label:t.numericKey!=null?t.value??t.description??t.key:"",sortOrder:t.sortOrder,color:t.numericKey!=null?t.value2??t.color??null:null})),this.ticket&&(this.ticket.priorityText=this.getPriorityText(this.ticket.priority))},error:()=>{}})}ngOnDestroy(){this.refreshInterval&&clearInterval(this.refreshInterval),this.ticketId&&this.signalRService.leaveTicketGroup(this.ticketId),this.commentSubscription?.unsubscribe()}ngAfterViewChecked(){this.shouldScrollToBottom&&(this.scrollToBottom(),this.shouldScrollToBottom=!1)}scrollToBottom(){try{this.commentsContainer&&(this.commentsContainer.nativeElement.scrollTop=this.commentsContainer.nativeElement.scrollHeight)}catch{}}openImagePreview(e){this.selectedImagePath=e,this.showImagePreview=!0}initSignalR(){return V(this,null,function*(){if(!this.isBrowser){console.log("SignalR: Not in browser environment");return}let e=localStorage.getItem("token")||sessionStorage.getItem("token");if(!e){console.warn("SignalR: No token found. User may not be authenticated.");return}try{console.log("SignalR: Customer - Attempting to start connection"),yield this.signalRService.startConnection(e),console.log("SignalR: Customer - Joining ticket group",this.ticketId),yield this.signalRService.joinTicketGroup(this.ticketId),this.isSignalRConnected=!0,console.log("SignalR: Customer - Successfully connected and joined group"),this.commentSubscription=this.signalRService.commentReceived$.subscribe(n=>{console.log("Customer-Detail: Received comment from SignalR:",n),n.ticketId===this.ticketId&&(this.comments.some(l=>l.id===n.id)?console.log("Customer-Detail: Comment already exists, skipping"):(console.log("Customer-Detail: Adding new comment to list"),this.comments.push({id:n.id,message:n.message,authorName:n.authorName,isAdminReply:n.isAdminReply,createdDate:n.createdDate}),this.shouldScrollToBottom=!0))})}catch(n){console.error("SignalR: Connection failed:",n),this.isSignalRConnected=!1,console.warn("SignalR: Real-time updates disabled for customer")}})}loadTicket(e){this.isLoading=!0,this.ticketService.getMyTickets().subscribe({next:n=>{let l=(n.data||n||[]).find(s=>s.id.toString()===e);l&&(this.ticket=F(z({},l),{statusText:this.getStatusText(l.status),priorityText:this.getPriorityText(l.priority),assetName:l.productName||l.asset?.productName||l.asset?.name||l.assetName})),this.isLoading=!1},error:()=>{this.isLoading=!1,this.errorMessage="Ticket y\xFCklenirken bir hata olu\u015Ftu."}})}loadComments(e){this.ticketService.getComments(e).subscribe({next:n=>{this.comments=n.data||n||[],this.shouldScrollToBottom=!0},error:()=>{}})}loadImages(e){this.ticketService.getTicketImages(e).subscribe({next:n=>{this.ticketImages=n.data||n||[]},error:()=>{}})}addComment(){if(!this.newComment.trim()||!this.ticket)return;if(this.isTicketClosed()){this.errorMessage="Bu destek talebi \xFCzerinde art\u0131k yorum yap\u0131lamaz.";return}let e=this.newComment;this.newComment="",this.isSubmittingComment=!0,this.ticketService.addComment(this.ticket.id,e).subscribe({next:()=>{this.isSubmittingComment=!1,this.shouldScrollToBottom=!0,this.loadComments(this.ticketId)},error:()=>{this.newComment=e,this.errorMessage="Yorum eklenirken bir hata olu\u015Ftu.",this.isSubmittingComment=!1}})}toggleChat(){this.showChat=!this.showChat,this.showChat&&(this.shouldScrollToBottom=!0)}getStatusText(e){let n=Number(e),t=this.statusOptions.find(s=>Number(s.numericKey??s.sortOrder??s.id)===n||s.key===e||String(s.id)===String(e));return t?t.label:{Open:"A\xE7\u0131k",Processing:"\u0130\u015Flemde",InProgress:"\u0130\u015Flemde",WaitingForCustomer:"M\xFC\u015Fteri Bekleniyor",Waiting:"M\xFC\u015Fteri Bekleniyor",Resolved:"\xC7\xF6z\xFCld\xFC",Closed:"Kapat\u0131ld\u0131",1:"A\xE7\u0131k",2:"\u0130\u015Flemde",3:"M\xFC\u015Fteri Bekleniyor",4:"\xC7\xF6z\xFCld\xFC",5:"Kapat\u0131ld\u0131"}[e]??"Bilinmiyor"}getPriorityText(e){let n=Number(e),t=this.priorityOptions.find(s=>Number(s.numericKey??s.sortOrder??s.id)===n||s.key===e||String(s.id)===String(e));return t?t.label:{Low:"D\xFC\u015F\xFCk",Medium:"Orta",High:"Y\xFCksek",Critical:"Kritik",1:"D\xFC\u015F\xFCk",2:"Orta",3:"Y\xFCksek",4:"Kritik"}[e]??"Bilinmiyor"}getStatusClass(e){let n=this.getStatusText(e);return{A\u00E7\u0131k:"status-open",\u0130\u015Flemde:"status-progress","M\xFC\u015Fteri Bekleniyor":"status-waiting",\u00C7\u00F6z\u00FCld\u00FC:"status-resolved",Kapat\u0131ld\u0131:"status-closed"}[n]||""}getPriorityClass(e){let n=this.getPriorityText(e);return{D\u00FC\u015F\u00FCk:"priority-low",Orta:"priority-medium",Y\u00FCksek:"priority-high",Kritik:"priority-critical"}[n]||""}getStatusColor(e){let n=String(e??""),t=Number(e);return this.statusOptions.find(s=>Number(s.numericKey??s.sortOrder??s.id)===t||String(s.id)===n||String(s.key)===n||s.label===e||String(s.label)===n)?.color??null}getPriorityColor(e){let n=String(e??""),t=Number(e);return this.priorityOptions.find(s=>Number(s.numericKey??s.sortOrder??s.id)===t||String(s.id)===n||String(s.key)===n||s.label===e||String(s.label)===n)?.color??null}isTicketClosed(){if(!this.ticket)return!1;let e=this.getStatusText(this.ticket.status);return e==="Kapat\u0131ld\u0131"||e==="\xC7\xF6z\xFCld\xFC"}onFileSelected(e){let n=e.target.files;if(!n||n.length===0)return;let t=Array.from(n);if(t.find(w=>!w.type.startsWith("image/"))){this.errorMessage="Sadece resim dosyalar\u0131 y\xFCklenebilir.",setTimeout(()=>this.errorMessage="",3e3);return}if(t.find(w=>w.size>5*1024*1024)){this.errorMessage="Dosya boyutu 5MB'den k\xFC\xE7\xFCk olmal\u0131d\u0131r.",setTimeout(()=>this.errorMessage="",3e3);return}this.selectedFiles=t,this.uploadImages()}uploadImages(){if(this.selectedFiles.length===0||!this.ticket)return;this.isUploadingFile=!0,this.errorMessage="";let e=this.selectedFiles.map(n=>{let t=new FormData;return t.append("file",n),this.ticketService.uploadTicketImage(this.ticket.id,t)});B(e).subscribe({next:()=>{this.uploadSuccessMessage="Resimler ba\u015Far\u0131yla y\xFCklendi!",setTimeout(()=>this.uploadSuccessMessage="",3e3),this.selectedFiles=[],this.isUploadingFile=!1,this.resetFileInput(),this.loadImages(this.ticketId)},error:n=>{this.errorMessage=n.error?.message||"Resimler y\xFCklenirken bir hata olu\u015Ftu.",setTimeout(()=>this.errorMessage="",3e3),this.selectedFiles=[],this.isUploadingFile=!1,this.resetFileInput()}})}triggerFileInput(){let e=document.getElementById("fileInput");e&&e.click()}resetFileInput(){let e=document.getElementById("fileInput");e&&(e.value="")}static{this.\u0275fac=function(n){return new(n||o)(P(se),P(re),P(ce),P(X),P(j))}}static{this.\u0275cmp=R({type:o,selectors:[["app-customer-ticket-detail"]],viewQuery:function(n,t){if(n&1&&H(le,5),n&2){let l;L(l=G())&&(t.commentsContainer=l.first)}},standalone:!0,features:[Y],decls:10,vars:2,consts:[["commentsContainer",""],[1,"ticket-detail"],[1,"page-header"],["routerLink","/customer/tickets",1,"back-link"],["width","18","height","18","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2"],["points","15 18 9 12 15 6"],[1,"loading-container"],[1,"image-preview-overlay"],[1,"loading-spinner"],[1,"error-state"],["width","64","height","64","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","1.5"],["cx","12","cy","12","r","10"],["x1","15","y1","9","x2","9","y2","15"],["x1","9","y1","9","x2","15","y2","15"],["routerLink","/customer/tickets",1,"btn-back"],[1,"ticket-content"],[1,"ticket-left-column"],[1,"ticket-header-card"],[1,"ticket-title-section"],[1,"ticket-id"],[1,"header-actions"],[1,"ticket-badges"],[1,"badge",3,"ngClass"],[1,"btn-toggle-chat-header",3,"click"],["width","20","height","20","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2"],["d","M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"],[1,"description-section"],[1,"description-card"],[1,"card-header"],[1,"created-at"],["width","14","height","14","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2"],["points","12 6 12 12 16 14"],[1,"card-body"],[1,"attachment-card"],[1,"ticket-right-column"],[1,"info-sidebar-grid"],[1,"info-card-compact"],[1,"info-icon"],["x","3","y","4","width","18","height","18","rx","2","ry","2"],["x1","16","y1","2","x2","16","y2","6"],["x1","8","y1","2","x2","8","y2","6"],["x1","3","y1","10","x2","21","y2","10"],[1,"info-content"],[1,"info-label"],[1,"info-value"],[1,"comments-sidebar-section"],[1,"image-grid"],["type","button",1,"image-tile"],["type","button",1,"image-tile",3,"click"],[1,"ticket-image",3,"src","alt"],[1,"image-overlay"],["x","2","y","7","width","20","height","14","rx","2","ry","2"],["d","M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"],["d","M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"],["cx","12","cy","7","r","4"],[1,"comments-header"],[1,"btn-close-chat-sidebar",3,"click"],["x1","18","y1","6","x2","6","y2","18"],["x1","6","y1","6","x2","18","y2","18"],[1,"comments-list-sidebar"],[1,"no-comments-v2"],[1,"add-comment-sidebar","closed"],[1,"comment-v2",3,"admin-comment"],[1,"comment-v2"],[1,"comment-header-v2"],[1,"author-name-v2"],["class","author-role-v2",4,"ngIf"],[1,"comment-date-v2"],[1,"comment-message-v2"],[1,"author-role-v2"],[1,"closed-message"],["points","20 6 9 17 4 12"],[1,"add-comment-sidebar"],[1,"alert-error-inline"],[1,"alert-success-inline"],[1,"textarea-container"],["placeholder","Mesaj\u0131n\u0131z\u0131 yaz\u0131n...","rows","2",3,"ngModelChange","ngModel"],[1,"action-buttons"],["type","file","id","fileInput","accept","image/*","multiple","",2,"display","none",3,"change"],["title","Resim ekle",1,"btn-attachment",3,"click","disabled"],["width","18","height","18","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2",4,"ngIf"],["class","spinner-mini",4,"ngIf"],[1,"btn-send-mini",3,"click","disabled"],["d","M21.44 11.05l-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48"],[1,"spinner-mini"],["x1","22","y1","2","x2","11","y2","13"],["points","22 2 15 22 11 13 2 9 22 2"],[1,"chat-placeholder-card"],["width","40","height","40","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","1.5"],[1,"image-preview-overlay",3,"click"],[1,"preview-content",3,"click"],[1,"btn-close-preview",3,"click"],["alt","Buyuk Gorsel",3,"src"]],template:function(n,t){n&1&&(i(0,"div",1)(1,"div",2)(2,"a",3),p(),i(3,"svg",4),g(4,"polyline",5),a(),c(5," Taleplerime D\xF6n "),a()(),u(6,me,4,0,"div",6)(7,ge,11,0)(8,De,53,31),a(),u(9,ze,5,1,"div",7)),n&2&&(r(6),f(6,t.isLoading?6:t.ticket?8:7),r(3),f(9,t.showImagePreview?9:-1))},dependencies:[J,W,Q,$,ee,Z,ae,ne,ie,oe],styles:[".ticket-detail[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto;padding:0 20px}.page-header[_ngcontent-%COMP%]{margin-bottom:24px}.back-link[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:8px;color:#6b7280;text-decoration:none;font-size:14px;font-weight:500;transition:all .2s}.back-link[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{stroke-linecap:round;stroke-linejoin:round}.back-link[_ngcontent-%COMP%]:hover{color:#2563eb;transform:translate(-4px)}.loading-container[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:80px 20px;background:#fff;border-radius:16px;text-align:center;box-shadow:0 4px 12px #0000000d}.loading-container[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{color:#dee2e6;margin-bottom:15px;stroke-linecap:round;stroke-linejoin:round}.loading-container[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:20px;color:#1f2937;margin:0 0 8px}.loading-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#6b7280;margin-bottom:24px}.loading-container[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   .loading-spinner[_ngcontent-%COMP%]{width:48px;height:48px;border:4px solid #f3f4f6;border-top-color:#2563eb;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite}.loading-container[_ngcontent-%COMP%]   .btn-back[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   .btn-back[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:8px;padding:12px 24px;background:#2563eb;color:#fff;border:none;border-radius:10px;font-size:14px;font-weight:500;text-decoration:none;cursor:pointer;transition:all .2s}.loading-container[_ngcontent-%COMP%]   .btn-back[_ngcontent-%COMP%]:hover, .error-state[_ngcontent-%COMP%]   .btn-back[_ngcontent-%COMP%]:hover{background:#1d4ed8;box-shadow:0 4px 12px #2563eb33}.ticket-content[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(12,1fr);gap:24px;align-items:start}.ticket-left-column[_ngcontent-%COMP%]{grid-column:span 8;display:flex;flex-direction:column;gap:24px}.ticket-right-column[_ngcontent-%COMP%]{grid-column:span 4;display:flex;flex-direction:column;gap:24px;position:sticky;top:24px}.ticket-header-card[_ngcontent-%COMP%]{background:#fff;border-radius:16px;padding:28px;box-shadow:0 4px 15px #0000000d;display:flex;flex-direction:column;gap:24px;border:1px solid rgba(0,0,0,.05)}.ticket-header-card[_ngcontent-%COMP%]   .ticket-title-section[_ngcontent-%COMP%]   .ticket-id[_ngcontent-%COMP%]{display:inline-block;font-size:12px;font-weight:700;color:#2563eb;background:#eff6ff;padding:4px 12px;border-radius:20px;margin-bottom:8px}.ticket-header-card[_ngcontent-%COMP%]   .ticket-title-section[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:28px;font-weight:800;color:#111827;margin:0;line-height:1.2}.ticket-header-card[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding-top:16px;border-top:1px solid #f3f4f6}.ticket-header-card[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .ticket-badges[_ngcontent-%COMP%]{display:flex;gap:12px}.ticket-header-card[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .btn-toggle-chat-header[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:10px;padding:10px 24px;background:#fff;color:#2563eb;border:2px solid #2563eb;border-radius:12px;font-weight:700;font-size:14px;cursor:pointer;transition:all .2s cubic-bezier(.4,0,.2,1)}.ticket-header-card[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .btn-toggle-chat-header[_ngcontent-%COMP%]:hover{background:#eff6ff;transform:translateY(-2px)}.ticket-header-card[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .btn-toggle-chat-header.active[_ngcontent-%COMP%]{background:#2563eb;color:#fff}.ticket-header-card[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .btn-toggle-chat-header[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{stroke-linecap:round;stroke-linejoin:round}.info-sidebar-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr;gap:12px}.info-card-compact[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:16px;display:flex;align-items:center;gap:12px;border:1px solid #f3f4f6;transition:all .2s}.info-card-compact[_ngcontent-%COMP%]:hover{border-color:#d1d5db;box-shadow:0 4px 12px #00000008}.info-card-compact[_ngcontent-%COMP%]   .info-icon[_ngcontent-%COMP%]{width:40px;height:40px;background:#f9fafb;border-radius:10px;display:flex;align-items:center;justify-content:center;flex-shrink:0;color:#4b5563}.info-card-compact[_ngcontent-%COMP%]   .info-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{stroke-linecap:round;stroke-linejoin:round}.info-card-compact[_ngcontent-%COMP%]   .info-content[_ngcontent-%COMP%]{display:flex;flex-direction:column}.info-card-compact[_ngcontent-%COMP%]   .info-content[_ngcontent-%COMP%]   .info-label[_ngcontent-%COMP%]{font-size:11px;color:#9ca3af;font-weight:600;text-transform:uppercase;letter-spacing:.5px}.info-card-compact[_ngcontent-%COMP%]   .info-content[_ngcontent-%COMP%]   .info-value[_ngcontent-%COMP%]{font-size:13px;color:#1f2937;font-weight:700}.comments-sidebar-section[_ngcontent-%COMP%]{background:#fff;border-radius:16px;border:1px solid #f3f4f6;box-shadow:0 4px 15px #0000000d;display:flex;flex-direction:column;max-height:600px;overflow:hidden}.comments-sidebar-section[_ngcontent-%COMP%]   .comments-header[_ngcontent-%COMP%]{padding:16px 20px;border-bottom:1px solid #f3f4f6;display:flex;justify-content:space-between;align-items:center;background:#fafafa}.comments-sidebar-section[_ngcontent-%COMP%]   .comments-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:15px;font-weight:700;color:#111827;margin:0}.comments-sidebar-section[_ngcontent-%COMP%]   .comments-header[_ngcontent-%COMP%]   .btn-close-chat-sidebar[_ngcontent-%COMP%]{background:#fff;border:1px solid #e5e7eb;width:28px;height:28px;border-radius:50%;display:flex;align-items:center;justify-content:center;color:#9ca3af;cursor:pointer;transition:all .2s}.comments-sidebar-section[_ngcontent-%COMP%]   .comments-header[_ngcontent-%COMP%]   .btn-close-chat-sidebar[_ngcontent-%COMP%]:hover{background:#fee2e2;color:#ef4444;border-color:#fca5a5}.comments-list-sidebar[_ngcontent-%COMP%]{flex:1;padding:16px;overflow-y:auto;display:flex;flex-direction:column;gap:16px;background:#fff}.comments-list-sidebar[_ngcontent-%COMP%]::-webkit-scrollbar{width:4px}.comments-list-sidebar[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#e5e7eb;border-radius:10px}.comment-v2[_ngcontent-%COMP%]{padding:12px;background:#eff6ff;border-radius:12px;border:1px solid #dbeafe;max-width:85%;align-self:flex-end;border-right:3px solid #3b82f6;position:relative}.comment-v2.admin-comment[_ngcontent-%COMP%]{background:#f3f4f6;border-color:#e5e7eb;align-self:flex-start;border-right:none;border-left:3px solid #9ca3af}.comment-v2[_ngcontent-%COMP%]   .comment-header-v2[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;margin-bottom:6px}.comment-v2[_ngcontent-%COMP%]   .comment-header-v2[_ngcontent-%COMP%]   .author-name-v2[_ngcontent-%COMP%]{font-size:12px;font-weight:700;color:#111827}.comment-v2[_ngcontent-%COMP%]   .comment-header-v2[_ngcontent-%COMP%]   .author-role-v2[_ngcontent-%COMP%]{font-size:9px;font-weight:800;text-transform:uppercase;background:#3b82f6;color:#fff;padding:1px 6px;border-radius:4px}.comment-v2[_ngcontent-%COMP%]   .comment-header-v2[_ngcontent-%COMP%]   .comment-date-v2[_ngcontent-%COMP%]{font-size:11px;color:#9ca3af;margin-left:auto}.comment-v2[_ngcontent-%COMP%]   .comment-message-v2[_ngcontent-%COMP%]{font-size:13px;color:#4b5563;line-height:1.5;margin:0;white-space:pre-wrap}.add-comment-sidebar[_ngcontent-%COMP%]{padding:16px;background:#fafafa;border-top:1px solid #f3f4f6}.add-comment-sidebar[_ngcontent-%COMP%]   .alert-error-inline[_ngcontent-%COMP%], .add-comment-sidebar[_ngcontent-%COMP%]   .alert-success-inline[_ngcontent-%COMP%]{padding:8px 12px;border-radius:6px;font-size:13px;margin-bottom:10px;animation:_ngcontent-%COMP%_slideDown .3s ease}.add-comment-sidebar[_ngcontent-%COMP%]   .alert-error-inline[_ngcontent-%COMP%]{background:#fef2f2;color:#991b1b;border:1px solid #fecaca}.add-comment-sidebar[_ngcontent-%COMP%]   .alert-success-inline[_ngcontent-%COMP%]{background:#f0fdf4;color:#166534;border:1px solid #bbf7d0}@keyframes _ngcontent-%COMP%_slideDown{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}.add-comment-sidebar[_ngcontent-%COMP%]   .textarea-container[_ngcontent-%COMP%]{position:relative;display:flex;gap:10px;align-items:flex-end}.add-comment-sidebar[_ngcontent-%COMP%]   .textarea-container[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{flex:1;border:1px solid #e5e7eb;border-radius:10px;padding:10px;font-size:13px;resize:none;min-height:48px;outline:none;transition:all .2s}.add-comment-sidebar[_ngcontent-%COMP%]   .textarea-container[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus{border-color:#3b82f6;background:#fff;box-shadow:0 0 0 3px #3b82f61a}.add-comment-sidebar[_ngcontent-%COMP%]   .textarea-container[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]{display:flex;gap:8px;flex-shrink:0}.add-comment-sidebar[_ngcontent-%COMP%]   .textarea-container[_ngcontent-%COMP%]   .btn-attachment[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:10px;background:#f3f4f6;color:#6b7280;border:none;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all .2s;flex-shrink:0}.add-comment-sidebar[_ngcontent-%COMP%]   .textarea-container[_ngcontent-%COMP%]   .btn-attachment[_ngcontent-%COMP%]:hover:not(:disabled){background:#e5e7eb;color:#374151;transform:translateY(-2px)}.add-comment-sidebar[_ngcontent-%COMP%]   .textarea-container[_ngcontent-%COMP%]   .btn-attachment[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.add-comment-sidebar[_ngcontent-%COMP%]   .textarea-container[_ngcontent-%COMP%]   .btn-attachment[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{stroke-linecap:round;stroke-linejoin:round}.add-comment-sidebar[_ngcontent-%COMP%]   .textarea-container[_ngcontent-%COMP%]   .btn-send-mini[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:10px;background:#3b82f6;color:#fff;border:none;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all .2s;flex-shrink:0}.add-comment-sidebar[_ngcontent-%COMP%]   .textarea-container[_ngcontent-%COMP%]   .btn-send-mini[_ngcontent-%COMP%]:hover:not(:disabled){background:#2563eb;transform:translateY(-2px)}.add-comment-sidebar[_ngcontent-%COMP%]   .textarea-container[_ngcontent-%COMP%]   .btn-send-mini[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.add-comment-sidebar[_ngcontent-%COMP%]   .textarea-container[_ngcontent-%COMP%]   .spinner-mini[_ngcontent-%COMP%]{width:16px;height:16px;border:2px solid rgba(255,255,255,.3);border-top-color:#fff;border-radius:50%;animation:_ngcontent-%COMP%_spin .6s linear infinite}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.add-comment-sidebar.closed[_ngcontent-%COMP%]{background:#fef2f2;border-top:1px solid #fecaca}.add-comment-sidebar.closed[_ngcontent-%COMP%]   .closed-message[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;color:#991b1b;font-size:13px;font-weight:500}.add-comment-sidebar.closed[_ngcontent-%COMP%]   .closed-message[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{flex-shrink:0;stroke:#991b1b}.add-comment-sidebar.closed[_ngcontent-%COMP%]   .closed-message[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0}.chat-placeholder-card[_ngcontent-%COMP%]{padding:40px 24px;text-align:center;background:#fff;border-radius:16px;border:2px dashed #e5e7eb;color:#9ca3af;display:flex;flex-direction:column;align-items:center;gap:16px}.chat-placeholder-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px;line-height:1.5;margin:0}.no-comments-v2[_ngcontent-%COMP%]{text-align:center;padding:24px;color:#9ca3af;font-size:13px}@keyframes _ngcontent-%COMP%_slideDown{0%{opacity:0;transform:translateY(-20px)}to{opacity:1;transform:translateY(0)}}.spinner-mini[_ngcontent-%COMP%]{width:16px;height:16px;border:2px solid rgba(255,255,255,.3);border-top-color:#fff;border-radius:50%;animation:_ngcontent-%COMP%_spin .8s linear infinite}.status-badge[_ngcontent-%COMP%], .priority-badge[_ngcontent-%COMP%], .badge[_ngcontent-%COMP%]{padding:6px 14px;border-radius:8px;font-size:12px;font-weight:700;display:inline-flex}.status-open[_ngcontent-%COMP%]{background:#dcfce7;color:#166534;border:1px solid #bbf7d0}.status-processing[_ngcontent-%COMP%]{background:#f97316;color:#fff;border:1px solid #ea580c}.status-waitingforcustomer[_ngcontent-%COMP%]{background:#fef9c3;color:#854d0e;border:1px solid #fef08a}.status-resolved[_ngcontent-%COMP%]{background:#dcfce7;color:#166534;border:1px solid #bbf7d0}.status-closed[_ngcontent-%COMP%]{background:#f1f5f9;color:#475569;border:1px solid #e2e8f0}.priority-low[_ngcontent-%COMP%]{background:#f3f4f6;color:#374151}.priority-medium[_ngcontent-%COMP%]{background:#fef3c7;color:#92400e}.priority-high[_ngcontent-%COMP%]{background:#fee2e2;color:#991b1b}.priority-critical[_ngcontent-%COMP%]{background:#7f1d1d;color:#fff}.description-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:24px}.description-card[_ngcontent-%COMP%], .attachment-card[_ngcontent-%COMP%]{background:#fff;border-radius:16px;box-shadow:0 4px 15px #0000000d;overflow:hidden;border:1px solid rgba(0,0,0,.05)}.description-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%], .attachment-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]{padding:20px 24px;background:#fafafa;border-bottom:1px solid #f3f4f6;display:flex;justify-content:space-between;align-items:center}.description-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], .attachment-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:16px;font-weight:700;color:#111827;margin:0}.description-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .created-at[_ngcontent-%COMP%], .attachment-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .created-at[_ngcontent-%COMP%]{font-size:12px;color:#9ca3af;display:flex;align-items:center;gap:6px}.description-card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%], .attachment-card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{padding:24px}.description-card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .attachment-card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:15px;color:#374151;line-height:1.8;margin:0;white-space:pre-wrap}.attachment-card[_ngcontent-%COMP%]   .attachment-header[_ngcontent-%COMP%]{margin-bottom:16px}.attachment-card[_ngcontent-%COMP%]   .image-grid[_ngcontent-%COMP%]{padding:20px;background:#f9fafb;display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:12px}.attachment-card[_ngcontent-%COMP%]   .image-grid[_ngcontent-%COMP%]   .image-tile[_ngcontent-%COMP%]{display:block;border:none;padding:0;border-radius:12px;overflow:hidden;border:1px solid #e5e7eb;background:#fff;transition:transform .2s,box-shadow .2s;position:relative;cursor:zoom-in}.attachment-card[_ngcontent-%COMP%]   .image-grid[_ngcontent-%COMP%]   .image-tile[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 8px 20px #0000001a}.attachment-card[_ngcontent-%COMP%]   .image-grid[_ngcontent-%COMP%]   .image-tile[_ngcontent-%COMP%]:hover   .image-overlay[_ngcontent-%COMP%]{opacity:1}.attachment-card[_ngcontent-%COMP%]   .image-grid[_ngcontent-%COMP%]   .ticket-image[_ngcontent-%COMP%]{width:100%;height:120px;object-fit:cover;display:block}.attachment-card[_ngcontent-%COMP%]   .image-grid[_ngcontent-%COMP%]   .image-overlay[_ngcontent-%COMP%]{position:absolute;inset:0;background:#0006;display:flex;align-items:center;justify-content:center;opacity:0;transition:opacity .2s}.attachment-card[_ngcontent-%COMP%]   .image-grid[_ngcontent-%COMP%]   .image-overlay[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#fff;font-size:12px;font-weight:600;background:#0009;padding:6px 12px;border-radius:20px}.image-preview-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#000000e6;display:flex;align-items:center;justify-content:center;z-index:2000;padding:40px;cursor:zoom-out}.image-preview-overlay[_ngcontent-%COMP%]   .preview-content[_ngcontent-%COMP%]{position:relative;max-width:95%;max-height:95%;display:flex;align-items:center;justify-content:center;cursor:default}.image-preview-overlay[_ngcontent-%COMP%]   .preview-content[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:100%;max-height:90vh;border-radius:8px;box-shadow:0 0 30px #00000080}.image-preview-overlay[_ngcontent-%COMP%]   .preview-content[_ngcontent-%COMP%]   .btn-close-preview[_ngcontent-%COMP%]{position:fixed;top:20px;right:20px;background:#ffffff1a;border:2px solid #fff;color:#fff;font-size:22px;width:40px;height:40px;border-radius:50%;cursor:pointer;display:flex;align-items:center;justify-content:center}@media (max-width: 1024px){.ticket-left-column[_ngcontent-%COMP%]{grid-column:span 12}.ticket-right-column[_ngcontent-%COMP%]{grid-column:span 12;position:static}}@media (max-width: 640px){.ticket-header-card[_ngcontent-%COMP%]{padding:20px}.ticket-header-card[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]{flex-direction:column;gap:16px;align-items:flex-start}.ticket-header-card[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .btn-toggle-chat-header[_ngcontent-%COMP%]{width:100%;justify-content:center}.info-sidebar-grid[_ngcontent-%COMP%]{grid-template-columns:1fr 1fr}}"]})}}return o})();export{Je as CustomerTicketDetailComponent};
