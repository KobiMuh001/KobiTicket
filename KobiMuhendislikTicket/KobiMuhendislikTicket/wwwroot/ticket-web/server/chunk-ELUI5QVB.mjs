import './polyfills.server.mjs';
import{a as ct}from"./chunk-YRA3ON5Z.mjs";import{a as st}from"./chunk-5HZCGTUZ.mjs";import{b as q,c as J,f as Q,h as X,i as Z,j as tt,k as et,l as it,m as nt,r as rt}from"./chunk-7OSF6RCL.mjs";import{a as ot}from"./chunk-2CHIAAHK.mjs";import{a as at}from"./chunk-EBLE4SJK.mjs";import"./chunk-MGCRAORW.mjs";import"./chunk-YJ3U2WBC.mjs";import{k as H,n as U}from"./chunk-JGHH2ILE.mjs";import{Ab as j,Cb as R,Fa as c,Ga as M,N as w,Ta as _,Va as m,Wa as E,Xa as V,Ya as N,aa as B,db as r,eb as o,f as A,fb as k,ia as f,ib as v,ja as h,jb as p,ka as C,kb as d,la as I,lc as $,mc as G,o as z,oc as W,rb as l,rc as Y,sb as y,tb as b,va as D,vb as K,wb as P,xb as T,yb as S}from"./chunk-5C2672OW.mjs";import{a as O,b as F,h as L}from"./chunk-VVCT4QZE.mjs";var lt=s=>["/staff/tickets",s];function ut(s,g){if(s&1&&(r(0,"option",29),l(1),o()),s&2){let t=g.$implicit;m("value",t.value),c(),y(t.label)}}function ft(s,g){if(s&1&&(r(0,"option",29),l(1),o()),s&2){let t=g.$implicit;m("value",t.value),c(),y(t.label)}}function ht(s,g){if(s&1&&(r(0,"option",29),l(1),o()),s&2){let t=g.$implicit;m("value",t),c(),y(t)}}function _t(s,g){if(s&1){let t=v();r(0,"button",30),p("click",function(){f(t);let e=d();return h(e.clearFilters())}),C(),r(1,"svg",31),k(2,"line",32)(3,"line",33),o(),l(4," Temizle "),o()}}function yt(s,g){s&1&&(r(0,"div",34),k(1,"div",35),r(2,"p"),l(3,"Ticketlar y\xFCkleniyor..."),o()())}function kt(s,g){if(s&1&&(r(0,"div",36),C(),r(1,"svg",13),k(2,"circle",37)(3,"line",38)(4,"line",39),o(),l(5),o()),s&2){let t=d();c(5),b(" ",t.error," ")}}function Ct(s,g){if(s&1&&(r(0,"div",40),l(1),o()),s&2){let t=d();c(),b(" ",t.successMessage," ")}}function xt(s,g){s&1&&(r(0,"div",41),C(),r(1,"svg",42),k(2,"path",43)(3,"polyline",44),o(),I(),r(4,"h3"),l(5,"Ticket bulunamad\u0131"),o(),r(6,"p"),l(7,"Arama kriterlerinize uygun ticket bulunmuyor."),o()())}function bt(s,g){if(s&1&&(r(0,"span",61),l(1),C(),r(2,"svg",62),k(3,"path",63)(4,"path",64),o()()),s&2){let t=d().$implicit,i=d(2);c(),b("",i.getTicketNotificationCount(t.id)," ")}}function vt(s,g){if(s&1&&(r(0,"small"),l(1),o()),s&2){let t=d().$implicit;c(),y(t.assetName)}}function Mt(s,g){if(s&1){let t=v();r(0,"button",65),p("click",function(e){f(t);let n=d().$implicit,a=d(2);return h(a.openReleaseConfirm(n.id,e,n.title))}),C(),r(1,"svg",7),k(2,"line",66)(3,"polyline",67),o()()}}function Pt(s,g){if(s&1){let t=v();r(0,"tr",52),p("click",function(){let e=f(t).$implicit,n=d(2);return h(n.onTicketSelect(e.id))}),r(1,"td")(2,"div",53)(3,"span",54),l(4),o(),_(5,bt,5,1,"span",55),o()(),r(6,"td")(7,"div",56)(8,"span"),l(9),o(),_(10,vt,2,1,"small",57),o()(),r(11,"td"),l(12),o(),r(13,"td")(14,"span",58),l(15),o()(),r(16,"td")(17,"span",58),l(18),o()(),r(19,"td"),l(20),o(),r(21,"td")(22,"div",59),p("click",function(e){return f(t),h(e.stopPropagation())}),_(23,Mt,4,0,"button",60),o()()()}if(s&2){let t=g.$implicit,i=d(2);V("has-notification",i.getTicketNotificationCount(t.id)>0),m("routerLink",R(24,lt,t.id)),c(4),y(i.formatTicketId(t.id,t.ticketCode)),c(),m("ngIf",i.getTicketNotificationCount(t.id)>0),c(4),y(t.title),c(),m("ngIf",t.assetName),c(2),y(t.companyName||"-"),c(2),N("badge--"+i.getStatusClass(t.status)),E("background-color",i.getStatusColor(t.status))("color",i.getStatusColor(t.status)?"#fff":null),c(),b(" ",i.getStatusText(t.status)," "),c(2),N("badge--"+i.getPriorityClass(t.priority)),E("background-color",i.getPriorityColor(t.priority))("color",i.getPriorityColor(t.priority)?"#fff":null),c(),b(" ",i.getPriorityText(t.priority)," "),c(2),y(i.formatDate(t.createdDate)),c(3),m("ngIf",t.status!==4&&t.status!==5)}}function Tt(s,g){if(s&1&&(r(0,"span",61),l(1),o()),s&2){let t=d().$implicit,i=d(2);c(),y(i.getTicketNotificationCount(t.id))}}function St(s,g){if(s&1){let t=v();r(0,"button",65),p("click",function(e){f(t);let n=d().$implicit,a=d(2);return h(a.openReleaseConfirm(n.id,e,n.title))}),C(),r(1,"svg",7),k(2,"line",66)(3,"polyline",67),o()()}}function Ot(s,g){if(s&1){let t=v();r(0,"div",68),p("click",function(){let e=f(t).$implicit,n=d(2);return h(n.onTicketSelect(e.id))}),r(1,"div",69)(2,"span",54),l(3),o(),_(4,Tt,2,1,"span",55),o(),r(5,"div",70),l(6),o(),r(7,"div",71)(8,"div",72)(9,"span",73),l(10,"M\xFC\u015Fteri"),o(),r(11,"span",74),l(12),o()(),r(13,"div",72)(14,"span",73),l(15,"Durum"),o(),r(16,"span",58),l(17),o()(),r(18,"div",72)(19,"span",73),l(20,"\xD6ncelik"),o(),r(21,"span",58),l(22),o()(),r(23,"div",72)(24,"span",73),l(25,"Tarih"),o(),r(26,"span",74),l(27),o()()(),r(28,"div",75),p("click",function(e){return f(t),h(e.stopPropagation())}),_(29,St,4,0,"button",60),o()()}if(s&2){let t=g.$implicit,i=d(2);V("has-notification",i.getTicketNotificationCount(t.id)>0),m("routerLink",R(23,lt,t.id)),c(3),y(i.formatTicketId(t.id,t.ticketCode)),c(),m("ngIf",i.getTicketNotificationCount(t.id)>0),c(2),y(t.title),c(6),y(t.companyName||"-"),c(4),N("badge--"+i.getStatusClass(t.status)),E("background-color",i.getStatusColor(t.status))("color",i.getStatusColor(t.status)?"#fff":null),c(),b(" ",i.getStatusText(t.status)," "),c(4),N("badge--"+i.getPriorityClass(t.priority)),E("background-color",i.getPriorityColor(t.priority))("color",i.getPriorityColor(t.priority)?"#fff":null),c(),b(" ",i.getPriorityText(t.priority)," "),c(5),y(i.formatDate(t.createdDate)),c(2),m("ngIf",t.status!==4&&t.status!==5)}}function wt(s,g){if(s&1){let t=v();r(0,"div",76)(1,"button",77),p("click",function(){f(t);let e=d(2);return h(e.previousPage())}),C(),r(2,"svg",31),k(3,"polyline",78),o(),l(4," \xD6nceki "),o(),I(),r(5,"div",79)(6,"input",80),S("ngModelChange",function(e){f(t);let n=d(2);return T(n.currentPage,e)||(n.currentPage=e),h(e)}),p("change",function(){f(t);let e=d(2);return h(e.onPageChange(e.currentPage))}),o(),r(7,"span",81),l(8),o()(),r(9,"button",77),p("click",function(){f(t);let e=d(2);return h(e.nextPage())}),l(10," Sonraki "),C(),r(11,"svg",31),k(12,"polyline",82),o()()()}if(s&2){let t=d(2);c(),m("disabled",t.currentPage===1),c(5),P("ngModel",t.currentPage),m("max",t.totalPages),c(2),b("/ ",t.totalPages,""),c(),m("disabled",t.currentPage===t.totalPages)}}function It(s,g){if(s&1&&(r(0,"div",45)(1,"div",46)(2,"table",47)(3,"thead")(4,"tr")(5,"th"),l(6,"ID"),o(),r(7,"th"),l(8,"Ba\u015Fl\u0131k"),o(),r(9,"th"),l(10,"M\xFC\u015Fteri"),o(),r(11,"th"),l(12,"Durum"),o(),r(13,"th"),l(14,"\xD6ncelik"),o(),r(15,"th"),l(16,"Tarih"),o(),r(17,"th"),l(18,"\u0130\u015Flemler"),o()()(),r(19,"tbody"),_(20,Pt,24,26,"tr",48),o()()(),r(21,"div",49),_(22,Ot,30,25,"div",50),o(),_(23,wt,13,5,"div",51),o()),s&2){let t=d();c(20),m("ngForOf",t.filteredTickets)("ngForTrackBy",t.trackByTicketId),c(2),m("ngForOf",t.filteredTickets)("ngForTrackBy",t.trackByTicketId),c(),m("ngIf",t.totalPages>1)}}function Et(s,g){if(s&1&&(r(0,"p")(1,"strong"),l(2),o()()),s&2){let t=d(2);c(2),y(t.ticketToReleaseTitle)}}function Nt(s,g){if(s&1){let t=v();r(0,"div",83),p("click",function(){f(t);let e=d();return h(e.closeReleaseConfirm())}),r(1,"div",84),p("click",function(e){return f(t),h(e.stopPropagation())}),r(2,"div",85)(3,"h3"),l(4,"Ticket\u0131 B\u0131rak"),o(),r(5,"button",86),p("click",function(){f(t);let e=d();return h(e.closeReleaseConfirm())}),l(6,"\xD7"),o()(),r(7,"div",87)(8,"p"),l(9,"Bu ticket\u0131 b\u0131rakmak istedi\u011Finize emin misiniz?"),o(),_(10,Et,3,1,"p",57),o(),r(11,"div",88)(12,"button",89),p("click",function(){f(t);let e=d();return h(e.closeReleaseConfirm())}),l(13,"\u0130ptal"),o(),r(14,"button",90),p("click",function(){f(t);let e=d();return h(e.confirmRelease())}),l(15,"Tamam"),o()()()()}if(s&2){let t=d();c(10),m("ngIf",t.ticketToReleaseTitle)}}var Jt=(()=>{class s{constructor(t,i,e,n,a){this.staffService=t,this.signalRService=i,this.paramSvc=e,this.notificationService=n,this.platformId=a,this.tickets=[],this.filteredTickets=[],this.allTicketsCache=null,this.notifications=[],this.ticketNotifications=new Map,this.isLoading=!0,this.error=null,this.successMessage=null,this.currentPage=1,this.itemsPerPage=20,this.totalPages=1,this.totalCount=0,this.selectedStatus="",this.selectedPriority="",this.selectedCustomer="",this.searchTerm="",this.customers=[],this.destroy$=new A,this.statusOptions=[],this.priorityOptions=[],this.showReleaseConfirm=!1,this.ticketToReleaseId=null,this.ticketToReleaseTitle=null,this.isBrowser=Y(this.platformId)}ngOnInit(){this.loadTickets(),setTimeout(()=>{this.initSignalR(),this.subscribeToNotifications()},1e3),this.loadLookups()}fetchAllMyTicketsPaginated(t=200){return L(this,null,function*(){let i=[],e=1;try{for(;;){let n=yield z(this.staffService.getMyTickets(e,t));if(!n)break;let a=[];n.data&&Array.isArray(n.data)?a=n.data:Array.isArray(n)&&(a=n),a.length&&i.push(...a);let u=n&&n.totalPages?n.totalPages:Math.ceil((n.totalCount??a.length)/t||1);if(!u||e>=u)break;e++}}catch(n){throw n}return i})}loadLookups(){let t=this.paramSvc;t&&(t.getByGroup("TicketStatus").subscribe({next:i=>{let e=i?.data?.data||i?.data||i||[];e=(Array.isArray(e)?e.slice():[]).sort((n,a)=>{let u=n.sortOrder??n.numericKey??null,x=a.sortOrder??a.numericKey??null;return u!==null&&x!==null?u-x:u!==null?-1:x!==null?1:0}),this.statusOptions=e.map((n,a)=>({id:n.id,value:n.numericKey!=null?String(n.numericKey):"",label:n.numericKey!=null?n.value||n.key||n.description:"",key:n.numericKey??n.key,numericKey:n.numericKey??(typeof n.key=="number"?n.key:Number.isFinite(Number(n.key))?Number(n.key):null),sortOrder:n.sortOrder??a+1,color:n.numericKey!=null?n.value2??n.color??null:null}))},error:()=>{this.statusOptions=[]}}),t.getByGroup("TicketPriority").subscribe({next:i=>{let e=i?.data?.data||i?.data||i||[];e=(Array.isArray(e)?e.slice():[]).sort((n,a)=>{let u=n.sortOrder??n.numericKey??null,x=a.sortOrder??a.numericKey??null;return u!==null&&x!==null?u-x:u!==null?-1:x!==null?1:0}),this.priorityOptions=e.map((n,a)=>({id:n.id,value:n.numericKey!=null?String(n.numericKey):"",label:n.numericKey!=null?n.value||n.key||n.description:"",key:n.numericKey??n.key,numericKey:n.numericKey??(typeof n.key=="number"?n.key:Number.isFinite(Number(n.key))?Number(n.key):null),sortOrder:n.sortOrder??a+1,color:n.numericKey!=null?n.value2??n.color??null:null}))},error:()=>{this.priorityOptions=[]}}))}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}initSignalR(){if(!this.isBrowser){console.log("SignalR: Not in browser environment");return}let t=localStorage.getItem("token")||sessionStorage.getItem("token");t&&this.signalRService.startConnection(t).catch(i=>{console.error("SignalR ba\u011Flant\u0131 hatas\u0131:",i)})}subscribeToNotifications(){this.notificationService.notificationsList$.pipe(w(this.destroy$)).subscribe(t=>{this.notifications=t,this.updateTicketNotificationCounts()}),this.signalRService.commentReceived$.pipe(w(this.destroy$)).subscribe(t=>{let i=Number(t.ticketId),e=this.tickets.find(n=>n.id===i);if(e){let n={id:`notif-${Date.now()}-${Math.random()}`,title:`${e.title} - Yeni Yorum`,message:`${t.authorName}: ${t.message.substring(0,50)}...`,type:"comment",isRead:!1,ticketId:t.ticketId,createdDate:new Date().toISOString()};this.notificationService.addNotificationDirectly(n),this.updateTicketNotificationCounts()}}),this.signalRService.ticketUpdated$.pipe(w(this.destroy$)).subscribe(t=>{console.log("Real-time ticket update received:",t),this.updateTicketInList(t)}),this.notificationService.notificationsList$.pipe(w(this.destroy$)).subscribe(t=>{t.some(e=>!e.isRead&&e.type==="TicketAssigned")&&(console.log("New ticket assignment detected, refreshing list..."),this.loadTickets())})}updateTicketInList(t){let i=Number(t.id);if(this.allTicketsCache){let n=this.allTicketsCache.findIndex(a=>a.id===i);n!==-1&&(this.allTicketsCache[n]=F(O(O({},this.allTicketsCache[n]),t),{companyName:t.tenantName}))}let e=this.tickets.findIndex(n=>n.id===i);e!==-1&&(this.tickets[e]=F(O(O({},this.tickets[e]),t),{companyName:t.tenantName}),this.applyFilters())}updateTicketNotificationCounts(){this.ticketNotifications.clear(),this.notifications.forEach(t=>{if(t.ticketId&&!t.isRead){let i=Number(t.ticketId),e=this.ticketNotifications.get(i)||0;this.ticketNotifications.set(i,e+1)}})}getTicketNotificationCount(t){return this.ticketNotifications.get(t)||0}joinTicketGroups(){this.isBrowser&&this.tickets.forEach(t=>{this.signalRService.joinTicketGroup(t.id.toString()).catch(i=>{console.error(`Error joining ticket group ${t.id}:`,i)})})}loadTickets(){if(this.isLoading=!0,!!(this.selectedStatus||this.selectedPriority||this.selectedCustomer||this.searchTerm)){if(this.allTicketsCache){this.tickets=this.allTicketsCache,this.applyFilters(),this.isLoading=!1;return}this.fetchAllMyTicketsPaginated().then(i=>{this.tickets=i||[],this.allTicketsCache=this.tickets,this.extractCustomers(),this.joinTicketGroups(),this.applyFilters(),this.isLoading=!1}).catch(()=>{this.error="Ticketlar y\xFCklenirken hata olu\u015Ftu",this.isLoading=!1});return}this.allTicketsCache=null,this.staffService.getMyTickets(this.currentPage,this.itemsPerPage).subscribe({next:i=>{let e=[],n=0,a=1,u=i&&i.success!==void 0?i.data??null:i;Array.isArray(u)?(e=u,n=e.length,a=Math.max(1,Math.ceil(n/this.itemsPerPage))):u&&Array.isArray(u.items)?(e=u.items,n=u.totalCount??e.length,a=u.totalPages??Math.max(1,Math.ceil(n/this.itemsPerPage))):i&&Array.isArray(i.items)?(e=i.items,n=i.totalCount??e.length,a=i.totalPages??Math.max(1,Math.ceil(n/this.itemsPerPage))):Array.isArray(i)?(e=i,n=e.length,a=Math.max(1,Math.ceil(n/this.itemsPerPage))):i&&i.data&&Array.isArray(i.data)&&(e=i.data,n=e.length,a=Math.max(1,Math.ceil(n/this.itemsPerPage))),this.tickets=e,this.extractCustomers(),this.joinTicketGroups(),this.applyFilters(),this.totalCount=n,this.totalPages=a,!i?.totalCount&&!i?.totalPages&&a===1&&Array.isArray(e)&&e.length===this.itemsPerPage&&(this.totalPages=this.currentPage+1),this.totalPages<this.currentPage&&(this.totalPages=this.currentPage),!this.totalCount&&this.totalPages>1&&(this.totalCount=this.totalPages*this.itemsPerPage),this.isLoading=!1},error:i=>{this.error="Ticketlar y\xFCklenirken hata olu\u015Ftu",this.isLoading=!1}})}extractCustomers(){let t=new Set;this.tickets.forEach(i=>{i.companyName&&t.add(i.companyName)}),this.customers=Array.from(t).sort()}applyFilters(){let t=this.normalizeForSearch(this.searchTerm||""),i=this.tickets.filter(e=>{let n=String(e.id??""),a=this.normalizeForSearch(e.title||""),u=this.normalizeForSearch(e.companyName||""),x=this.normalizeForSearch(n),dt=!t||a.includes(t)||u.includes(t)||x.includes(t),mt=!this.selectedStatus||e.status.toString()===this.selectedStatus,gt=!this.selectedPriority||e.priority.toString()===this.selectedPriority,pt=!this.selectedCustomer||e.companyName===this.selectedCustomer;return dt&&mt&&gt&&pt});if(this.allTicketsCache){this.totalCount=i.length,this.totalPages=Math.max(1,Math.ceil(this.totalCount/this.itemsPerPage));let e=(this.currentPage-1)*this.itemsPerPage;this.filteredTickets=i.slice(e,e+this.itemsPerPage)}else this.filteredTickets=i,this.totalCount=this.filteredTickets.length}onStatusFilterChange(t){this.selectedStatus=t.target.value,this.currentPage=1,this.loadTickets()}onPriorityFilterChange(t){this.selectedPriority=t.target.value,this.currentPage=1,this.loadTickets()}onCustomerFilterChange(t){this.selectedCustomer=t.target.value,this.currentPage=1,this.loadTickets()}openReleaseConfirm(t,i,e){i&&(i.stopPropagation(),i.preventDefault()),this.ticketToReleaseId=Number(t),this.ticketToReleaseTitle=e||null,this.showReleaseConfirm=!0}closeReleaseConfirm(){this.ticketToReleaseId=null,this.ticketToReleaseTitle=null,this.showReleaseConfirm=!1}confirmRelease(){if(!this.ticketToReleaseId)return;let t=this.ticketToReleaseId;this.staffService.releaseTicket(t).subscribe({next:i=>{i.success&&(this.successMessage="Ticket ba\u015Far\u0131yla b\u0131rak\u0131ld\u0131",this.loadTickets(),setTimeout(()=>this.successMessage=null,3e3)),this.closeReleaseConfirm()},error:i=>{this.error=i.error?.message||"Ticket b\u0131rak\u0131l\u0131rken hata olu\u015Ftu",this.closeReleaseConfirm()}})}getStatusText(t){let i=Number(t),e=this.statusOptions.find(n=>Number(n.numericKey??n.sortOrder??n.id)===i||String(n.id)===String(t)||String(n.key)===String(t)||n.label===t);if(e)return e.label||"Bilinmiyor";switch(t){case 1:return"A\xE7\u0131k";case 2:return"\u0130\u015Flemde";case 3:return"M\xFC\u015Fteri Bekliyor";case 4:return"\xC7\xF6z\xFCld\xFC";case 5:return"Kapal\u0131";default:return"Bilinmiyor"}}getStatusClass(t){return{1:"open",2:"in-progress",3:"waiting",4:"resolved",5:"closed"}[t]||"open"}getPriorityText(t){let i=Number(t),e=this.priorityOptions.find(n=>Number(n.numericKey??n.sortOrder??n.id)===i||String(n.id)===String(t)||String(n.key)===String(t)||n.label===t);if(e)return e.label||"Normal";switch(t){case 1:return"D\xFC\u015F\xFCk";case 2:return"Normal";case 3:return"Y\xFCksek";case 4:return"Kritik";default:return"Normal"}}getPriorityClass(t){return{1:"low",2:"medium",3:"high",4:"critical"}[t]||"low"}getStatusColor(t){let i=String(t??""),e=Number(t);return this.statusOptions.find(a=>Number(a.numericKey??a.sortOrder??a.id)===e||String(a.id)===i||String(a.key)===i||a.label===t||String(a.label)===i)?.color??null}getPriorityColor(t){let i=String(t??""),e=Number(t);return this.priorityOptions.find(a=>Number(a.numericKey??a.sortOrder??a.id)===e||String(a.id)===i||String(a.key)===i||a.label===t||String(a.label)===i)?.color??null}markNotificationAsRead(t){this.notificationService.markAsRead(t).subscribe({next:()=>{let i=this.notifications.find(e=>e.id===t);i&&(i.isRead=!0,this.updateTicketNotificationCounts())}})}deleteNotification(t){let i=this.notifications.find(e=>e.id===t);if(i){let e=this.notifications.indexOf(i);e>-1&&(this.notifications.splice(e,1),this.updateTicketNotificationCounts())}}onTicketSelect(t){this.notifications.filter(e=>e.ticketId&&Number(e.ticketId)===t&&!e.isRead).forEach(e=>{this.notificationService.markAsRead(e.id).subscribe({next:()=>{e.isRead=!0}})}),this.updateTicketNotificationCounts()}formatDate(t){if(!t)return"-";try{let i=new Date(t);return isNaN(i.getTime())?"-":i.toLocaleDateString("tr-TR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return"-"}}normalizeForSearch(t){try{return(t??"").toString().toLocaleLowerCase("tr").normalize("NFD").replace(/[\u0300-\u036f]/g,"")}catch{return(t??"").toString().toLowerCase()}}trackByTicketId(t,i){return i?.id??t}formatTicketId(t,i){if(i)return i;if(t==null)return"-";let e=typeof t=="number"?t:Number(t);return Number.isFinite(e)?`T${e.toString().padStart(5,"0")}`:String(t)}clearFilters(){this.searchTerm="",this.selectedStatus="",this.selectedPriority="",this.selectedCustomer="",this.currentPage=1,this.loadTickets()}get unreadNotificationsCount(){return this.notifications.filter(t=>!t.isRead).length}goToPage(t){t>=1&&t<=this.totalPages&&(this.currentPage=t,this.loadTickets())}nextPage(){this.goToPage(this.currentPage+1)}previousPage(){this.goToPage(this.currentPage-1)}onPageChange(t){this.goToPage(t)}get paginatedTickets(){return this.filteredTickets}static{this.\u0275fac=function(i){return new(i||s)(M(ct),M(at),M(st),M(ot),M(D))}}static{this.\u0275cmp=B({type:s,selectors:[["app-my-tickets"]],standalone:!0,features:[j],decls:43,vars:17,consts:[[1,"tickets-page"],[1,"page-header"],[1,"header-left"],[1,"page-title"],[1,"page-subtitle"],[1,"header-right"],[1,"btn","btn-primary",3,"click"],["width","18","height","18","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2"],["points","23 4 23 10 17 10"],["d","M20.49 15a9 9 0 1 1-2.12-9.36L23 10"],[1,"filters-card"],[1,"filters-row"],[1,"search-box"],["width","20","height","20","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2"],["cx","11","cy","11","r","8"],["x1","21","y1","21","x2","16.65","y2","16.65"],["type","text","placeholder","Ticket ara...",3,"ngModelChange","input","ngModel"],[1,"filter-group"],[1,"filter-select",3,"ngModelChange","change","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],["class","btn btn-outline btn-sm",3,"click",4,"ngIf"],[1,"results-info"],["class","loading-container",4,"ngIf"],["class","alert alert-error",4,"ngIf"],["class","alert alert-success",4,"ngIf"],["class","empty-state",4,"ngIf"],["class","tickets-table-card",4,"ngIf"],["class","release-overlay",3,"click",4,"ngIf"],[3,"value"],[1,"btn","btn-outline","btn-sm",3,"click"],["width","16","height","16","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2"],["x1","18","y1","6","x2","6","y2","18"],["x1","6","y1","6","x2","18","y2","18"],[1,"loading-container"],[1,"spinner"],[1,"alert","alert-error"],["cx","12","cy","12","r","10"],["x1","15","y1","9","x2","9","y2","15"],["x1","9","y1","9","x2","15","y2","15"],[1,"alert","alert-success"],[1,"empty-state"],["width","64","height","64","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","1.5"],["d","M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"],["points","14 2 14 8 20 8"],[1,"tickets-table-card"],[1,"table-wrapper"],[1,"table"],[3,"has-notification","routerLink","click",4,"ngFor","ngForOf","ngForTrackBy"],[1,"tickets-cards"],["class","ticket-card",3,"has-notification","routerLink","click",4,"ngFor","ngForOf","ngForTrackBy"],["class","pagination-controls",4,"ngIf"],[3,"click","routerLink"],[1,"ticket-id-container"],[1,"ticket-code"],["class","notification-badge",4,"ngIf"],[1,"ticket-title"],[4,"ngIf"],[1,"badge"],[1,"actions",3,"click"],["class","action-btn","title","B\u0131rak",3,"click",4,"ngIf"],[1,"notification-badge"],["width","14","height","14","viewBox","0 0 24 24","fill","currentColor","stroke","none"],["d","M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"],["d","M13.73 21a2 2 0 0 1-3.46 0"],["title","B\u0131rak",1,"action-btn",3,"click"],["x1","21","y1","12","x2","7","y2","12"],["points","14 5 7 12 14 19"],[1,"ticket-card",3,"click","routerLink"],[1,"ticket-card-header"],[1,"ticket-card-title"],[1,"ticket-card-meta"],[1,"meta-row"],[1,"meta-label"],[1,"meta-value"],[1,"ticket-card-actions",3,"click"],[1,"pagination-controls"],[1,"btn","btn-outline","btn-sm",3,"click","disabled"],["points","15 18 9 12 15 6"],[1,"pagination-input"],["type","number","min","1",1,"page-input",3,"ngModelChange","change","ngModel","max"],[1,"page-info"],["points","9 18 15 12 9 6"],[1,"release-overlay",3,"click"],[1,"release-card","card",3,"click"],[1,"card-header"],[1,"modal-close",3,"click"],[1,"card-body"],[1,"card-actions"],[1,"btn","btn-outline",3,"click"],[1,"btn","btn-danger",3,"click"]],template:function(i,e){i&1&&(r(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1",3),l(4,"Ticketlar\u0131m"),o(),r(5,"p",4),l(6,"Size atanm\u0131\u015F t\xFCm destek taleplerini y\xF6netin."),o()(),r(7,"div",5)(8,"button",6),p("click",function(){return e.loadTickets()}),C(),r(9,"svg",7),k(10,"polyline",8)(11,"path",9),o(),l(12," Yenile "),o()()(),I(),r(13,"div",10)(14,"div",11)(15,"div",12),C(),r(16,"svg",13),k(17,"circle",14)(18,"line",15),o(),I(),r(19,"input",16),S("ngModelChange",function(a){return T(e.searchTerm,a)||(e.searchTerm=a),a}),p("input",function(){return e.applyFilters()}),o()(),r(20,"div",17)(21,"select",18),S("ngModelChange",function(a){return T(e.selectedStatus,a)||(e.selectedStatus=a),a}),p("change",function(){return e.loadTickets()}),r(22,"option",19),l(23,"T\xFCm Durumlar"),o(),_(24,ut,2,2,"option",20),o(),r(25,"select",18),S("ngModelChange",function(a){return T(e.selectedPriority,a)||(e.selectedPriority=a),a}),p("change",function(){return e.loadTickets()}),r(26,"option",19),l(27,"T\xFCm \xD6ncelikler"),o(),_(28,ft,2,2,"option",20),o(),r(29,"select",18),S("ngModelChange",function(a){return T(e.selectedCustomer,a)||(e.selectedCustomer=a),a}),p("change",function(){return e.loadTickets()}),r(30,"option",19),l(31,"T\xFCm M\xFC\u015Fteriler"),o(),_(32,ht,2,2,"option",20),o(),_(33,_t,5,0,"button",21),o()(),r(34,"div",22)(35,"span"),l(36),o()()(),_(37,yt,4,0,"div",23)(38,kt,6,1,"div",24)(39,Ct,2,1,"div",25)(40,xt,8,0,"div",26)(41,It,24,5,"div",27)(42,Nt,16,1,"div",28),o()),i&2&&(c(19),P("ngModel",e.searchTerm),c(2),P("ngModel",e.selectedStatus),c(3),m("ngForOf",e.statusOptions),c(),P("ngModel",e.selectedPriority),c(3),m("ngForOf",e.priorityOptions),c(),P("ngModel",e.selectedCustomer),c(3),m("ngForOf",e.customers),c(),m("ngIf",e.searchTerm||e.selectedStatus||e.selectedPriority||e.selectedCustomer),c(3),K("Sayfa ",e.currentPage," / ",e.totalPages," (Toplamda ",e.totalCount," ticket)"),c(),m("ngIf",e.isLoading),c(),m("ngIf",!e.isLoading&&e.error),c(),m("ngIf",!e.isLoading&&e.successMessage),c(),m("ngIf",!e.isLoading&&!e.error&&e.filteredTickets.length===0),c(),m("ngIf",!e.isLoading&&!e.error&&e.filteredTickets.length>0),c(),m("ngIf",e.showReleaseConfirm))},dependencies:[W,$,G,U,H,rt,tt,et,q,X,Z,J,nt,it,Q],styles:[`.tickets-page[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .3s ease}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}.page-header[_ngcontent-%COMP%]{display:flex;align-items:flex-start;justify-content:space-between;margin-bottom:1.5rem;gap:1rem;flex-wrap:wrap}.page-header[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]   .page-title[_ngcontent-%COMP%]{font-size:1.75rem;font-weight:700;color:var(--text-primary);margin:0 0 .25rem}.page-header[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]   .page-subtitle[_ngcontent-%COMP%]{color:var(--text-secondary);margin:0}.filters-card[_ngcontent-%COMP%]{background:var(--bg-secondary);border-radius:var(--radius-lg);padding:1.25rem;margin-bottom:1.5rem;box-shadow:var(--shadow-sm)}.filters-row[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;flex-wrap:wrap}.search-box[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:.5rem 1rem;background:var(--bg-primary);border:1px solid var(--border-color);border-radius:var(--radius-md);flex:1;min-width:250px}.search-box[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{color:var(--text-light);flex-shrink:0}.search-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{flex:1;border:none;background:none;font-size:.875rem;color:var(--text-primary)}.search-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::placeholder{color:var(--text-light)}.search-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none}.filter-group[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem}.filter-select[_ngcontent-%COMP%]{padding:.5rem 2rem .5rem .75rem;font-size:.875rem;border:1px solid var(--border-color);border-radius:var(--radius-md);background:var(--bg-secondary);color:var(--text-primary);cursor:pointer;appearance:none;background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='%236c757d' stroke-width='2'%3E%3Cpolyline points='6 9 12 15 18 9'/%3E%3C/svg%3E");background-repeat:no-repeat;background-position:right .5rem center}.filter-select[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--primary-color)}.btn-sm[_ngcontent-%COMP%]{padding:.5rem .75rem;font-size:.75rem}.results-info[_ngcontent-%COMP%]{margin-top:1rem;padding-top:1rem;border-top:1px solid var(--border-light);font-size:.875rem;color:var(--text-secondary)}.loading-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:4rem 2rem;background:var(--bg-secondary);border-radius:var(--radius-lg)}.loading-container[_ngcontent-%COMP%]   .spinner[_ngcontent-%COMP%]{width:40px;height:40px;border:3px solid var(--border-color);border-top-color:var(--primary-color);border-radius:50%;animation:_ngcontent-%COMP%_spin .8s linear infinite;margin-bottom:1rem}.loading-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--text-secondary)}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.alert[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;padding:1rem;border-radius:var(--radius-md);margin-bottom:1.5rem}.alert-error[_ngcontent-%COMP%]{background:#fef2f2;color:#dc2626;border:1px solid #fecaca}.alert-success[_ngcontent-%COMP%]{background:#f0fdf4;color:#16a34a;border:1px solid #bbf7d0}.empty-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:4rem 2rem;background:var(--bg-secondary);border-radius:var(--radius-lg);text-align:center}.empty-state[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{color:var(--text-light);margin-bottom:1rem}.empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.125rem;font-weight:600;color:var(--text-primary);margin:0 0 .5rem}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--text-secondary);margin:0}.tickets-table-card[_ngcontent-%COMP%]{background:var(--bg-secondary);border-radius:var(--radius-lg);box-shadow:var(--shadow-sm);overflow:hidden}.table-wrapper[_ngcontent-%COMP%]{overflow-x:auto;-webkit-overflow-scrolling:touch}.tickets-cards[_ngcontent-%COMP%]{display:none;padding:1rem;gap:.75rem}.ticket-card[_ngcontent-%COMP%]{border:1px solid var(--border-color);border-radius:var(--radius-md);background:var(--bg-primary);padding:.875rem;transition:all var(--transition-fast);cursor:pointer}.ticket-card[_ngcontent-%COMP%]:hover{border-color:var(--primary-color)}.ticket-card.has-notification[_ngcontent-%COMP%]{border-left:4px solid #f44336;background:#fff8f8}.ticket-card-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;gap:.5rem;margin-bottom:.625rem}.ticket-card-title[_ngcontent-%COMP%]{font-size:.9375rem;font-weight:600;color:var(--text-primary);margin-bottom:.625rem;line-height:1.35}.ticket-card-meta[_ngcontent-%COMP%]{display:grid;gap:.45rem}.meta-row[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;gap:.75rem}.meta-label[_ngcontent-%COMP%]{color:var(--text-secondary);font-size:.75rem}.meta-value[_ngcontent-%COMP%]{color:var(--text-primary);font-size:.8125rem;font-weight:500;text-align:right}.ticket-card-actions[_ngcontent-%COMP%]{margin-top:.75rem;display:flex;align-items:center;justify-content:flex-end;gap:.5rem}.table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:1rem 1.25rem;text-align:left}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-size:.75rem;font-weight:600;text-transform:uppercase;letter-spacing:.5px;color:var(--text-secondary);background:var(--bg-primary);white-space:nowrap}.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:.875rem;color:var(--text-primary);border-bottom:1px solid var(--border-light);vertical-align:middle}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{transition:background var(--transition-fast);cursor:pointer}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:var(--bg-primary)}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr.has-notification[_ngcontent-%COMP%]{background:#fff3e0;border-left:4px solid #f44336}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr.has-notification[_ngcontent-%COMP%]:hover{background:#ffe0b2}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:last-child   td[_ngcontent-%COMP%]{border-bottom:none}.ticket-id-container[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.ticket-code[_ngcontent-%COMP%]{display:inline-block;background:transparent;color:#0ea5e9;padding:0;border-radius:0;font-size:12px;font-weight:600;white-space:nowrap}.notification-badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:4px;background:#f44336;color:#fff;padding:4px 8px;border-radius:12px;font-size:11px;font-weight:600;white-space:nowrap;animation:_ngcontent-%COMP%_blink 1s infinite;box-shadow:0 0 8px #f44336cc}.notification-badge[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:14px;height:14px;animation:_ngcontent-%COMP%_bellRing .5s ease-in-out 0s infinite}.ticket-title[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.25rem}.ticket-title[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:500}.ticket-title[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{color:var(--text-secondary);font-size:.75rem}.badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;padding:.375rem .75rem;font-size:.75rem;font-weight:500;border-radius:9999px;white-space:nowrap}.badge--open[_ngcontent-%COMP%]{background:#fff7e6;color:#d97706}.badge--in-progress[_ngcontent-%COMP%]{background:var(--primary-light);color:var(--primary-color)}.badge--waiting[_ngcontent-%COMP%]{background:#fef3c7;color:#92400e}.badge--resolved[_ngcontent-%COMP%]{background:#e6f9ed;color:#059669}.badge--closed[_ngcontent-%COMP%]{background:var(--bg-primary);color:var(--text-secondary)}.actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.action-btn[_ngcontent-%COMP%]{width:32px;height:32px;display:flex;align-items:center;justify-content:center;background:var(--bg-primary);border:1px solid var(--border-color);border-radius:var(--radius-md);color:var(--text-secondary);cursor:pointer;transition:all var(--transition-fast)}.action-btn[_ngcontent-%COMP%]:hover{background:var(--primary-light);border-color:var(--primary-color);color:var(--primary-color)}.pagination-controls[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:1rem;padding:1.5rem;border-top:1px solid var(--border-color);background:var(--bg-secondary)}.pagination-input[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.pagination-input[_ngcontent-%COMP%]   .page-input[_ngcontent-%COMP%]{width:60px;padding:.5rem;border:1px solid var(--border-color);border-radius:var(--radius-md);text-align:center;font-size:.875rem;font-weight:500}.pagination-input[_ngcontent-%COMP%]   .page-input[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--primary-color);box-shadow:0 0 0 3px #3b82f61a}.pagination-input[_ngcontent-%COMP%]   .page-info[_ngcontent-%COMP%]{color:var(--text-light);font-size:.875rem}@keyframes _ngcontent-%COMP%_blink{0%,49%{opacity:1}50%,to{opacity:.4}}@keyframes _ngcontent-%COMP%_bellRing{0%{transform:rotate(0)}15%{transform:rotate(15deg)}30%{transform:rotate(-15deg)}45%{transform:rotate(15deg)}60%{transform:rotate(-15deg)}75%{transform:rotate(15deg)}to{transform:rotate(0)}}.release-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:#0f172a73;z-index:1200;padding:1rem}.release-card[_ngcontent-%COMP%]{width:420px;max-width:95%;background:#fff;border-radius:12px;box-shadow:0 20px 50px #0206171f;overflow:hidden;border:1px solid #eef2f7;animation:_ngcontent-%COMP%_popUp .18s ease-out}.release-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:1rem 1.25rem;border-bottom:1px solid #f1f5f9}.release-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:1.125rem;font-weight:600;color:var(--text-primary)}.release-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .modal-close[_ngcontent-%COMP%]{background:transparent;border:none;font-size:24px;line-height:1;cursor:pointer;color:var(--text-light);padding:0}.release-card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .modal-close[_ngcontent-%COMP%]:hover{color:var(--text-primary)}.release-card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{padding:1.25rem;color:var(--text-primary);font-size:.9375rem}.release-card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 .5rem}.release-card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]:last-child{margin-bottom:0}.release-card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:var(--primary-color)}.release-card[_ngcontent-%COMP%]   .card-actions[_ngcontent-%COMP%]{display:flex;gap:.75rem;padding:.75rem 1.25rem 1.25rem;justify-content:flex-end}@keyframes _ngcontent-%COMP%_popUp{0%{transform:translateY(8px) scale(.995);opacity:0}to{transform:translateY(0) scale(1);opacity:1}}@media (max-width: 768px){.filters-row[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch}.search-box[_ngcontent-%COMP%]{min-width:100%}.filter-group[_ngcontent-%COMP%]{flex-wrap:wrap}.table-wrapper[_ngcontent-%COMP%]{display:none}.tickets-cards[_ngcontent-%COMP%]{display:grid}.pagination-controls[_ngcontent-%COMP%]{flex-wrap:wrap}}`]})}}return s})();export{Jt as MyTicketsComponent};
