import './polyfills.server.mjs';
import{a as E,b as z,c as T,d as A,e as F,f as D,g as U,r as V}from"./chunk-7OSF6RCL.mjs";import{a as L}from"./chunk-ZF3RBZZJ.mjs";import"./chunk-TW7WQT2I.mjs";import{g as O,j as k}from"./chunk-JGHH2ILE.mjs";import{Ab as w,Fa as m,Ga as u,Ta as h,Va as C,_a as p,aa as P,db as e,eb as t,fb as a,jb as x,ka as s,kb as v,la as d,oc as S,rb as o,sb as y,wb as M,xb as b,yb as _}from"./chunk-5C2672OW.mjs";import"./chunk-VVCT4QZE.mjs";function G(r,f){if(r&1&&(e(0,"div",22),s(),e(1,"svg",36),a(2,"circle",15)(3,"line",43)(4,"line",44),t(),d(),e(5,"span"),o(6),t()()),r&2){let n=v();m(6),y(n.infoMessage)}}function W(r,f){if(r&1&&(e(0,"div",23),s(),e(1,"svg",36),a(2,"circle",15)(3,"line",45)(4,"line",46),t(),d(),e(5,"span"),o(6),t()()),r&2){let n=v();m(6),y(n.errorMessage)}}function H(r,f){r&1&&(s(),e(0,"svg",36),a(1,"path",47)(2,"line",48),t())}function j(r,f){r&1&&(s(),e(0,"svg",36),a(1,"path",49)(2,"circle",50),t())}function I(r,f){r&1&&(a(0,"span",51),e(1,"span"),o(2,"Giri\u015F yap\u0131l\u0131yor..."),t())}function N(r,f){r&1&&(e(0,"span"),o(1,"Giri\u015F Yap"),t(),s(),e(2,"svg",36),a(3,"line",52)(4,"polyline",53),t())}var J=(()=>{class r{constructor(n,g,i){this.authService=n,this.router=g,this.route=i,this.staffLoginData={email:"",password:""},this.isLoading=!1,this.errorMessage="",this.infoMessage="",this.showPassword=!1,this.rememberMe=!1,this.returnUrl="/staff/dashboard",this.failedAttempts=0,this.lockoutUntil=null,this.MAX_ATTEMPTS=5,this.LOCKOUT_DURATION_MS=6e4,this.allowedRoutes=["/staff/dashboard","/staff","/admin/dashboard","/admin"];let c=this.route.snapshot.queryParams.returnUrl;this.returnUrl=this.sanitizeReturnUrl(c)}ngOnInit(){let n=this.route.snapshot.queryParams;n.expired==="true"?this.infoMessage="Oturumunuz sona erdi. L\xFCtfen tekrar giri\u015F yap\u0131n.":n.unauthorized==="true"&&(this.infoMessage="Yetkilendirme hatas\u0131. L\xFCtfen tekrar giri\u015F yap\u0131n.")}isLockedOut(){if(this.lockoutUntil&&new Date<this.lockoutUntil){let n=Math.ceil((this.lockoutUntil.getTime()-new Date().getTime())/1e3);return this.errorMessage=`\xC7ok fazla ba\u015Far\u0131s\u0131z deneme. ${n} saniye sonra tekrar deneyin.`,!0}return this.lockoutUntil&&new Date>=this.lockoutUntil&&(this.failedAttempts=0,this.lockoutUntil=null),!1}handleFailedLogin(){this.failedAttempts++,this.failedAttempts>=this.MAX_ATTEMPTS&&(this.lockoutUntil=new Date(Date.now()+this.LOCKOUT_DURATION_MS),this.errorMessage="\xC7ok fazla ba\u015Far\u0131s\u0131z deneme. 60 saniye sonra tekrar deneyin.")}resetFailedAttempts(){this.failedAttempts=0,this.lockoutUntil=null}sanitizeReturnUrl(n){return!n||!n.startsWith("/")||n.startsWith("//")||n.includes(":")?"/staff/dashboard":this.allowedRoutes.some(i=>n.startsWith(i))?n:"/staff/dashboard"}onSubmit(){if(!this.isLockedOut()){if(!this.staffLoginData.email||!this.staffLoginData.password){this.errorMessage="L\xFCtfen t\xFCm alanlar\u0131 doldurunuz.";return}this.isLoading=!0,this.errorMessage="",this.authService.staffLogin(this.staffLoginData,this.rememberMe).subscribe({next:()=>{this.isLoading=!1,this.resetFailedAttempts();let n=this.authService.getCurrentUser();n?.role==="Admin"?this.router.navigate(["/admin/dashboard"]):n?.role==="Staff"?this.router.navigate(["/staff/dashboard"]):(this.errorMessage="Ge\xE7ersiz kullan\u0131c\u0131 rol\xFC",this.authService.logout())},error:n=>{this.isLoading=!1,this.handleFailedLogin(),this.lockoutUntil||(this.errorMessage=n.error?.message||"Giri\u015F bilgileri hatal\u0131!")}})}}togglePasswordVisibility(){this.showPassword=!this.showPassword}goToCustomerLogin(){this.router.navigate(["/login"])}static{this.\u0275fac=function(g){return new(g||r)(u(L),u(k),u(O))}}static{this.\u0275cmp=P({type:r,selectors:[["app-staff-login"]],standalone:!0,features:[w],decls:82,vars:9,consts:[[1,"login-page"],[1,"login-branding"],[1,"branding-content"],[1,"logo"],["src","assets/images/KobiLogo.png","alt","Kobi M\xFChendislik",1,"logo-img"],[1,"branding-title"],[1,"branding-subtitle"],[1,"features"],[1,"feature-item"],[1,"feature-icon"],["width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2"],["d","M22 11.08V12a10 10 0 1 1-5.93-9.14"],["points","22 4 12 14.01 9 11.01"],[1,"feature-text"],["d","M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"],["cx","12","cy","12","r","10"],["points","12 6 12 12 16 14"],[1,"branding-footer"],[1,"login-form-container"],[1,"login-form-wrapper"],[1,"login-header"],[1,"login-form",3,"ngSubmit"],[1,"alert","alert-info"],[1,"alert","alert-error"],[1,"form-group"],["for","staffEmail"],[1,"input-wrapper"],["width","20","height","20","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2",1,"input-icon"],["d","M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"],["points","22,6 12,13 2,6"],["type","email","id","staffEmail","name","staffEmail","placeholder","personel@example.com","autocomplete","email",1,"form-control",3,"ngModelChange","ngModel"],["for","staffPassword"],["x","3","y","11","width","18","height","11","rx","2","ry","2"],["d","M7 11V7a5 5 0 0 1 10 0v4"],["id","staffPassword","name","staffPassword","placeholder","\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022","autocomplete","current-password",1,"form-control",3,"ngModelChange","type","ngModel"],["type","button",1,"password-toggle",3,"click"],["width","20","height","20","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2"],[1,"form-options"],[1,"checkbox-wrapper"],["type","checkbox","name","rememberMe",3,"ngModelChange","ngModel"],[1,"checkmark"],["href","#",1,"forgot-link"],["type","submit",1,"btn","btn-primary","btn-login",3,"disabled"],["x1","12","y1","16","x2","12","y2","12"],["x1","12","y1","8","x2","12.01","y2","8"],["x1","15","y1","9","x2","9","y2","15"],["x1","9","y1","9","x2","15","y2","15"],["d","M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"],["x1","1","y1","1","x2","23","y2","23"],["d","M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"],["cx","12","cy","12","r","3"],[1,"spinner"],["x1","5","y1","12","x2","19","y2","12"],["points","12 5 19 12 12 19"]],template:function(g,i){g&1&&(e(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),a(4,"img",4),t(),e(5,"h1",5),o(6,"Ticket Y\xF6netim Sistemi"),t(),e(7,"p",6),o(8," Destek taleplerinizi kolayca olu\u015Fturun, takip edin ve y\xF6netin. H\u0131zl\u0131 ve etkili \xE7\xF6z\xFCmler i\xE7in buraday\u0131z. "),t(),e(9,"div",7)(10,"div",8)(11,"div",9),s(),e(12,"svg",10),a(13,"path",11)(14,"polyline",12),t()(),d(),e(15,"div",13)(16,"h3"),o(17,"H\u0131zl\u0131 Destek"),t(),e(18,"p"),o(19,"Talepleri verimli bir \u015Fekilde y\xF6netin"),t()()(),e(20,"div",8)(21,"div",9),s(),e(22,"svg",10),a(23,"path",14),t()(),d(),e(24,"div",13)(25,"h3"),o(26,"G\xFCvenli Sistem"),t(),e(27,"p"),o(28,"Verileriniz g\xFCvende"),t()()(),e(29,"div",8)(30,"div",9),s(),e(31,"svg",10),a(32,"circle",15)(33,"polyline",16),t()(),d(),e(34,"div",13)(35,"h3"),o(36,"Anl\u0131k Takip"),t(),e(37,"p"),o(38,"Sistem performans\u0131n\u0131 ger\xE7ek zamanl\u0131 izleyin"),t()()()()(),e(39,"div",17)(40,"p"),o(41,"\xA9 2026 Kobi M\xFChendislik. T\xFCm haklar\u0131 sakl\u0131d\u0131r."),t()()(),e(42,"div",18)(43,"div",19)(44,"div",20)(45,"h2"),o(46,"Personel Giri\u015Fi"),t(),e(47,"p"),o(48,"Destek Ekibi Hesab\u0131na Giri\u015F Yap\u0131n"),t()(),e(49,"form",21),x("ngSubmit",function(){return i.onSubmit()}),h(50,G,7,1,"div",22)(51,W,7,1,"div",23),e(52,"div",24)(53,"label",25),o(54,"E-posta Adresi"),t(),e(55,"div",26),s(),e(56,"svg",27),a(57,"path",28)(58,"polyline",29),t(),d(),e(59,"input",30),_("ngModelChange",function(l){return b(i.staffLoginData.email,l)||(i.staffLoginData.email=l),l}),t()()(),e(60,"div",24)(61,"label",31),o(62,"\u015Eifre"),t(),e(63,"div",26),s(),e(64,"svg",27),a(65,"rect",32)(66,"path",33),t(),d(),e(67,"input",34),_("ngModelChange",function(l){return b(i.staffLoginData.password,l)||(i.staffLoginData.password=l),l}),t(),e(68,"button",35),x("click",function(){return i.togglePasswordVisibility()}),h(69,H,3,0,":svg:svg",36)(70,j,3,0),t()()(),e(71,"div",37)(72,"label",38)(73,"input",39),_("ngModelChange",function(l){return b(i.rememberMe,l)||(i.rememberMe=l),l}),t(),a(74,"span",40),e(75,"span"),o(76,"Beni hat\u0131rla"),t()(),e(77,"a",41),o(78,"\u015Eifremi unuttum?"),t()(),e(79,"button",42),h(80,I,3,0)(81,N,5,0),t()()()()()),g&2&&(m(50),p(50,i.infoMessage?50:-1),m(),p(51,i.errorMessage?51:-1),m(8),M("ngModel",i.staffLoginData.email),m(8),C("type",i.showPassword?"text":"password"),M("ngModel",i.staffLoginData.password),m(2),p(69,i.showPassword?69:70),m(4),M("ngModel",i.rememberMe),m(6),C("disabled",i.isLoading),m(),p(80,i.isLoading?80:81))},dependencies:[S,V,U,z,E,T,A,D,F],styles:['.login-page[_ngcontent-%COMP%]{display:flex;min-height:100vh}@media (max-width: 768px){.login-page[_ngcontent-%COMP%]{flex-direction:column}}.login-branding[_ngcontent-%COMP%]{flex:1;background:linear-gradient(135deg,#06c,#049);color:#fff;padding:3rem;display:flex;flex-direction:column;justify-content:space-between;position:relative;overflow:hidden}.login-branding[_ngcontent-%COMP%]:before{content:"";position:absolute;top:-50%;right:-50%;width:100%;height:100%;background:radial-gradient(circle,rgba(255,255,255,.1) 0%,transparent 70%);pointer-events:none}.login-branding[_ngcontent-%COMP%]:after{content:"";position:absolute;bottom:-30%;left:-30%;width:60%;height:60%;background:radial-gradient(circle,rgba(255,255,255,.05) 0%,transparent 70%);pointer-events:none}@media (max-width: 768px){.login-branding[_ngcontent-%COMP%]{padding:2rem;min-height:auto}}.branding-content[_ngcontent-%COMP%]{position:relative;z-index:1}.logo[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;margin-bottom:3rem}.logo[_ngcontent-%COMP%]   .logo-img[_ngcontent-%COMP%]{width:280px;height:auto;object-fit:contain}.branding-title[_ngcontent-%COMP%]{font-size:2.5rem;font-weight:700;margin-bottom:1rem;line-height:1.2}@media (max-width: 768px){.branding-title[_ngcontent-%COMP%]{font-size:1.75rem}}.branding-subtitle[_ngcontent-%COMP%]{font-size:1.1rem;opacity:.9;line-height:1.7;max-width:450px;margin-bottom:3rem}@media (max-width: 768px){.branding-subtitle[_ngcontent-%COMP%]{font-size:1rem;margin-bottom:2rem}}.features[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.5rem}@media (max-width: 768px){.features[_ngcontent-%COMP%]{display:none}}.feature-item[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:1rem;padding:1rem;background:#ffffff1a;border-radius:var(--radius-lg);-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);transition:transform var(--transition-normal),background var(--transition-normal)}.feature-item[_ngcontent-%COMP%]:hover{transform:translate(10px);background:#ffffff26}.feature-item[_ngcontent-%COMP%]   .feature-icon[_ngcontent-%COMP%]{width:48px;height:48px;display:flex;align-items:center;justify-content:center;background:#fff3;border-radius:var(--radius-md);flex-shrink:0}.feature-item[_ngcontent-%COMP%]   .feature-text[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1rem;font-weight:600;margin-bottom:.25rem}.feature-item[_ngcontent-%COMP%]   .feature-text[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.875rem;opacity:.8;margin:0}.branding-footer[_ngcontent-%COMP%]{position:relative;z-index:1}.branding-footer[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.875rem;opacity:.7;margin:0}@media (max-width: 768px){.branding-footer[_ngcontent-%COMP%]{display:none}}.login-form-container[_ngcontent-%COMP%]{flex:1;display:flex;align-items:center;justify-content:center;padding:3rem;background:var(--bg-primary)}@media (max-width: 768px){.login-form-container[_ngcontent-%COMP%]{padding:2rem}}.login-form-wrapper[_ngcontent-%COMP%]{width:100%;max-width:420px}.login-header[_ngcontent-%COMP%]{text-align:center;margin-bottom:2rem}.login-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.75rem;font-weight:700;color:var(--text-primary);margin-bottom:.5rem}.login-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--text-secondary);margin:0}.login-form[_ngcontent-%COMP%]{background:var(--bg-secondary);padding:2rem;border-radius:var(--radius-xl);box-shadow:var(--shadow-md)}.alert[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;padding:1rem;border-radius:var(--radius-md);margin-bottom:1.5rem;font-size:.875rem}.alert-error[_ngcontent-%COMP%]{background:#fef2f2;color:#dc2626;border:1px solid #fecaca}.alert-info[_ngcontent-%COMP%]{background:#eff6ff;color:#1d4ed8;border:1px solid #bfdbfe}.form-group[_ngcontent-%COMP%]{margin-bottom:1.5rem}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;font-size:.875rem;font-weight:500;color:var(--text-primary);margin-bottom:.5rem}.input-wrapper[_ngcontent-%COMP%]{position:relative}.input-wrapper[_ngcontent-%COMP%]   .input-icon[_ngcontent-%COMP%]{position:absolute;left:1rem;top:50%;transform:translateY(-50%);color:var(--text-light);pointer-events:none}.input-wrapper[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{padding-left:3rem;padding-right:3rem;height:48px}.input-wrapper[_ngcontent-%COMP%]   .password-toggle[_ngcontent-%COMP%]{position:absolute;right:1rem;top:50%;transform:translateY(-50%);background:none;border:none;color:var(--text-light);cursor:pointer;padding:0;display:flex;align-items:center;justify-content:center;transition:color var(--transition-fast)}.input-wrapper[_ngcontent-%COMP%]   .password-toggle[_ngcontent-%COMP%]:hover{color:var(--text-primary)}.form-options[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;margin-bottom:1.5rem}.form-options[_ngcontent-%COMP%]   .checkbox-wrapper[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;font-size:.875rem;color:var(--text-secondary);cursor:pointer}.form-options[_ngcontent-%COMP%]   .checkbox-wrapper[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:18px;height:18px;accent-color:var(--primary-color)}.form-options[_ngcontent-%COMP%]   .forgot-link[_ngcontent-%COMP%]{font-size:.875rem;color:var(--primary-color)}.form-options[_ngcontent-%COMP%]   .forgot-link[_ngcontent-%COMP%]:hover{text-decoration:underline}.btn-login[_ngcontent-%COMP%]{width:100%;height:48px;font-size:1rem;font-weight:600}.spinner[_ngcontent-%COMP%]{width:20px;height:20px;border:2px solid rgba(255,255,255,.3);border-top-color:#fff;border-radius:50%;animation:_ngcontent-%COMP%_spin .8s linear infinite}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.login-footer[_ngcontent-%COMP%]{text-align:center;margin-top:2rem}.login-footer[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--text-secondary);font-size:.875rem;margin:0}.login-footer[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--primary-color);font-weight:500;cursor:pointer}.login-footer[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{text-decoration:underline}']})}}return r})();export{J as StaffLoginComponent};
