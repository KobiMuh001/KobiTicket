import './polyfills.server.mjs';
import{a as I}from"./chunk-PQXIZOTO.mjs";import"./chunk-YJ3U2WBC.mjs";import{k as D,n as L}from"./chunk-4L5IZ2U2.mjs";import{Ma as b,Oa as M,Ra as y,Ta as _,V as P,Wa as w,Xa as S,Ya as t,Za as n,_a as g,ba as C,bb as v,ca as h,cb as k,da as p,db as s,dc as z,ea as u,ib as o,jb as d,kb as m,rb as E,tb as F,ya as r,za as T}from"./chunk-M6NPGADT.mjs";import"./chunk-VVCT4QZE.mjs";var V=(i,l)=>l.id,A=i=>["/staff/tickets",i];function N(i,l){if(i&1){let e=v();t(0,"div",4),o(1),t(2,"button",22),k("click",function(){C(e);let c=s();return h(c.error=null)}),o(3,"\xD7"),n()()}if(i&2){let e=s();r(),m(" ",e.error," ")}}function $(i,l){if(i&1&&(t(0,"div",5),o(1),n()),i&2){let e=s();r(),m(" ",e.successMessage," ")}}function G(i,l){i&1&&(t(0,"div",21),o(1,"Y\xFCkleniyor..."),n())}function H(i,l){i&1&&(t(0,"div",23),p(),t(1,"svg",24),g(2,"path",25)(3,"polyline",26),n(),u(),t(4,"p"),o(5,"T\xFCm ticketlar atanm\u0131\u015F! \u{1F389}"),n()())}function Y(i,l){if(i&1&&(t(0,"div",37),p(),t(1,"svg",38),g(2,"rect",47)(3,"path",48),n(),u(),t(4,"span"),o(5),n()()),i&2){let e=s().$implicit;r(5),d(e.assetName)}}function j(i,l){if(i&1){let e=v();t(0,"div",29)(1,"div",30)(2,"span",31),o(3),n(),t(4,"span",32),o(5),n()(),t(6,"h3",33)(7,"span",34),o(8),n(),o(9),n(),t(10,"p",35),o(11),n(),t(12,"div",36)(13,"div",37),p(),t(14,"svg",38),g(15,"path",39)(16,"circle",40),n(),u(),t(17,"span"),o(18),n()(),b(19,Y,6,1,"div",37),n(),t(20,"div",41)(21,"span",42),o(22),n(),t(23,"div",43)(24,"a",44),o(25," Detay "),n(),t(26,"button",45),k("click",function(){let c=C(e).$implicit,f=s(2);return h(f.claimTicket(c.id))}),p(),t(27,"svg",16),g(28,"path",46),n(),o(29," \xDCstlen "),n()()()()}if(i&2){let e=l.$implicit,a=s(2);y("priority-border-"+a.getPriorityClass(e.priority)),r(2),y(a.getPriorityClass(e.priority)),r(),m(" ",a.getPriorityText(e.priority)," "),r(2),d(a.getTimeAgo(e.createdDate)),r(3),d(e.ticketCode||"#"+e.id),r(),m(" ",e.title," "),r(2),d(e.description),r(7),d(e.companyName||"Bilinmiyor"),r(),_(19,e.assetName?19:-1),r(3),d(a.formatDate(e.createdDate)),r(2),M("routerLink",F(13,A,e.id))}}function B(i,l){if(i&1&&(t(0,"div",27),w(1,j,30,15,"div",28,V),n()),i&2){let e=s();r(),S(e.filteredTickets)}}var Q=(()=>{class i{constructor(e){this.staffService=e,this.tickets=[],this.filteredTickets=[],this.isLoading=!0,this.error=null,this.successMessage=null,this.selectedPriority="all"}ngOnInit(){this.loadTickets()}loadTickets(){this.isLoading=!0,this.staffService.getUnassignedTickets().subscribe({next:e=>{e.success&&(this.tickets=e.data,this.applyFilters()),this.isLoading=!1},error:e=>{this.error="Ticketlar y\xFCklenirken hata olu\u015Ftu",this.isLoading=!1}})}applyFilters(){this.filteredTickets=this.tickets.filter(e=>this.selectedPriority==="all"||e.priority.toString()===this.selectedPriority)}onPriorityFilterChange(e){this.selectedPriority=e.target.value,this.applyFilters()}claimTicket(e){this.staffService.claimTicket(e).subscribe({next:a=>{a.success&&(this.successMessage="Ticket ba\u015Far\u0131yla al\u0131nd\u0131",this.loadTickets(),setTimeout(()=>this.successMessage=null,3e3))},error:a=>{this.error=a.error?.message||"Ticket al\u0131n\u0131rken hata olu\u015Ftu"}})}getPriorityText(e){switch(e){case 1:return"D\xFC\u015F\xFCk";case 2:return"Normal";case 3:return"Y\xFCksek";case 4:return"Kritik";default:return"Normal"}}getPriorityClass(e){switch(e){case 1:return"priority-low";case 2:return"priority-normal";case 3:return"priority-high";case 4:return"priority-critical";default:return"priority-normal"}}formatDate(e){return new Date(e).toLocaleDateString("tr-TR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}getTimeAgo(e){let a=new Date(e),f=new Date().getTime()-a.getTime(),x=Math.floor(f/(1e3*60*60)),O=Math.floor(x/24);return O>0?`${O} g\xFCn \xF6nce`:x>0?`${x} saat \xF6nce`:"Az \xF6nce"}static{this.\u0275fac=function(a){return new(a||i)(T(I))}}static{this.\u0275cmp=P({type:i,selectors:[["app-open-tickets"]],standalone:!0,features:[E],decls:36,vars:5,consts:[[1,"open-tickets-page"],[1,"page-header"],[1,"header-left"],[1,"subtitle"],[1,"alert","alert-error"],[1,"alert","alert-success"],[1,"filters-bar"],[1,"filter-group"],[3,"change","value"],["value","all"],["value","4"],["value","3"],["value","2"],["value","1"],[1,"results-count"],[1,"refresh-btn",3,"click"],["width","16","height","16","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2"],["points","23 4 23 10 17 10"],["points","1 20 1 14 7 14"],["d","M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"],[1,"tickets-container"],[1,"loading"],[1,"close-btn",3,"click"],[1,"empty-state"],["width","64","height","64","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","1.5"],["d","M22 11.08V12a10 10 0 1 1-5.93-9.14"],["points","22 4 12 14.01 9 11.01"],[1,"tickets-grid"],[1,"ticket-card",3,"class"],[1,"ticket-card"],[1,"ticket-header"],[1,"priority-badge"],[1,"time-ago"],[1,"ticket-title"],[1,"ticket-code"],[1,"ticket-description"],[1,"ticket-meta"],[1,"meta-item"],["width","14","height","14","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2"],["d","M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"],["cx","12","cy","7","r","4"],[1,"ticket-footer"],[1,"created-date"],[1,"footer-actions"],[1,"detail-btn",3,"routerLink"],[1,"claim-btn",3,"click"],["d","M12 5v14M5 12h14"],["x","2","y","7","width","20","height","14","rx","2","ry","2"],["d","M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"]],template:function(a,c){a&1&&(t(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1"),o(4,"A\xE7\u0131k Ticketlar"),n(),t(5,"p",3),o(6,"Atanmam\u0131\u015F ve bekleyen ticketlar"),n()()(),b(7,N,4,1,"div",4)(8,$,2,1,"div",5),t(9,"div",6)(10,"div",7)(11,"label"),o(12,"\xD6ncelik:"),n(),t(13,"select",8),k("change",function(x){return c.onPriorityFilterChange(x)}),t(14,"option",9),o(15,"T\xFCm\xFC"),n(),t(16,"option",10),o(17,"Kritik"),n(),t(18,"option",11),o(19,"Y\xFCksek"),n(),t(20,"option",12),o(21,"Normal"),n(),t(22,"option",13),o(23,"D\xFC\u015F\xFCk"),n()()(),t(24,"div",14),o(25),n(),t(26,"button",15),k("click",function(){return c.loadTickets()}),p(),t(27,"svg",16),g(28,"polyline",17)(29,"polyline",18)(30,"path",19),n(),o(31," Yenile "),n()(),u(),t(32,"div",20),b(33,G,2,0,"div",21)(34,H,6,0)(35,B,3,0),n()()),a&2&&(r(7),_(7,c.error?7:-1),r(),_(8,c.successMessage?8:-1),r(5),M("value",c.selectedPriority),r(12),m(" ",c.filteredTickets.length," a\xE7\u0131k ticket "),r(8),_(33,c.isLoading?33:c.filteredTickets.length===0?34:35))},dependencies:[z,L,D],styles:[".open-tickets-page[_ngcontent-%COMP%]{padding:0}.page-header[_ngcontent-%COMP%]{margin-bottom:24px}.page-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:28px;font-weight:600;color:#1e293b;margin:0 0 8px}.page-header[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{color:#64748b;font-size:15px;margin:0}.alert[_ngcontent-%COMP%]{padding:12px 16px;border-radius:8px;margin-bottom:20px;display:flex;align-items:center;justify-content:space-between}.alert.alert-error[_ngcontent-%COMP%]{background:#fef2f2;color:#dc2626;border:1px solid #fecaca}.alert.alert-success[_ngcontent-%COMP%]{background:#f0fdf4;color:#16a34a;border:1px solid #bbf7d0}.alert[_ngcontent-%COMP%]   .close-btn[_ngcontent-%COMP%]{background:none;border:none;font-size:20px;cursor:pointer;color:inherit}.filters-bar[_ngcontent-%COMP%]{display:flex;align-items:center;gap:20px;margin-bottom:20px;padding:16px 20px;background:#fff;border-radius:12px;box-shadow:0 1px 3px #0000001a}.filter-group[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.filter-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:14px;color:#64748b;font-weight:500}.filter-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{padding:8px 12px;border:1px solid #e2e8f0;border-radius:8px;font-size:14px;color:#1e293b;background:#fff;cursor:pointer}.filter-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none;border-color:#059669}.results-count[_ngcontent-%COMP%]{margin-left:auto;font-size:14px;color:#64748b}.refresh-btn[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;padding:8px 16px;background:#f1f5f9;border:none;border-radius:8px;font-size:14px;color:#475569;cursor:pointer;transition:all .2s}.refresh-btn[_ngcontent-%COMP%]:hover{background:#e2e8f0}.tickets-container[_ngcontent-%COMP%]{min-height:400px}.loading[_ngcontent-%COMP%], .empty-state[_ngcontent-%COMP%]{padding:80px 20px;text-align:center;color:#64748b;background:#fff;border-radius:12px;box-shadow:0 1px 3px #0000001a}.loading[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%], .empty-state[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{margin-bottom:16px;opacity:.5}.loading[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:16px}.tickets-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(350px,1fr));gap:20px}.ticket-card[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:20px;box-shadow:0 1px 3px #0000001a;border-left:4px solid #e2e8f0;transition:all .2s}.ticket-card[_ngcontent-%COMP%]:hover{box-shadow:0 4px 12px #0000001a;transform:translateY(-2px)}.ticket-card.priority-border-priority-critical[_ngcontent-%COMP%]{border-left-color:#ef4444}.ticket-card.priority-border-priority-high[_ngcontent-%COMP%]{border-left-color:#f59e0b}.ticket-card.priority-border-priority-normal[_ngcontent-%COMP%]{border-left-color:#3b82f6}.ticket-card.priority-border-priority-low[_ngcontent-%COMP%]{border-left-color:#94a3b8}.ticket-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;margin-bottom:12px}.priority-badge[_ngcontent-%COMP%]{font-size:11px;font-weight:600;padding:4px 10px;border-radius:6px}.priority-low[_ngcontent-%COMP%]{background:#f1f5f9;color:#64748b}.priority-normal[_ngcontent-%COMP%]{background:#dbeafe;color:#1e40af}.priority-high[_ngcontent-%COMP%]{background:#fef3c7;color:#92400e}.priority-critical[_ngcontent-%COMP%]{background:#fee2e2;color:#991b1b}.time-ago[_ngcontent-%COMP%]{font-size:12px;color:#94a3b8}.ticket-title[_ngcontent-%COMP%]{font-size:16px;font-weight:600;color:#1e293b;margin:0 0 8px;line-height:1.4;display:flex;align-items:center;gap:8px}.ticket-title[_ngcontent-%COMP%]   .ticket-code[_ngcontent-%COMP%]{display:inline-block;background:transparent;color:#0ea5e9;padding:0;border-radius:0;font-size:11px;font-weight:600;white-space:nowrap;flex-shrink:0}.ticket-description[_ngcontent-%COMP%]{font-size:14px;color:#64748b;margin:0 0 16px;line-height:1.5;display:-webkit-box;-webkit-line-clamp:2;line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}.ticket-meta[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:12px;margin-bottom:16px;padding-bottom:16px;border-bottom:1px solid #f1f5f9}.meta-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;font-size:13px;color:#64748b}.meta-item[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{opacity:.7}.ticket-footer[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between}.footer-actions[_ngcontent-%COMP%]{display:flex;gap:8px;align-items:center}.created-date[_ngcontent-%COMP%]{font-size:12px;color:#94a3b8}.detail-btn[_ngcontent-%COMP%]{padding:8px 14px;background:#f1f5f9;color:#475569;border:1px solid #e2e8f0;border-radius:8px;font-size:13px;font-weight:500;text-decoration:none;cursor:pointer;transition:all .2s}.detail-btn[_ngcontent-%COMP%]:hover{background:#e2e8f0;color:#1e293b}.claim-btn[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;padding:8px 16px;background:#059669;color:#fff;border:none;border-radius:8px;font-size:14px;font-weight:500;cursor:pointer;transition:all .2s}.claim-btn[_ngcontent-%COMP%]:hover{background:#047857}@media (max-width: 768px){.tickets-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.filters-bar[_ngcontent-%COMP%]{flex-wrap:wrap}.results-count[_ngcontent-%COMP%]{width:100%;margin-left:0;margin-top:10px}}"]})}}return i})();export{Q as OpenTicketsComponent};
