import{a as et}from"./chunk-73L5S5JL.js";import{a as tt}from"./chunk-CS7TGZKS.js";import{b as J,c as $,f as X,r as Z}from"./chunk-ZUNVM5YC.js";import{c as W,e as K,i as Q}from"./chunk-SYWROKNQ.js";import{$a as P,La as f,Na as l,Ob as A,Pa as k,Qb as L,Rb as H,Sa as z,Sb as G,Ub as U,Wb as Y,Xa as n,Ya as i,Z as D,Za as b,_a as M,a as T,ab as x,b as S,bb as g,cb as s,d as I,dc as q,eb as F,fa as m,fb as R,ga as p,gb as j,ha as E,hb as c,ib as _,jb as v,mb as y,nb as O,ob as w,qb as N,sa as V,sb as B,ua as h,ya as r,za as C}from"./chunk-CSHUE4LK.js";var ot=["commentsContainer"],rt=e=>({"admin-bubble":e});function at(e,d){e&1&&(n(0,"div",10),b(1,"div",11),n(2,"p"),c(3,"Ticket y\xFCkleniyor..."),i()())}function ct(e,d){if(e&1){let t=x();n(0,"div",12),c(1),n(2,"button",13),g("click",function(){m(t);let o=s();return p(o.error=null)}),c(3,"\xD7"),i()()}if(e&2){let t=s();r(),v(" ",t.error," ")}}function st(e,d){if(e&1){let t=x();n(0,"div",14),c(1),n(2,"button",13),g("click",function(){m(t);let o=s();return p(o.successMessage=null)}),c(3,"\xD7"),i()()}if(e&2){let t=s();r(),v(" ",t.successMessage," ")}}function lt(e,d){if(e&1){let t=x();M(0),n(1,"button",35),g("click",function(){m(t);let o=s(2);return p(o.claimTicket())}),c(2," Ticket\u0131 \xDCstlen "),i(),P()}}function dt(e,d){if(e&1){let t=x();n(0,"button",35),g("click",function(){m(t);let o=s(3);return p(o.updateStatus(2))}),c(1," \u0130\u015Fleme Al "),i()}}function mt(e,d){if(e&1){let t=x();n(0,"button",39),g("click",function(){m(t);let o=s(3);return p(o.updateStatus(3))}),c(1," M\xFC\u015Fteri Bekliyor "),i()}}function pt(e,d){if(e&1){let t=x();n(0,"button",35),g("click",function(){m(t);let o=s(3);return p(o.updateStatus(2))}),c(1," \u0130\u015Fleme Al "),i()}}function gt(e,d){if(e&1){let t=x();n(0,"button",40),g("click",function(){m(t);let o=s(3);return p(o.showResolveModal=!0)}),c(1," \xC7\xF6z\xFCld\xFC Olarak \u0130\u015Faretle "),i()}}function _t(e,d){if(e&1){let t=x();M(0),f(1,dt,2,0,"button",36)(2,mt,2,0,"button",37)(3,pt,2,0,"button",36)(4,gt,2,0,"button",38),n(5,"button",39),g("click",function(){m(t);let o=s(2);return p(o.releaseTicket())}),c(6," Ticket\u0131 B\u0131rak "),i(),P()}if(e&2){let t=s(2);r(),l("ngIf",t.ticket.status===1),r(),l("ngIf",t.ticket.status===2),r(),l("ngIf",t.ticket.status===3),r(),l("ngIf",t.ticket.status===2||t.ticket.status===3)}}function ut(e,d){if(e&1&&(n(0,"span",41),c(1),i()),e&2){let t=s(2);r(),v(" Atanan: ",t.ticket.assignedPerson," ")}}function ft(e,d){if(e&1&&(n(0,"div",27)(1,"label"),c(2,"\xC7\xF6z\xFClme Tarihi:"),i(),n(3,"span"),c(4),i()()),e&2){let t=s(2);r(4),_(t.formatDate(t.ticket.resolvedDate))}}function xt(e,d){if(e&1&&(n(0,"div",27)(1,"label"),c(2,"A\xE7\u0131klama:"),i(),n(3,"span"),c(4),i()()),e&2){let t=s(3);r(4),_(t.ticket.asset.description)}}function Ct(e,d){if(e&1&&(n(0,"div",26)(1,"h3"),c(2,"Se\xE7ilen \xDCr\xFCn"),i(),n(3,"div",27)(4,"label"),c(5,"\xDCr\xFCn Ad\u0131:"),i(),n(6,"span"),c(7),i()(),f(8,xt,5,1,"div",27),i()),e&2){let t=s(2);r(7),_(t.ticket.asset.productName),r(),z(8,t.ticket.asset.description?8:-1)}}function vt(e,d){if(e&1){let t=x();n(0,"button",44),g("click",function(){let o=m(t).$implicit,u=s(3);return p(u.openImagePreview(o))}),b(1,"img",45),n(2,"div",46)(3,"span"),c(4,"B\xFCy\xFCtmek i\xE7in t\u0131kla"),i()()()}if(e&2){let t=d.$implicit,a=s(3);r(),l("src",a.baseUrl+"/"+t,h)("alt",a.ticket.title)}}function bt(e,d){if(e&1&&(n(0,"div",26)(1,"h3"),c(2,"Eklenen Gorseller"),i(),n(3,"div",42),f(4,vt,5,2,"button",43),i()()),e&2){let t=s(2);r(4),l("ngForOf",t.ticket.imagePaths)}}function ht(e,d){if(e&1&&(n(0,"div",26)(1,"h3"),c(2,"\xC7\xF6z\xFCm Notu"),i(),n(3,"p",47),c(4),i()()),e&2){let t=s(2);r(4),_(t.ticket.solutionNote)}}function kt(e,d){e&1&&(n(0,"div",53),c(1," Hen\xFCz mesaj yok "),i())}function Mt(e,d){e&1&&(n(0,"span",61),c(1,"DESTEK"),i())}function Pt(e,d){if(e&1&&(n(0,"div",54)(1,"div",55)(2,"div",56)(3,"span",57),c(4),i(),f(5,Mt,2,0,"span",58),n(6,"span",59),c(7),i()(),n(8,"p",60),c(9),i()()()),e&2){let t=d.$implicit,a=s(3);l("ngClass",a.isMyComment(t)?"my-message-row":"other-message-row"),r(),l("ngClass",B(6,rt,t.isAdminReply)),r(3),_(t.authorName),r(),l("ngIf",t.isAdminReply),r(2),_(a.formatTime(t.createdDate)),r(2),_(t.message)}}function yt(e,d){if(e&1){let t=x();n(0,"div",62)(1,"div",63)(2,"textarea",64),w("ngModelChange",function(o){m(t);let u=s(3);return O(u.newComment,o)||(u.newComment=o),p(o)}),i(),n(3,"button",65),g("click",function(){m(t);let o=s(3);return p(o.addComment())}),E(),n(4,"svg",66),b(5,"line",67)(6,"polygon",68),i()()()()}if(e&2){let t=s(3);r(2),y("ngModel",t.newComment),r(),l("disabled",!t.newComment.trim())}}function Ot(e,d){if(e&1&&(n(0,"div",48)(1,"div",49,0),f(3,kt,2,0,"div",50)(4,Pt,10,8,"div",51),i(),f(5,yt,7,2,"div",52),i()),e&2){let t=s(2);r(3),l("ngIf",t.comments.length===0),r(),l("ngForOf",t.comments),r(),l("ngIf",t.isMyTicket&&t.ticket.status!==4&&t.ticket.status!==5)}}function wt(e,d){e&1&&(n(0,"div",53),c(1," Hen\xFCz ge\xE7mi\u015F yok "),i())}function Tt(e,d){e&1&&(n(0,"span"),c(1,"\u{1F504}"),i())}function St(e,d){e&1&&(n(0,"span"),c(1,"\u{1F464}"),i())}function It(e,d){e&1&&(n(0,"span"),c(1,"\u2795"),i())}function Dt(e,d){e&1&&(n(0,"span"),c(1,"\u2705"),i())}function Et(e,d){if(e&1&&(n(0,"div",71)(1,"div",72),f(2,Tt,2,0,"span",22)(3,St,2,0,"span",22)(4,It,2,0,"span",22)(5,Dt,2,0,"span",22),i(),n(6,"div",73)(7,"p"),c(8),i(),n(9,"span",74),c(10),i()()()),e&2){let t=d.$implicit,a=s(3);r(2),l("ngIf",t.action==="StatusChanged"),r(),l("ngIf",t.action==="Assigned"),r(),l("ngIf",t.action==="Created"),r(),l("ngIf",t.action==="Resolved"),r(3),_(t.description),r(2),_(a.formatDate(t.createdDate))}}function Vt(e,d){if(e&1&&(n(0,"div",48)(1,"div",69),f(2,wt,2,0,"div",50)(3,Et,11,6,"div",70),i()()),e&2){let t=s(2);r(2),l("ngIf",t.history.length===0),r(),l("ngForOf",t.history)}}function zt(e,d){if(e&1){let t=x();n(0,"div",15)(1,"div",16)(2,"div",17)(3,"h1"),c(4),i(),n(5,"div",18)(6,"span",19),c(7),i(),n(8,"span",20),c(9),i(),n(10,"span",20),c(11),i()()(),n(12,"div",21),f(13,lt,3,0,"ng-container",22)(14,_t,7,4,"ng-container",22)(15,ut,2,1,"span",23),i()(),n(16,"div",24)(17,"div",25)(18,"div",26)(19,"h3"),c(20,"Ticket Detaylar\u0131"),i(),n(21,"div",27)(22,"label"),c(23,"A\xE7\u0131klama:"),i(),n(24,"p",28),c(25),i()(),n(26,"div",27)(27,"label"),c(28,"Olu\u015Fturan:"),i(),n(29,"span"),c(30),i()(),n(31,"div",27)(32,"label"),c(33,"Olu\u015Fturma Tarihi:"),i(),n(34,"span"),c(35),i()(),f(36,ft,5,1,"div",29),i(),f(37,Ct,9,2,"div",30)(38,bt,5,1,"div",30)(39,ht,5,1,"div",30),i(),n(40,"div",31)(41,"div",32)(42,"button",33),g("click",function(){m(t);let o=s();return o.activeTab="comments",p(o.shouldScrollToBottom=!0)}),c(43),i(),n(44,"button",33),g("click",function(){m(t);let o=s();return p(o.activeTab="history")}),c(45),i()(),f(46,Ot,6,3,"div",34)(47,Vt,4,2,"div",34),i()()()}if(e&2){let t=s();r(4),_(t.ticket.title),r(3),_(t.ticket.ticketCode||"#"+t.ticket.id),r(),l("ngClass",t.getStatusClass(t.ticket.status)),r(),_(t.getStatusText(t.ticket.status)),r(),l("ngClass",t.getPriorityClass(t.ticket.priority)),r(),_(t.getPriorityText(t.ticket.priority)),r(2),l("ngIf",!t.ticket.assignedPerson),r(),l("ngIf",t.isMyTicket&&t.ticket.status!==4&&t.ticket.status!==5),r(),l("ngIf",t.ticket.assignedPerson&&!t.isMyTicket),r(10),_(t.ticket.description),r(5),_(t.ticket.creatorName||"Bilinmiyor"),r(5),_(t.formatDate(t.ticket.createdDate)),r(),l("ngIf",t.ticket.resolvedDate&&(t.ticket.status===4||t.ticket.status===5)),r(),l("ngIf",t.ticket.asset),r(),l("ngIf",t.ticket.imagePaths==null?null:t.ticket.imagePaths.length),r(),l("ngIf",t.ticket.solutionNote),r(3),k("active",t.activeTab==="comments"),r(),v(" Mesajlar (",t.comments.length,") "),r(),k("active",t.activeTab==="history"),r(),v(" Ge\xE7mi\u015F (",t.history.length,") "),r(),l("ngIf",t.activeTab==="comments"),r(),l("ngIf",t.activeTab==="history")}}function Ft(e,d){if(e&1){let t=x();n(0,"div",75),g("click",function(){m(t);let o=s();return p(o.showResolveModal=!1)}),n(1,"div",76),g("click",function(o){return m(t),p(o.stopPropagation())}),n(2,"div",77)(3,"h3"),c(4,"Ticket\u0131 \xC7\xF6z"),i(),n(5,"button",13),g("click",function(){m(t);let o=s();return p(o.showResolveModal=!1)}),c(6,"\xD7"),i()(),n(7,"div",78)(8,"label"),c(9,"\xC7\xF6z\xFCm Notu *"),i(),n(10,"textarea",79),w("ngModelChange",function(o){m(t);let u=s();return O(u.solutionNote,o)||(u.solutionNote=o),p(o)}),i()(),n(11,"div",80)(12,"button",39),g("click",function(){m(t);let o=s();return p(o.showResolveModal=!1)}),c(13,"\u0130ptal"),i(),n(14,"button",40),g("click",function(){m(t);let o=s();return p(o.resolveTicket())}),c(15,"\xC7\xF6z ve Kapat"),i()()()()}if(e&2){let t=s();r(10),y("ngModel",t.solutionNote)}}function Rt(e,d){if(e&1){let t=x();n(0,"div",81),g("click",function(){m(t);let o=s();return p(o.showImagePreview=!1)}),n(1,"div",82),g("click",function(o){return m(t),p(o.stopPropagation())}),n(2,"button",83),g("click",function(){m(t);let o=s();return p(o.showImagePreview=!1)}),c(3,"\xD7"),i(),b(4,"img",84),i()()}if(e&2){let t=s();r(4),l("src",t.baseUrl+"/"+t.selectedImagePath,h)}}var $t=(()=>{class e{constructor(t,a,o,u,nt,it){this.route=t,this.router=a,this.staffService=o,this.signalRService=u,this.location=nt,this.baseUrl=q.baseUrl,this.ticketId="",this.ticket=null,this.comments=[],this.history=[],this.isLoading=!0,this.error=null,this.successMessage=null,this.staffProfile=null,this.isMyTicket=!1,this.newComment="",this.solutionNote="",this.showResolveModal=!1,this.showImagePreview=!1,this.selectedImagePath=null,this.activeTab="comments",this.isSignalRConnected=!1,this.shouldScrollToBottom=!1,this.isBrowser=Y(it)}ngOnInit(){this.ticketId=this.route.snapshot.paramMap.get("id")||"",this.loadStaffProfile(),this.loadTicket(),this.loadComments(),this.loadHistory(),this.isBrowser&&this.initSignalR(),this.refreshInterval=setInterval(()=>{console.log("Staff Ticket-Detail: Periodic comments refresh triggered"),this.loadComments()},2e3)}ngOnDestroy(){this.refreshInterval&&clearInterval(this.refreshInterval),this.ticketId&&this.signalRService.leaveTicketGroup(this.ticketId),this.commentSubscription?.unsubscribe()}ngAfterViewChecked(){this.shouldScrollToBottom&&(this.scrollToBottom(),this.shouldScrollToBottom=!1)}scrollToBottom(){setTimeout(()=>{try{if(this.commentsContainer){let t=this.commentsContainer.nativeElement;t.scrollTop=t.scrollHeight}}catch{}},100)}initSignalR(){return I(this,null,function*(){if(!this.isBrowser){console.log("SignalR: Not in browser environment");return}let t=localStorage.getItem("token")||sessionStorage.getItem("token");if(!t){console.warn("SignalR: No token found. User may not be authenticated.");return}try{console.log("SignalR: Staff - Attempting to start connection"),yield this.signalRService.startConnection(t),console.log("SignalR: Staff - Joining ticket group",this.ticketId),yield this.signalRService.joinTicketGroup(this.ticketId),this.isSignalRConnected=!0,console.log("SignalR: Staff - Successfully connected and joined group"),this.commentSubscription=this.signalRService.commentReceived$.subscribe(a=>{console.log("Staff-Detail: Received comment from SignalR:",a),a.ticketId===this.ticketId&&(this.comments.some(u=>u.id===a.id)?console.log("Staff-Detail: Comment already exists, skipping"):(console.log("Staff-Detail: Adding new comment to list"),this.comments.push(a),this.shouldScrollToBottom=!0,this.loadHistory()))})}catch(a){console.error("SignalR: Connection failed:",a),this.isSignalRConnected=!1,console.warn("SignalR: Real-time updates disabled for staff")}})}openImagePreview(t){this.selectedImagePath=t,this.showImagePreview=!0}loadStaffProfile(){this.staffService.getMyProfile().subscribe({next:t=>{t.success&&(this.staffProfile=t.data,this.checkOwnership())}})}checkOwnership(){if(this.ticket&&this.staffProfile){let t=(this.ticket.assignedPerson||"").toString().trim().toLocaleLowerCase("tr-TR"),a=(this.staffProfile.fullName||"").toString().trim().toLocaleLowerCase("tr-TR");this.isMyTicket=t.length>0&&t===a}}loadTicket(){this.staffService.getTicketDetail(this.ticketId).subscribe({next:t=>{t.success&&(this.ticket=t.data,this.checkOwnership()),this.isLoading=!1},error:t=>{this.error="Ticket y\xFCklenirken hata olu\u015Ftu",this.isLoading=!1}})}claimTicket(){this.staffService.claimTicket(this.ticketId).subscribe({next:t=>{t.success&&(this.successMessage="Ticket \xFCstlenildi!",this.loadTicket(),this.loadStaffProfile(),setTimeout(()=>this.successMessage=null,3e3))},error:t=>{this.error=t.error?.message||"Ticket \xFCstlenilirken hata olu\u015Ftu"}})}loadComments(){this.staffService.getTicketComments(this.ticketId).subscribe({next:t=>{if(t.success){let a=t.data||[];a=a.map(o=>o.isAdminReply&&o.authorName!=="Admin"?S(T({},o),{isStaff:!0}):o),this.comments=a,this.shouldScrollToBottom=!0}}})}loadHistory(){this.staffService.getTicketHistory(this.ticketId).subscribe({next:t=>{t.success&&(this.history=t.data)}})}addComment(){if(!this.isMyTicket){this.error="Ticket\u0131 \xFCstlenmeden mesaj g\xF6nderemezsiniz";return}this.newComment.trim()&&this.staffService.addComment(this.ticketId,this.newComment).subscribe({next:t=>{t.success&&(this.newComment="",this.loadComments(),this.loadHistory(),this.successMessage="Yorum eklendi",setTimeout(()=>this.successMessage=null,3e3))},error:t=>{this.error=t.error?.message||"Yorum eklenirken hata olu\u015Ftu"}})}updateStatus(t){this.staffService.updateTicketStatus(this.ticketId,t).subscribe({next:a=>{a.success&&(this.loadTicket(),this.loadHistory(),this.successMessage="Durum g\xFCncellendi",setTimeout(()=>this.successMessage=null,3e3))},error:a=>{this.error=a.error?.message||"Durum g\xFCncellenirken hata olu\u015Ftu"}})}resolveTicket(){if(!this.solutionNote.trim()){this.error="\xC7\xF6z\xFCm notu gerekli";return}this.staffService.resolveTicket(this.ticketId,this.solutionNote).subscribe({next:t=>{t.success&&(this.showResolveModal=!1,this.solutionNote="",this.loadTicket(),this.loadHistory(),this.successMessage="Ticket ba\u015Far\u0131yla \xE7\xF6z\xFCld\xFC!",setTimeout(()=>this.successMessage=null,3e3))},error:t=>{this.error=t.error?.message||"Ticket \xE7\xF6z\xFCl\xFCrken hata olu\u015Ftu"}})}releaseTicket(){confirm("Bu ticket\u0131 b\u0131rakmak istedi\u011Finize emin misiniz?")&&this.staffService.releaseTicket(this.ticketId).subscribe({next:t=>{t.success&&this.router.navigate(["/staff/my-tickets"])},error:t=>{this.error=t.error?.message||"Ticket b\u0131rak\u0131l\u0131rken hata olu\u015Ftu"}})}getStatusText(t){switch(t){case 1:return"A\xE7\u0131k";case 2:return"\u0130\u015Flemde";case 3:return"M\xFC\u015Fteri Bekliyor";case 4:return"\xC7\xF6z\xFCld\xFC";case 5:return"Kapal\u0131";default:return"Bilinmiyor"}}getStatusClass(t){switch(t){case 1:return"status-open";case 2:return"status-processing";case 3:return"status-waiting";case 4:return"status-resolved";case 5:return"status-closed";default:return""}}getPriorityText(t){switch(t){case 1:return"D\xFC\u015F\xFCk";case 2:return"Normal";case 3:return"Y\xFCksek";case 4:return"Kritik";default:return"Normal"}}getPriorityClass(t){switch(t){case 1:return"priority-low";case 2:return"priority-normal";case 3:return"priority-high";case 4:return"priority-critical";default:return"priority-normal"}}formatDate(t){return new Date(t).toLocaleDateString("tr-TR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}formatTime(t){return new Date(t).toLocaleTimeString("tr-TR",{hour:"2-digit",minute:"2-digit"})}isMyComment(t){return!this.staffProfile||!t?!1:t.authorName===this.staffProfile.fullName}static{this.\u0275fac=function(a){return new(a||e)(C(W),C(K),C(et),C(tt),C(A),C(V))}}static{this.\u0275cmp=D({type:e,selectors:[["app-ticket-detail"]],viewQuery:function(a,o){if(a&1&&F(ot,5),a&2){let u;R(u=j())&&(o.commentsContainer=u.first)}},standalone:!0,features:[N],decls:10,vars:6,consts:[["commentsContainer",""],[1,"ticket-detail-container"],[1,"back-nav"],[1,"back-link",3,"click"],["class","loading-state",4,"ngIf"],["class","error-message",4,"ngIf"],["class","success-message",4,"ngIf"],["class","ticket-content",4,"ngIf"],["class","modal-overlay",3,"click",4,"ngIf"],["class","image-preview-overlay",3,"click",4,"ngIf"],[1,"loading-state"],[1,"spinner"],[1,"error-message"],[1,"close-btn",3,"click"],[1,"success-message"],[1,"ticket-content"],[1,"ticket-header"],[1,"header-left"],[1,"ticket-meta"],[1,"ticket-id"],[1,"badge",3,"ngClass"],[1,"header-actions"],[4,"ngIf"],["class","assigned-info",4,"ngIf"],[1,"content-grid"],[1,"detail-section"],[1,"detail-card"],[1,"detail-row"],[1,"description"],["class","detail-row",4,"ngIf"],["class","detail-card",4,"ngIf"],[1,"activity-section"],[1,"tabs"],[1,"tab",3,"click"],["class","tab-content",4,"ngIf"],[1,"btn","btn-primary",3,"click"],["class","btn btn-primary",3,"click",4,"ngIf"],["class","btn btn-secondary",3,"click",4,"ngIf"],["class","btn btn-success",3,"click",4,"ngIf"],[1,"btn","btn-secondary",3,"click"],[1,"btn","btn-success",3,"click"],[1,"assigned-info"],[1,"ticket-image-grid"],["class","ticket-image-tile","type","button",3,"click",4,"ngFor","ngForOf"],["type","button",1,"ticket-image-tile",3,"click"],[1,"ticket-image",3,"src","alt"],[1,"image-overlay"],[1,"solution-note"],[1,"tab-content"],[1,"comments-list-v2"],["class","empty-state",4,"ngIf"],["class","comment-item-v3",3,"ngClass",4,"ngFor","ngForOf"],["class","add-comment-v2",4,"ngIf"],[1,"empty-state"],[1,"comment-item-v3",3,"ngClass"],[1,"comment-bubble-v2",3,"ngClass"],[1,"bubble-header"],[1,"sender-name"],["class","support-badge",4,"ngIf"],[1,"message-time"],[1,"message-content-v2"],[1,"support-badge"],[1,"add-comment-v2"],[1,"input-wrapper"],["placeholder","Mesaj\u0131n\u0131z\u0131 yaz\u0131n...","rows","2",3,"ngModelChange","ngModel"],[1,"btn-send-v2",3,"click","disabled"],["width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2"],["x1","22","y1","2","x2","11","y2","13"],["points","22 2 15 22 11 13 2 9 22 2"],[1,"history-list"],["class","history-item",4,"ngFor","ngForOf"],[1,"history-item"],[1,"history-icon"],[1,"history-content"],[1,"history-date"],[1,"modal-overlay",3,"click"],[1,"modal-content",3,"click"],[1,"modal-header"],[1,"modal-body"],["placeholder","Yap\u0131lan i\u015Flem ve \xE7\xF6z\xFCm\xFC a\xE7\u0131klay\u0131n...","rows","5",3,"ngModelChange","ngModel"],[1,"modal-footer"],[1,"image-preview-overlay",3,"click"],[1,"preview-content",3,"click"],[1,"btn-close-preview",3,"click"],["alt","B\xFCy\xFCk G\xF6rsel",3,"src"]],template:function(a,o){a&1&&(n(0,"div",1)(1,"div",2)(2,"button",3),g("click",function(){return o.location.back()}),c(3," \u2190 Geri D\xF6n "),i()(),f(4,at,4,0,"div",4)(5,ct,4,1,"div",5)(6,st,4,1,"div",6)(7,zt,48,24,"div",7),i(),f(8,Ft,16,1,"div",8)(9,Rt,5,1,"div",9)),a&2&&(r(4),l("ngIf",o.isLoading),r(),l("ngIf",o.error),r(),l("ngIf",o.successMessage),r(),l("ngIf",!o.isLoading&&o.ticket),r(),l("ngIf",o.showResolveModal),r(),l("ngIf",o.showImagePreview))},dependencies:[U,L,H,G,Q,Z,J,$,X],styles:[".ticket-detail-container[_ngcontent-%COMP%]{padding:16px;max-width:1400px;margin:0 auto}.back-nav[_ngcontent-%COMP%]{margin-bottom:16px}.back-nav[_ngcontent-%COMP%]   .back-link[_ngcontent-%COMP%]{color:#065f46;text-decoration:none;font-weight:500;display:inline-flex;align-items:center;gap:8px;background:none;border:none;padding:0;font-size:14px;cursor:pointer}.back-nav[_ngcontent-%COMP%]   .back-link[_ngcontent-%COMP%]:hover{text-decoration:underline}.loading-state[_ngcontent-%COMP%]{text-align:center;padding:60px 20px}.loading-state[_ngcontent-%COMP%]   .spinner[_ngcontent-%COMP%]{width:40px;height:40px;border:3px solid #e5e7eb;border-top-color:#059669;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite;margin:0 auto 16px}.loading-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#6b7280}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.error-message[_ngcontent-%COMP%], .success-message[_ngcontent-%COMP%]{padding:12px 16px;border-radius:8px;margin-bottom:20px;display:flex;justify-content:space-between;align-items:center}.error-message[_ngcontent-%COMP%]{background:#fee2e2;color:#dc2626;border:1px solid #fecaca}.success-message[_ngcontent-%COMP%]{background:#d1fae5;color:#059669;border:1px solid #a7f3d0}.close-btn[_ngcontent-%COMP%]{background:none;border:none;font-size:20px;cursor:pointer;color:inherit;opacity:.7}.close-btn[_ngcontent-%COMP%]:hover{opacity:1}.ticket-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:16px;padding-bottom:16px;border-bottom:1px solid #e5e7eb}.ticket-header[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:24px;font-weight:700;color:#1f2937;margin-bottom:12px}.ticket-header[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]   .ticket-meta[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.ticket-header[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]   .ticket-meta[_ngcontent-%COMP%]   .ticket-id[_ngcontent-%COMP%]{color:#6b7280;font-weight:500}.ticket-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]{display:flex;gap:12px;align-items:center}.ticket-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .assigned-info[_ngcontent-%COMP%]{padding:8px 16px;background:#f3f4f6;border-radius:8px;font-size:14px;color:#6b7280}@media (max-width: 768px){.ticket-detail-container[_ngcontent-%COMP%]{padding:12px}.ticket-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:12px}.ticket-header[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]{width:100%}.ticket-header[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]   .ticket-meta[_ngcontent-%COMP%]{flex-wrap:wrap;gap:8px}.ticket-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]{width:100%;flex-wrap:wrap;justify-content:flex-start}}.badge[_ngcontent-%COMP%]{display:inline-block;padding:4px 12px;border-radius:20px;font-size:12px;font-weight:600}.status-open[_ngcontent-%COMP%]{background:#fef3c7;color:#d97706}.status-processing[_ngcontent-%COMP%]{background:#dbeafe;color:#2563eb}.status-resolved[_ngcontent-%COMP%]{background:#dbeafe;color:#1e40af}.priority-low[_ngcontent-%COMP%]{background:#f3f4f6;color:#6b7280}.priority-normal[_ngcontent-%COMP%]{background:#dbeafe;color:#2563eb}.priority-high[_ngcontent-%COMP%]{background:#fed7aa;color:#ea580c}.priority-critical[_ngcontent-%COMP%]{background:#fee2e2;color:#dc2626}.btn[_ngcontent-%COMP%]{padding:10px 20px;border:none;border-radius:8px;font-size:14px;font-weight:600;cursor:pointer;transition:all .2s}.btn[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.btn-primary[_ngcontent-%COMP%]{background:linear-gradient(135deg,#1e40af,#3b82f6);color:#fff}.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-1px);box-shadow:0 4px 12px #3b82f64d}.btn-success[_ngcontent-%COMP%]{background:linear-gradient(135deg,#2563eb,#3b82f6);color:#fff}.btn-success[_ngcontent-%COMP%]:hover{transform:translateY(-1px);box-shadow:0 4px 12px #3b82f64d}.btn-secondary[_ngcontent-%COMP%]{background:#f3f4f6;color:#374151}.btn-secondary[_ngcontent-%COMP%]:hover{background:#e5e7eb}.content-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:16px}@media (max-width: 1024px){.content-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}.detail-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.detail-card[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:16px;box-shadow:0 1px 3px #0000001a}.detail-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:16px;font-weight:600;color:#1f2937;margin-bottom:12px;padding-bottom:8px;border-bottom:1px solid #e5e7eb}.detail-card[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]{margin-bottom:12px}.detail-card[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]:last-child{margin-bottom:0}.detail-card[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;font-size:12px;font-weight:600;color:#6b7280;text-transform:uppercase;margin-bottom:4px}.detail-card[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], .detail-card[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#1f2937;font-size:14px}.detail-card[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{line-height:1.6;white-space:pre-wrap}.detail-card[_ngcontent-%COMP%]   .solution-note[_ngcontent-%COMP%]{background:#eff6ff;padding:12px;border-radius:8px;border-left:3px solid #3b82f6;font-size:14px;line-height:1.6;color:#1f2937}.ticket-image-grid[_ngcontent-%COMP%]{margin-top:10px;display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:12px}.ticket-image-tile[_ngcontent-%COMP%]{border:1px solid #e5e7eb;border-radius:8px;padding:0;background:#fff;overflow:hidden;position:relative;cursor:zoom-in}.ticket-image-tile[_ngcontent-%COMP%]   .ticket-image[_ngcontent-%COMP%]{width:100%;height:120px;object-fit:cover;display:block;transition:transform .2s}.ticket-image-tile[_ngcontent-%COMP%]   .image-overlay[_ngcontent-%COMP%]{position:absolute;inset:0;background:#0006;display:flex;align-items:center;justify-content:center;opacity:0;transition:opacity .2s}.ticket-image-tile[_ngcontent-%COMP%]   .image-overlay[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#fff;font-size:12px;font-weight:600;background:#0009;padding:6px 12px;border-radius:20px}.ticket-image-tile[_ngcontent-%COMP%]:hover   .image-overlay[_ngcontent-%COMP%]{opacity:1}.ticket-image-tile[_ngcontent-%COMP%]:hover   .ticket-image[_ngcontent-%COMP%]{transform:scale(1.02)}.image-preview-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#000000e6;display:flex;align-items:center;justify-content:center;z-index:2000;padding:40px;cursor:zoom-out}.image-preview-overlay[_ngcontent-%COMP%]   .preview-content[_ngcontent-%COMP%]{position:relative;max-width:95%;max-height:95%;display:flex;align-items:center;justify-content:center;cursor:default}.image-preview-overlay[_ngcontent-%COMP%]   .preview-content[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:100%;max-height:90vh;border-radius:8px;box-shadow:0 0 30px #00000080}.image-preview-overlay[_ngcontent-%COMP%]   .preview-content[_ngcontent-%COMP%]   .btn-close-preview[_ngcontent-%COMP%]{position:fixed;top:20px;right:20px;background:#ffffff1a;border:2px solid #fff;color:#fff;font-size:30px;cursor:pointer;width:50px;height:50px;border-radius:50%;display:flex;align-items:center;justify-content:center;transition:all .2s;padding:0;line-height:1}.image-preview-overlay[_ngcontent-%COMP%]   .preview-content[_ngcontent-%COMP%]   .btn-close-preview[_ngcontent-%COMP%]:hover{background:#fff3;transform:scale(1.1)}.activity-section[_ngcontent-%COMP%]{background:#fff;border-radius:12px;box-shadow:0 1px 3px #0000001a;overflow:hidden;align-self:start;position:sticky;top:20px}.tabs[_ngcontent-%COMP%]{display:flex;border-bottom:1px solid #e5e7eb}.tabs[_ngcontent-%COMP%]   .tab[_ngcontent-%COMP%]{flex:1;padding:10px 16px;background:none;border:none;font-size:14px;font-weight:600;color:#6b7280;cursor:pointer;border-bottom:2px solid transparent;transition:all .2s}.tabs[_ngcontent-%COMP%]   .tab[_ngcontent-%COMP%]:hover{color:#3b82f6;background:#eff6ff}.tabs[_ngcontent-%COMP%]   .tab.active[_ngcontent-%COMP%]{color:#3b82f6;border-bottom-color:#3b82f6}.tab-content[_ngcontent-%COMP%]{padding:16px}.comments-list-v2[_ngcontent-%COMP%]{max-height:500px;overflow-y:auto;display:flex;flex-direction:column;gap:16px;padding:15px;background:#fff}.comments-list-v2[_ngcontent-%COMP%]   .comment-item-v3[_ngcontent-%COMP%]{display:flex;width:100%}.comments-list-v2[_ngcontent-%COMP%]   .comment-item-v3.my-message-row[_ngcontent-%COMP%]{justify-content:flex-end}.comments-list-v2[_ngcontent-%COMP%]   .comment-item-v3.my-message-row[_ngcontent-%COMP%]   .comment-bubble-v2[_ngcontent-%COMP%]{background:#eff6ff;border:1px solid #dbeafe;border-right:4px solid #3b82f6;border-radius:16px 16px 0;box-shadow:0 4px 6px -1px #0000001a}.comments-list-v2[_ngcontent-%COMP%]   .comment-item-v3.other-message-row[_ngcontent-%COMP%]{justify-content:flex-start}.comments-list-v2[_ngcontent-%COMP%]   .comment-item-v3.other-message-row[_ngcontent-%COMP%]   .comment-bubble-v2[_ngcontent-%COMP%]{background:#f9fafb;border:1px solid #f3f4f6;border-left:4px solid #9ca3af;border-radius:16px 16px 16px 0;box-shadow:0 4px 6px -1px #0000000d}.comments-list-v2[_ngcontent-%COMP%]   .comment-item-v3.other-message-row[_ngcontent-%COMP%]   .comment-bubble-v2.admin-bubble[_ngcontent-%COMP%]{background:#f3f4f6;border-left:4px solid #3b82f6}.comments-list-v2[_ngcontent-%COMP%]   .comment-bubble-v2[_ngcontent-%COMP%]{max-width:80%;padding:12px 16px;position:relative}.comments-list-v2[_ngcontent-%COMP%]   .comment-bubble-v2[_ngcontent-%COMP%]   .bubble-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;margin-bottom:6px}.comments-list-v2[_ngcontent-%COMP%]   .comment-bubble-v2[_ngcontent-%COMP%]   .bubble-header[_ngcontent-%COMP%]   .sender-name[_ngcontent-%COMP%]{font-weight:700;font-size:13px;color:#1f2937}.comments-list-v2[_ngcontent-%COMP%]   .comment-bubble-v2[_ngcontent-%COMP%]   .bubble-header[_ngcontent-%COMP%]   .support-badge[_ngcontent-%COMP%]{background:#3b82f6;color:#fff;font-size:9px;font-weight:800;padding:2px 6px;border-radius:4px;text-transform:uppercase}.comments-list-v2[_ngcontent-%COMP%]   .comment-bubble-v2[_ngcontent-%COMP%]   .bubble-header[_ngcontent-%COMP%]   .message-time[_ngcontent-%COMP%]{font-size:11px;color:#9ca3af;margin-left:auto}.comments-list-v2[_ngcontent-%COMP%]   .comment-bubble-v2[_ngcontent-%COMP%]   .message-content-v2[_ngcontent-%COMP%]{margin:0;font-size:14px;color:#4b5563;line-height:1.5;white-space:pre-wrap}.add-comment-v2[_ngcontent-%COMP%]{margin-top:15px;padding:15px;background:#fff;border-top:1px solid #f3f4f6}.add-comment-v2[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]{display:flex;gap:12px;align-items:center}.add-comment-v2[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{flex:1;padding:12px;border:1px solid #e5e7eb;border-radius:12px;font-size:14px;resize:none;font-family:inherit;background:#f9fafb;transition:all .2s}.add-comment-v2[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus{outline:none;border-color:#3b82f6;background:#fff;box-shadow:0 0 0 3px #3b82f61a}.add-comment-v2[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]   .btn-send-v2[_ngcontent-%COMP%]{width:44px;height:44px;display:flex;align-items:center;justify-content:center;background:#3b82f6;color:#fff;border:none;border-radius:10px;cursor:pointer;transition:all .2s}.add-comment-v2[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]   .btn-send-v2[_ngcontent-%COMP%]:hover:not(:disabled){background:#2563eb;transform:translateY(-2px)}.add-comment-v2[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]   .btn-send-v2[_ngcontent-%COMP%]:disabled{background:#d1d5db;cursor:not-allowed}.add-comment-v2[_ngcontent-%COMP%]   .input-wrapper[_ngcontent-%COMP%]   .btn-send-v2[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{transform:rotate(45deg);margin-left:-4px;margin-top:4px}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:40px 20px;color:#9ca3af}.history-list[_ngcontent-%COMP%]{max-height:350px;overflow-y:auto}.history-list[_ngcontent-%COMP%]   .history-item[_ngcontent-%COMP%]{display:flex;gap:12px;padding:12px 0;border-bottom:1px solid #f3f4f6}.history-list[_ngcontent-%COMP%]   .history-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.history-list[_ngcontent-%COMP%]   .history-item[_ngcontent-%COMP%]   .history-icon[_ngcontent-%COMP%]{width:36px;height:36px;background:#f3f4f6;border-radius:50%;display:flex;align-items:center;justify-content:center;flex-shrink:0}.history-list[_ngcontent-%COMP%]   .history-item[_ngcontent-%COMP%]   .history-content[_ngcontent-%COMP%]{flex:1}.history-list[_ngcontent-%COMP%]   .history-item[_ngcontent-%COMP%]   .history-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 4px;color:#1f2937;font-size:14px}.history-list[_ngcontent-%COMP%]   .history-item[_ngcontent-%COMP%]   .history-content[_ngcontent-%COMP%]   .history-date[_ngcontent-%COMP%]{font-size:12px;color:#9ca3af}.modal-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#00000080;display:flex;align-items:center;justify-content:center;z-index:1000}.modal-content[_ngcontent-%COMP%]{background:#fff;border-radius:12px;width:100%;max-width:500px;margin:20px;box-shadow:0 20px 40px #0003}.modal-content[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:20px;border-bottom:1px solid #e5e7eb}.modal-content[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:18px;font-weight:600;color:#1f2937}.modal-content[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]{padding:20px}.modal-content[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;font-size:14px;font-weight:600;color:#374151;margin-bottom:8px}.modal-content[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{width:100%;padding:12px;border:1px solid #e5e7eb;border-radius:8px;font-size:14px;resize:vertical;font-family:inherit}.modal-content[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus{outline:none;border-color:#059669;box-shadow:0 0 0 3px #0596691a}.modal-content[_ngcontent-%COMP%]   .modal-footer[_ngcontent-%COMP%]{padding:20px;border-top:1px solid #e5e7eb;display:flex;justify-content:flex-end;gap:12px}"]})}}return e})();export{$t as TicketDetailComponent};
