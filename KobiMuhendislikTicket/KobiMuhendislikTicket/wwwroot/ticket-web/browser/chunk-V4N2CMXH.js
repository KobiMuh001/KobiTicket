import{a as L}from"./chunk-73L5S5JL.js";import{f as F,i as I}from"./chunk-SYWROKNQ.js";import{La as x,Na as u,Oa as S,Pa as T,Qa as b,Sa as _,Ub as z,Va as M,Wa as P,Xa as e,Ya as n,Z as v,Za as p,ab as E,bb as O,cb as d,fa as C,ga as k,ha as g,hb as o,ia as f,ib as l,jb as m,qb as D,sb as y,ya as a,za as w}from"./chunk-CSHUE4LK.js";var j=(i,c)=>c.id,V=i=>["/staff/tickets",i];function W(i,c){if(i&1&&(e(0,"div",4)(1,"div",12)(2,"div",13),g(),e(3,"svg",14),p(4,"path",15)(5,"polyline",16),n()(),f(),e(6,"div",17)(7,"span",18),o(8),n(),e(9,"span",19),o(10,"Aktif Ticket"),n()()(),e(11,"div",12)(12,"div",20),g(),e(13,"svg",14),p(14,"circle",21)(15,"line",22)(16,"line",23),n()(),f(),e(17,"div",17)(18,"span",18),o(19),n(),e(20,"span",19),o(21,"Bekleyen"),n()()(),e(22,"div",12)(23,"div",24),g(),e(24,"svg",14),p(25,"path",25)(26,"polyline",26),n()(),f(),e(27,"div",17)(28,"span",18),o(29),n(),e(30,"span",19),o(31,"Bug\xFCn \xC7\xF6z\xFClen"),n()()(),e(32,"div",12)(33,"div",27),g(),e(34,"svg",14),p(35,"rect",28)(36,"line",29)(37,"line",30),n()(),f(),e(38,"div",17)(39,"span",18),o(40),n(),e(41,"span",19),o(42,"Kapasite"),n()(),e(43,"div",31),p(44,"div",32),n()()()),i&2){let t=d();a(8),l(t.workload.assignedTickets),a(11),l(t.workload.openTickets),a(10),l(t.workload.resolvedToday),a(11),m("",t.getWorkloadPercentage(),"%"),a(4),S("width",t.getWorkloadPercentage(),"%"),T("high",t.getWorkloadPercentage()>80)("medium",t.getWorkloadPercentage()>50&&t.getWorkloadPercentage()<=80)}}function B(i,c){i&1&&(e(0,"div",10),o(1,"Y\xFCkleniyor..."),n())}function G(i,c){i&1&&(e(0,"div",33)(1,"p"),o(2,"Hen\xFCz atanm\u0131\u015F ticket yok"),n()())}function A(i,c){if(i&1&&(e(0,"a",35)(1,"div",36)(2,"span",37),o(3),n(),e(4,"span",38),o(5),n()(),e(6,"div",39)(7,"span",40),o(8),n(),e(9,"span",41),o(10),n()()()),i&2){let t=c.$implicit,r=d(2);u("routerLink",y(9,V,t.id)),a(3),l(t.title),a(2),l(t.companyName),a(2),b(r.getStatusClass(t.status)),a(),m(" ",r.getStatusText(t.status)," "),a(),b(r.getPriorityClass(t.priority)),a(),m(" ",r.getPriorityText(t.priority)," ")}}function N(i,c){if(i&1&&(e(0,"div",34),M(1,A,11,11,"a",35,j),n()),i&2){let t=d();a(),P(t.myTickets)}}function $(i,c){i&1&&(e(0,"div",10),o(1,"Y\xFCkleniyor..."),n())}function K(i,c){i&1&&(e(0,"div",33)(1,"p"),o(2,"Bekleyen ticket yok \u{1F389}"),n()())}function Y(i,c){if(i&1){let t=E();e(0,"a",43),O("click",function(){let s=C(t).$implicit,h=d(2);return k(h.onTicketSelect(s.id))}),e(1,"div",36)(2,"span",37),o(3),n(),e(4,"span",38),o(5),n()(),e(6,"div",44)(7,"span",41),o(8),n(),e(9,"button",45),O("click",function(s){let h=C(t).$implicit,H=d(2);return s.preventDefault(),s.stopPropagation(),k(H.claimTicket(h.id))}),o(10," \xDCstlen "),n()()()}if(i&2){let t=c.$implicit,r=d(2);u("routerLink",y(7,V,t.id)),a(3),l(t.title),a(2),l(t.companyName),a(2),b(r.getPriorityClass(t.priority)),a(),m(" ",r.getPriorityText(t.priority)," "),a(),u("disabled",r.workload&&!r.workload.isAvailable)}}function R(i,c){if(i&1&&(e(0,"div",34),M(1,Y,11,9,"a",42,j),n()),i&2){let t=d();a(),P(t.unassignedTickets)}}var Z=(()=>{class i{constructor(t){this.staffService=t,this.workload=null,this.myTickets=[],this.unassignedTickets=[],this.isLoading=!0,this.error=null}ngOnInit(){this.loadDashboardData(),this.refreshInterval=setInterval(()=>{console.log("Staff Dashboard: Periodic refresh triggered"),this.loadDashboardData()},3e4)}ngOnDestroy(){this.refreshInterval&&clearInterval(this.refreshInterval)}loadDashboardData(){this.isLoading=!0,this.staffService.getMyWorkload().subscribe({next:t=>{t.success&&(this.workload=t.data)},error:()=>{}}),this.staffService.getMyTickets().subscribe({next:t=>{t.success&&(this.myTickets=t.data.slice(0,5))},error:()=>{}}),this.staffService.getUnassignedTickets().subscribe({next:t=>{t.success&&(this.unassignedTickets=t.data.slice(0,5)),this.isLoading=!1},error:()=>{this.isLoading=!1}})}claimTicket(t){this.staffService.claimTicket(t).subscribe({next:r=>{r.success&&this.loadDashboardData()},error:r=>{this.error=r.error?.message||"Ticket al\u0131n\u0131rken hata olu\u015Ftu"}})}getStatusText(t){switch(t){case 1:return"A\xE7\u0131k";case 2:return"\u0130\u015Flemde";case 3:return"M\xFC\u015Fteri Bekliyor";case 4:return"\xC7\xF6z\xFCld\xFC";case 5:return"Kapal\u0131";default:return"Bilinmiyor"}}getStatusClass(t){switch(t){case 1:return"status-open";case 2:return"status-processing";case 3:return"status-waiting";case 4:return"status-resolved";case 5:return"status-closed";default:return""}}getPriorityText(t){switch(t){case 1:return"D\xFC\u015F\xFCk";case 2:return"Normal";case 3:return"Y\xFCksek";case 4:return"Kritik";default:return"Normal"}}getPriorityClass(t){switch(t){case 1:return"priority-low";case 2:return"priority-normal";case 3:return"priority-high";case 4:return"priority-critical";default:return"priority-normal"}}getWorkloadPercentage(){return!this.workload||!this.workload.maxConcurrentTickets?0:Math.round(this.workload.assignedTickets/this.workload.maxConcurrentTickets*100)}onTicketSelect(t){console.log("Dashboard: ticket selected",t)}static{this.\u0275fac=function(r){return new(r||i)(w(L))}}static{this.\u0275cmp=v({type:i,selectors:[["app-staff-dashboard"]],standalone:!0,features:[D],decls:29,vars:3,consts:[[1,"staff-dashboard"],[1,"page-header"],[1,"header-left"],[1,"subtitle"],[1,"stats-grid"],[1,"dashboard-grid"],[1,"dashboard-card"],[1,"card-header"],["routerLink","/staff/my-tickets",1,"view-all"],[1,"card-body"],[1,"loading"],["routerLink","/staff/open-tickets",1,"view-all"],[1,"stat-card"],[1,"stat-icon","processing"],["width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2"],["d","M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"],["points","14 2 14 8 20 8"],[1,"stat-info"],[1,"stat-value"],[1,"stat-label"],[1,"stat-icon","open"],["cx","12","cy","12","r","10"],["x1","12","y1","8","x2","12","y2","12"],["x1","12","y1","16","x2","12.01","y2","16"],[1,"stat-icon","resolved"],["d","M22 11.08V12a10 10 0 1 1-5.93-9.14"],["points","22 4 12 14.01 9 11.01"],[1,"stat-icon","capacity"],["x","3","y","3","width","18","height","18","rx","2","ry","2"],["x1","3","y1","9","x2","21","y2","9"],["x1","9","y1","21","x2","9","y2","9"],[1,"capacity-bar"],[1,"capacity-fill"],[1,"empty-state"],[1,"ticket-list"],[1,"ticket-item",3,"routerLink"],[1,"ticket-info"],[1,"ticket-title"],[1,"ticket-company"],[1,"ticket-meta"],[1,"status"],[1,"priority"],[1,"ticket-item","unassigned",3,"routerLink"],[1,"ticket-item","unassigned",3,"click","routerLink"],[1,"ticket-actions"],[1,"claim-btn",3,"click","disabled"]],template:function(r,s){r&1&&(e(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1"),o(4,"Dashboard"),n(),e(5,"p",3),o(6,"Ho\u015F geldiniz! \u0130\u015Fte g\xFCncel durumunuz."),n()()(),x(7,W,45,10,"div",4),e(8,"div",5)(9,"div",6)(10,"div",7)(11,"h2"),o(12,"Aktif Ticketlar\u0131m"),n(),e(13,"a",8),o(14,"T\xFCm\xFCn\xFC G\xF6r \u2192"),n()(),e(15,"div",9),x(16,B,2,0,"div",10)(17,G,3,0)(18,N,3,0),n()(),e(19,"div",6)(20,"div",7)(21,"h2"),o(22,"A\xE7\u0131k Ticketlar"),n(),e(23,"a",11),o(24,"T\xFCm\xFCn\xFC G\xF6r \u2192"),n()(),e(25,"div",9),x(26,$,2,0,"div",10)(27,K,3,0)(28,R,3,0),n()()()()),r&2&&(a(7),_(7,s.workload?7:-1),a(9),_(16,s.isLoading?16:s.myTickets.length===0?17:18),a(10),_(26,s.isLoading?26:s.unassignedTickets.length===0?27:28))},dependencies:[z,I,F],styles:[".staff-dashboard[_ngcontent-%COMP%]{padding:0}.toast-container[_ngcontent-%COMP%]{position:fixed;top:20px;right:20px;padding:12px 16px;border-radius:8px;display:flex;align-items:center;gap:12px;max-width:400px;box-shadow:0 4px 12px #00000026;animation:_ngcontent-%COMP%_slideIn .3s ease-out;z-index:1000}.toast-container[_ngcontent-%COMP%]   .toast-content[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;font-size:14px;font-weight:500}.toast-container[_ngcontent-%COMP%]   .toast-content[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{flex-shrink:0}.toast-container.toast-success[_ngcontent-%COMP%]{background:#f0fdf4;color:#16a34a;border:1px solid #86efac}.toast-container.toast-success[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{stroke:#16a34a}.toast-container.toast-error[_ngcontent-%COMP%]{background:#fef2f2;color:#dc2626;border:1px solid #fecaca}.toast-container.toast-error[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{stroke:#dc2626}.toast-container.toast-info[_ngcontent-%COMP%]{background:#f0f9ff;color:#0284c7;border:1px solid #bae6fd}.toast-container.toast-info[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{stroke:#0284c7}@media (max-width: 640px){.toast-container[_ngcontent-%COMP%]{max-width:320px;right:10px;left:10px}}@keyframes _ngcontent-%COMP%_slideIn{0%{transform:translate(400px);opacity:0}to{transform:translate(0);opacity:1}}.page-header[_ngcontent-%COMP%]{margin-bottom:30px;display:flex;align-items:flex-start;justify-content:space-between;gap:20px}.page-header[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]{flex:1}.page-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:28px;font-weight:600;color:#1e293b;margin:0 0 8px}.page-header[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{color:#64748b;font-size:15px;margin:0}.page-header[_ngcontent-%COMP%]   .header-right[_ngcontent-%COMP%]{flex-shrink:0}.alert[_ngcontent-%COMP%]{padding:12px 16px;border-radius:8px;margin-bottom:20px;display:flex;align-items:center;justify-content:space-between}.alert.alert-error[_ngcontent-%COMP%]{background:#fef2f2;color:#dc2626;border:1px solid #fecaca}.alert[_ngcontent-%COMP%]   .close-btn[_ngcontent-%COMP%]{background:none;border:none;font-size:20px;cursor:pointer;color:inherit}.stats-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:20px;margin-bottom:30px}.stat-card[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:20px;display:flex;align-items:flex-start;gap:15px;box-shadow:0 1px 3px #0000001a;position:relative;overflow:hidden}.stat-icon[_ngcontent-%COMP%]{width:48px;height:48px;border-radius:12px;display:flex;align-items:center;justify-content:center;flex-shrink:0}.stat-icon.processing[_ngcontent-%COMP%]{background:#dbeafe;color:#2563eb}.stat-icon.open[_ngcontent-%COMP%]{background:#fef3c7;color:#d97706}.stat-icon.resolved[_ngcontent-%COMP%]{background:#d1fae5;color:#059669}.stat-icon.capacity[_ngcontent-%COMP%]{background:#f3e8ff;color:#9333ea}.stat-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px}.stat-value[_ngcontent-%COMP%]{font-size:28px;font-weight:700;color:#1e293b}.stat-label[_ngcontent-%COMP%]{font-size:14px;color:#64748b}.capacity-bar[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;height:4px;background:#e2e8f0}.capacity-fill[_ngcontent-%COMP%]{height:100%;background:#10b981;transition:width .3s ease}.capacity-fill.medium[_ngcontent-%COMP%]{background:#f59e0b}.capacity-fill.high[_ngcontent-%COMP%]{background:#ef4444}.dashboard-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(400px,1fr));gap:20px}.dashboard-card[_ngcontent-%COMP%]{background:#fff;border-radius:12px;box-shadow:0 1px 3px #0000001a;overflow:hidden}.card-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:16px 20px;border-bottom:1px solid #f1f5f9}.card-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:16px;font-weight:600;color:#1e293b;margin:0}.card-header[_ngcontent-%COMP%]   .view-all[_ngcontent-%COMP%]{font-size:13px;color:#059669;text-decoration:none;font-weight:500}.card-header[_ngcontent-%COMP%]   .view-all[_ngcontent-%COMP%]:hover{text-decoration:underline}.card-body[_ngcontent-%COMP%]{padding:0}.loading[_ngcontent-%COMP%], .empty-state[_ngcontent-%COMP%]{padding:40px 20px;text-align:center;color:#64748b}.ticket-list[_ngcontent-%COMP%]{display:flex;flex-direction:column}.ticket-item[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:14px 20px;border-bottom:1px solid #f1f5f9;text-decoration:none;transition:background .2s}.ticket-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.ticket-item[_ngcontent-%COMP%]:hover{background:#f8fafc}.ticket-item.unassigned[_ngcontent-%COMP%]{cursor:default}.ticket-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px;min-width:0;flex:1}.ticket-title[_ngcontent-%COMP%]{font-size:14px;font-weight:500;color:#1e293b;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.ticket-company[_ngcontent-%COMP%]{font-size:12px;color:#64748b}.ticket-meta[_ngcontent-%COMP%], .ticket-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;flex-shrink:0}.status[_ngcontent-%COMP%], .priority[_ngcontent-%COMP%]{font-size:11px;font-weight:500;padding:4px 8px;border-radius:6px}.status-open[_ngcontent-%COMP%]{background:#fef3c7;color:#92400e}.status-processing[_ngcontent-%COMP%]{background:#dbeafe;color:#1e40af}.status-resolved[_ngcontent-%COMP%]{background:#d1fae5;color:#065f46}.priority-low[_ngcontent-%COMP%]{background:#f1f5f9;color:#64748b}.priority-normal[_ngcontent-%COMP%]{background:#dbeafe;color:#1e40af}.priority-high[_ngcontent-%COMP%]{background:#fef3c7;color:#92400e}.priority-critical[_ngcontent-%COMP%]{background:#fee2e2;color:#991b1b}.claim-btn[_ngcontent-%COMP%]{background:#059669;color:#fff;border:none;padding:6px 14px;border-radius:6px;font-size:13px;font-weight:500;cursor:pointer;transition:all .2s}.claim-btn[_ngcontent-%COMP%]:hover:not(:disabled){background:#047857}.claim-btn[_ngcontent-%COMP%]:disabled{background:#94a3b8;cursor:not-allowed}.notifications-widget[_ngcontent-%COMP%]{position:relative}.notification-toggle[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50%;background:#fff;border:1px solid #e2e8f0;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all .2s;color:#64748b;position:relative}.notification-toggle[_ngcontent-%COMP%]:hover{background:#f8fafc;border-color:#cbd5e1}.notification-toggle.has-unread[_ngcontent-%COMP%]{color:#ef4444;background:#fef2f2;border-color:#fecaca}.notification-badge[_ngcontent-%COMP%]{position:absolute;top:-6px;right:-6px;background:#ef4444;color:#fff;font-size:11px;font-weight:600;width:20px;height:20px;border-radius:50%;display:flex;align-items:center;justify-content:center;border:2px solid #fff}.notifications-dropdown[_ngcontent-%COMP%]{position:absolute;top:100%;right:0;width:500px;z-index:1000;margin-top:8px;background:#fff;border-radius:12px;box-shadow:0 10px 25px #00000026;border:1px solid #f1f5f9;overflow:hidden}.dropdown-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:1.25rem 1.5rem;border-bottom:1px solid #f1f5f9}.dropdown-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.125rem;font-weight:600;color:#1e293b;margin:0}.dropdown-header[_ngcontent-%COMP%]   .unread-count[_ngcontent-%COMP%]{font-size:.75rem;background:#dbeafe;color:#1e40af;padding:.25rem .5rem;border-radius:4px;font-weight:500}.dropdown-header[_ngcontent-%COMP%]   .mark-all-btn[_ngcontent-%COMP%]{background:#e0e7ff;color:#1e40af;border:none;padding:.35rem .6rem;border-radius:6px;font-size:12px;font-weight:600;cursor:pointer;margin-left:8px}.notifications-list[_ngcontent-%COMP%]{max-height:400px;overflow-y:auto}.notifications-list[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.notifications-list[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}.notifications-list[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#cbd5e1;border-radius:3px}.notifications-list[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#94a3b8}.notifications-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.notifications-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid #f1f5f9;transition:background .2s}.notifications-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:last-child{border-bottom:none}.notifications-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:#f8fafc}.notifications-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr.unread[_ngcontent-%COMP%]{background:#f0fdf4}.notifications-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr.unread[_ngcontent-%COMP%]:hover{background:#ecfdf5}.notification-cell[_ngcontent-%COMP%]{padding:14px 16px;width:65%}.notification-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px}.notification-title[_ngcontent-%COMP%]{margin:0;font-size:14px;font-weight:600;color:#0f172a}.notification-message[_ngcontent-%COMP%]{margin:0;font-size:12px;color:#64748b}.notification-date[_ngcontent-%COMP%]{padding:14px 12px;font-size:12px;color:#94a3b8;white-space:nowrap}.notification-actions-cell[_ngcontent-%COMP%]{padding:10px 12px;display:flex;gap:6px;align-items:center;justify-content:flex-end}.mark-read-btn[_ngcontent-%COMP%], .delete-btn[_ngcontent-%COMP%]{width:28px;height:28px;border-radius:6px;border:1px solid #e2e8f0;background:#fff;color:#64748b;display:inline-flex;align-items:center;justify-content:center;cursor:pointer;transition:all .2s}.mark-read-btn[_ngcontent-%COMP%]:hover, .delete-btn[_ngcontent-%COMP%]:hover{background:#f8fafc;color:#0f172a}.delete-btn[_ngcontent-%COMP%]:hover{background:#fef2f2;color:#dc2626;border-color:#fecaca}.dropdown-footer[_ngcontent-%COMP%]{padding:12px 16px;border-top:1px solid #f1f5f9;display:flex;justify-content:flex-end}.view-all[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:6px;color:#2563eb;font-size:13px;font-weight:600;text-decoration:none}.empty-state[_ngcontent-%COMP%]{padding:20px;text-align:center;color:#94a3b8;font-size:13px}@media (max-width: 768px){.page-header[_ngcontent-%COMP%]{flex-direction:column}.page-header[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]{width:100%}.page-header[_ngcontent-%COMP%]   .header-right[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:flex-end}.dashboard-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.stats-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}.notifications-dropdown[_ngcontent-%COMP%]{width:320px}}@media (max-width: 480px){.stats-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.notifications-dropdown[_ngcontent-%COMP%]{width:300px;right:-20px}}"]})}}return i})();export{Z as StaffDashboardComponent};
