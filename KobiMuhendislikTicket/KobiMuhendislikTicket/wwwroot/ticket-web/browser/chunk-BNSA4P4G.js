import{a as Y}from"./chunk-7RKEGLV2.js";import{a as G}from"./chunk-GXXDP47E.js";import{b as z,c as A,f as N,i as B,j as W,k as L,r as j}from"./chunk-PRZMQGB5.js";import{c as F,e as V,i as q}from"./chunk-RCMVJVUR.js";import{La as M,Na as _,Sa as p,Va as v,Vb as D,Wa as P,Wb as I,Xa as n,Ya as r,Z as k,Za as O,ab as y,bb as g,cb as l,fa as c,ga as u,ib as a,jb as C,kb as w,nb as h,ob as b,pb as x,rb as E,ub as S,vb as T,ya as d,za as f}from"./chunk-W3I5MFZP.js";var K=(o,m)=>m.productId,H=(o,m)=>m.id;function J(o,m){if(o&1&&(n(0,"div",7),a(1),r()),o&2){let t=l();d(),w(" ",t.errorMessage," ")}}function Q(o,m){if(o&1&&(n(0,"div",8),a(1),r()),o&2){let t=l();d(),w(" ",t.successMessage," ")}}function U(o,m){o&1&&(n(0,"div",9),O(1,"div",11),n(2,"p"),a(3,"\xDCr\xFCn listesi y\xFCkleniyor..."),r()())}function X(o,m){o&1&&(n(0,"div",12)(1,"h3"),a(2,"\xDCr\xFCn bulunamad\u0131"),r(),n(3,"p"),a(4,"Bu m\xFC\u015Fteriye ba\u011Fl\u0131 \xFCr\xFCn bulunmuyor."),r()())}function Z(o,m){if(o&1){let t=y();n(0,"tr")(1,"td",15),a(2),r(),n(3,"td"),a(4),S(5,"date"),r(),n(6,"td"),a(7),S(8,"date"),r(),n(9,"td")(10,"button",16),g("click",function(){let e=c(t).$implicit,s=l(3);return u(s.openEditModal(e.productId))}),a(11," D\xFCzenle "),r(),n(12,"button",17),g("click",function(){let e=c(t).$implicit,s=l(3);return u(s.removeProduct(e.productId))}),a(13," Kald\u0131r "),r()()()}if(o&2){let t=m.$implicit,i=l(3);d(2),C(t.productName),d(2),C(t.acquisitionDate?T(5,5,t.acquisitionDate,"dd.MM.yyyy"):"-"),d(3),C(t.warrantyEndDate?T(8,8,t.warrantyEndDate,"dd.MM.yyyy"):"-"),d(3),_("disabled",i.isSaving),d(2),_("disabled",i.isSaving)}}function $(o,m){if(o&1&&(n(0,"div",13)(1,"table",14)(2,"thead")(3,"tr")(4,"th"),a(5,"\xDCr\xFCn Ad\u0131"),r(),n(6,"th"),a(7,"Sahiplik Tarihi"),r(),n(8,"th"),a(9,"Garanti Biti\u015F"),r(),n(10,"th"),a(11,"\u0130\u015Flem"),r()()(),n(12,"tbody"),v(13,Z,14,11,"tr",null,K),r()()()),o&2){let t=l(2);d(13),P(t.products)}}function tt(o,m){if(o&1&&M(0,X,5,0,"div",12)(1,$,15,0),o&2){let t=l();p(0,t.products.length===0?0:1)}}function et(o,m){if(o&1&&(n(0,"option",25),a(1),r()),o&2){let t=m.$implicit;_("ngValue",t.id),d(),C(t.name)}}function nt(o,m){o&1&&a(0," Ekleniyor... ")}function it(o,m){o&1&&a(0," Ekle ")}function rt(o,m){if(o&1){let t=y();n(0,"div",18),g("click",function(){c(t);let e=l();return u(e.closeAssignModal())}),n(1,"div",19),g("click",function(e){return c(t),u(e.stopPropagation())}),n(2,"div",20)(3,"h2"),a(4,"\xDCr\xFCn Ekle"),r(),n(5,"button",21),g("click",function(){c(t);let e=l();return u(e.closeAssignModal())}),a(6,"\xD7"),r()(),n(7,"div",22)(8,"div",23)(9,"label"),a(10,"\xDCr\xFCn *"),r(),n(11,"select",24),x("ngModelChange",function(e){c(t);let s=l();return b(s.selectedProductId,e)||(s.selectedProductId=e),u(e)}),n(12,"option",25),a(13,"\xDCr\xFCn se\xE7in..."),r(),v(14,et,2,2,"option",25,H),r()(),n(16,"div",23)(17,"label"),a(18,"Garanti Biti\u015F Tarihi *"),r(),n(19,"input",26),x("ngModelChange",function(e){c(t);let s=l();return b(s.warrantyEndDate,e)||(s.warrantyEndDate=e),u(e)}),r()(),n(20,"div",23)(21,"label"),a(22,"Sahiplik Tarihi"),r(),n(23,"input",26),x("ngModelChange",function(e){c(t);let s=l();return b(s.acquisitionDate,e)||(s.acquisitionDate=e),u(e)}),r()()(),n(24,"div",27)(25,"button",28),g("click",function(){c(t);let e=l();return u(e.closeAssignModal())}),a(26,"\u0130ptal"),r(),n(27,"button",29),g("click",function(){c(t);let e=l();return u(e.assignProduct())}),M(28,nt,1,0)(29,it,1,0),r()()()()}if(o&2){let t=l();d(11),h("ngModel",t.selectedProductId),d(),_("ngValue",null),d(2),P(t.allProducts),d(5),h("ngModel",t.warrantyEndDate),d(4),h("ngModel",t.acquisitionDate),d(4),_("disabled",t.isSaving),d(),p(28,t.isSaving?28:29)}}function ot(o,m){if(o&1){let t=y();n(0,"div",18),g("click",function(){c(t);let e=l();return u(e.closeEditModal())}),n(1,"div",19),g("click",function(e){return c(t),u(e.stopPropagation())}),n(2,"div",20)(3,"h2"),a(4,"\xDCr\xFCn Bilgisi D\xFCzenle"),r(),n(5,"button",21),g("click",function(){c(t);let e=l();return u(e.closeEditModal())}),a(6,"\xD7"),r()(),n(7,"div",22)(8,"div",23)(9,"label"),a(10,"Garanti Biti\u015F Tarihi *"),r(),n(11,"input",30),x("ngModelChange",function(e){c(t);let s=l();return b(s.editData.warrantyEndDate,e)||(s.editData.warrantyEndDate=e),u(e)}),r()(),n(12,"div",23)(13,"label"),a(14,"Sahiplik Tarihi"),r(),n(15,"input",30),x("ngModelChange",function(e){c(t);let s=l();return b(s.editData.acquisitionDate,e)||(s.editData.acquisitionDate=e),u(e)}),r()()(),n(16,"div",27)(17,"button",28),g("click",function(){c(t);let e=l();return u(e.closeEditModal())}),a(18,"\u0130ptal"),r(),n(19,"button",29),g("click",function(){c(t);let e=l();return u(e.saveEditModal())}),a(20,"Kaydet"),r()()()()}if(o&2){let t=l();d(11),h("ngModel",t.editData.warrantyEndDate),d(4),h("ngModel",t.editData.acquisitionDate),d(4),_("disabled",t.isSaving)}}var _t=(()=>{class o{constructor(t,i,e,s){this.route=t,this.router=i,this.productService=e,this.tenantService=s,this.tenantId=0,this.tenantName="",this.products=[],this.allProducts=[],this.isLoading=!0,this.isSaving=!1,this.errorMessage="",this.successMessage="",this.showAssignModal=!1,this.selectedProductId=null,this.warrantyEndDate="",this.acquisitionDate="",this.showEditModal=!1,this.editingProductId=null,this.editData={warrantyEndDate:"",acquisitionDate:""}}ngOnInit(){if(this.tenantId=Number(this.route.snapshot.paramMap.get("id")),!this.tenantId||Number.isNaN(this.tenantId)){this.errorMessage="Ge\xE7ersiz m\xFC\u015Fteri id.",this.isLoading=!1;return}this.loadTenant(),this.loadAllProducts(),this.loadTenantProducts()}loadTenant(){this.tenantService.getTenantById(String(this.tenantId)).subscribe({next:t=>{let i=t?.data||t;this.tenantName=i?.companyName||""}})}loadAllProducts(){this.productService.getProducts().subscribe({next:t=>{this.allProducts=t?.data||[]}})}loadTenantProducts(){this.isLoading=!0,this.productService.getTenantProductsForAdmin(this.tenantId).subscribe({next:t=>{this.products=t?.data||[],this.isLoading=!1},error:()=>{this.errorMessage="M\xFC\u015Fterinin \xFCr\xFCnleri y\xFCklenirken hata olu\u015Ftu.",this.isLoading=!1}})}goBack(){this.router.navigate(["/admin/tenants",this.tenantId])}openAssignModal(){this.selectedProductId=null,this.warrantyEndDate="",this.acquisitionDate="",this.errorMessage="",this.successMessage="",this.showAssignModal=!0}closeAssignModal(){this.showAssignModal=!1,this.selectedProductId=null,this.warrantyEndDate="",this.acquisitionDate=""}assignProduct(){if(!this.selectedProductId){this.errorMessage="L\xFCtfen \xFCr\xFCn se\xE7in.";return}if(!this.warrantyEndDate){this.errorMessage="Garanti biti\u015F tarihi zorunludur.";return}this.isSaving=!0,this.errorMessage="",this.successMessage="",this.productService.assignProductToTenant(this.selectedProductId,this.tenantId,{warrantyEndDate:this.warrantyEndDate,acquisitionDate:this.acquisitionDate||void 0}).subscribe({next:t=>{this.isSaving=!1,this.successMessage=t?.message||"\xDCr\xFCn m\xFC\u015Fteriye atand\u0131.",this.closeAssignModal(),this.loadTenantProducts()},error:t=>{this.isSaving=!1,this.errorMessage=t?.error?.message||"\xDCr\xFCn atama s\u0131ras\u0131nda hata olu\u015Ftu."}})}openEditModal(t){let i=this.products.find(e=>e.productId===t);i&&(this.editingProductId=t,this.editData={warrantyEndDate:this.toDateInput(i.warrantyEndDate),acquisitionDate:this.toDateInput(i.acquisitionDate)},this.errorMessage="",this.successMessage="",this.showEditModal=!0)}closeEditModal(){this.showEditModal=!1,this.editingProductId=null}saveEditModal(){if(this.editingProductId){if(!this.editData.warrantyEndDate){this.errorMessage="Garanti biti\u015F tarihi zorunludur.";return}this.isSaving=!0,this.errorMessage="",this.successMessage="",this.productService.updateProductTenant(this.editingProductId,this.tenantId,{warrantyEndDate:this.editData.warrantyEndDate,acquisitionDate:this.editData.acquisitionDate||void 0}).subscribe({next:t=>{this.isSaving=!1,this.successMessage=t?.message||"\xDCr\xFCn bilgileri g\xFCncellendi.",this.closeEditModal(),this.loadTenantProducts()},error:t=>{this.isSaving=!1,this.errorMessage=t?.error?.message||"G\xFCncelleme s\u0131ras\u0131nda hata olu\u015Ftu."}})}}removeProduct(t){this.isSaving=!0,this.errorMessage="",this.successMessage="",this.productService.removeProductFromTenant(t,this.tenantId).subscribe({next:i=>{this.isSaving=!1,this.successMessage=i?.message||"\xDCr\xFCn m\xFC\u015Fteriden kald\u0131r\u0131ld\u0131.",this.loadTenantProducts()},error:i=>{this.isSaving=!1,this.errorMessage=i?.error?.message||"\xDCr\xFCn kald\u0131r\u0131l\u0131rken hata olu\u015Ftu."}})}toDateInput(t){if(!t)return"";let i=new Date(t);if(Number.isNaN(i.getTime()))return"";let e=i.getFullYear(),s=String(i.getMonth()+1).padStart(2,"0"),R=String(i.getDate()).padStart(2,"0");return`${e}-${s}-${R}`}static{this.\u0275fac=function(i){return new(i||o)(f(F),f(V),f(Y),f(G))}}static{this.\u0275cmp=k({type:o,selectors:[["app-tenant-products"]],standalone:!0,features:[E],decls:17,vars:6,consts:[[1,"tenant-products-page"],[1,"page-header"],["title","M\xFC\u015Fteriye D\xF6n",1,"btn","btn-secondary","btn-icon",3,"click"],[1,"header-content"],[1,"page-title"],[1,"page-subtitle"],[1,"btn","btn-primary",3,"click"],[1,"alert","alert-error"],[1,"alert","alert-success"],[1,"loading-container"],[1,"modal-overlay"],[1,"spinner"],[1,"empty-state"],[1,"table-container"],[1,"data-table"],[1,"product-name"],[1,"btn","btn-secondary","btn-sm",3,"click","disabled"],[1,"btn","btn-danger","btn-sm",3,"click","disabled"],[1,"modal-overlay",3,"click"],[1,"modal",3,"click"],[1,"modal-header"],[1,"modal-close",3,"click"],[1,"modal-body"],[1,"form-group"],[1,"form-select",3,"ngModelChange","ngModel"],[3,"ngValue"],["type","date",1,"form-input",3,"ngModelChange","ngModel"],[1,"modal-footer"],[1,"btn","btn-secondary",3,"click"],[1,"btn","btn-primary",3,"click","disabled"],["type","date",1,"date-input",3,"ngModelChange","ngModel"]],template:function(i,e){i&1&&(n(0,"div",0)(1,"div",1)(2,"button",2),g("click",function(){return e.goBack()}),a(3,"\u2190"),r(),n(4,"div",3)(5,"h1",4),a(6),r(),n(7,"p",5),a(8,"M\xFC\u015Fterinin sahip oldu\u011Fu \xFCr\xFCnleri g\xF6r\xFCnt\xFCleyin ve y\xF6netin."),r()(),n(9,"button",6),g("click",function(){return e.openAssignModal()}),a(10,"\xDCr\xFCn Ekle"),r()(),M(11,J,2,1,"div",7)(12,Q,2,1,"div",8)(13,U,4,0,"div",9)(14,tt,2,1),r(),M(15,rt,30,6,"div",10)(16,ot,21,3,"div",10)),i&2&&(d(6),C(e.tenantName||"M\xFC\u015Fteri \xDCr\xFCnleri"),d(5),p(11,e.errorMessage?11:-1),d(),p(12,e.successMessage?12:-1),d(),p(13,e.isLoading?13:14),d(2),p(15,e.showAssignModal?15:-1),d(),p(16,e.showEditModal?16:-1))},dependencies:[I,D,q,j,W,L,z,B,A,N],styles:[".tenant-products-page[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .3s ease}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}.page-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1.5rem;margin-bottom:2rem;padding-bottom:1.5rem;border-bottom:2px solid var(--border-light)}.page-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]{flex:1;min-width:0}.page-header[_ngcontent-%COMP%]   .page-title[_ngcontent-%COMP%]{font-size:1.75rem;font-weight:700;color:var(--text-primary);margin:0}.page-header[_ngcontent-%COMP%]   .page-subtitle[_ngcontent-%COMP%]{margin:0;color:var(--text-secondary);font-size:.95rem}.page-header[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]{flex-shrink:0}.btn[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:.5rem;padding:.55rem .95rem;border-radius:var(--radius-md);border:none;background:var(--bg-primary);color:var(--text-primary);cursor:pointer;font-size:.875rem;font-weight:500;transition:all .2s ease;box-shadow:0 1px 2px #0000000d}.btn[_ngcontent-%COMP%]:hover:not(:disabled){box-shadow:0 4px 12px #0000001a;transform:translateY(-1px)}.btn[_ngcontent-%COMP%]:active:not(:disabled){transform:translateY(0);box-shadow:0 1px 2px #0000000d}.btn[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.btn-primary[_ngcontent-%COMP%]{background:var(--primary-color);color:#fff;box-shadow:0 2px 4px #0a684733}.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){background:var(--primary-dark);box-shadow:0 6px 16px #0a68474d}.btn-secondary[_ngcontent-%COMP%]{background:var(--bg-primary);color:var(--text-primary);border:1px solid var(--border-color)}.btn-secondary[_ngcontent-%COMP%]:hover:not(:disabled){background:var(--bg-secondary);border-color:var(--primary-color)}.btn-danger[_ngcontent-%COMP%]{background:#dc2626;color:#fff;box-shadow:0 2px 4px #dc262633}.btn-danger[_ngcontent-%COMP%]:hover:not(:disabled){background:#b91c1c;box-shadow:0 6px 16px #dc26264d}.btn-sm[_ngcontent-%COMP%]{padding:.4rem .75rem;font-size:.75rem}.btn-icon[_ngcontent-%COMP%]{width:36px;height:36px;padding:0!important;display:flex;align-items:center;justify-content:center;font-size:1.125rem;border-radius:var(--radius-md)}.alert[_ngcontent-%COMP%]{padding:.875rem 1rem;border-radius:var(--radius-md);margin-bottom:1rem}.alert-error[_ngcontent-%COMP%]{background:#fef2f2;color:#dc2626;border:1px solid #fecaca}.alert-success[_ngcontent-%COMP%]{background:#f0fdf4;color:#16a34a;border:1px solid #bbf7d0}.date-input[_ngcontent-%COMP%]{min-width:170px;border:1px solid var(--border-color);border-radius:var(--radius-md);padding:.55rem .75rem;font-size:.875rem;color:var(--text-primary);background:var(--bg-primary)}.form-input[_ngcontent-%COMP%], .form-select[_ngcontent-%COMP%]{width:100%;border:1px solid var(--border-color);border-radius:var(--radius-md);padding:.65rem .85rem;font-size:.875rem;color:var(--text-primary);background:var(--bg-primary);transition:all .2s ease;font-family:inherit}.form-input[_ngcontent-%COMP%]:focus, .form-select[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--primary-color);box-shadow:0 0 0 3px #0a68471a;background:var(--bg-secondary)}.form-select[_ngcontent-%COMP%]{cursor:pointer}.modal-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#00000080;display:flex;align-items:center;justify-content:center;z-index:1000;padding:1rem;animation:_ngcontent-%COMP%_fadeInOverlay .2s ease}@keyframes _ngcontent-%COMP%_fadeInOverlay{0%{opacity:0}to{opacity:1}}.modal[_ngcontent-%COMP%]{width:100%;max-width:480px;background:var(--bg-secondary);border-radius:var(--radius-lg);box-shadow:0 10px 40px #0003;animation:_ngcontent-%COMP%_slideInModal .25s ease}@keyframes _ngcontent-%COMP%_slideInModal{0%{opacity:0;transform:translateY(-20px)}to{opacity:1;transform:translateY(0)}}.modal-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:1.25rem 1.5rem;border-bottom:1px solid var(--border-light);background:linear-gradient(135deg,var(--bg-secondary),var(--bg-primary))}.modal-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:1.125rem;font-weight:600;color:var(--text-primary)}.modal-close[_ngcontent-%COMP%]{background:none;border:none;font-size:1.5rem;cursor:pointer;color:var(--text-secondary);line-height:1;padding:.25rem;transition:all .15s ease;border-radius:var(--radius-md)}.modal-close[_ngcontent-%COMP%]:hover{background:var(--bg-primary);color:var(--text-primary);transform:rotate(90deg)}.modal-body[_ngcontent-%COMP%]{padding:1.5rem}.modal-footer[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;align-items:center;gap:.75rem;padding:1.25rem 1.5rem;border-top:1px solid var(--border-light);background:var(--bg-primary)}.form-group[_ngcontent-%COMP%]{margin-bottom:1.2rem}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:.5rem;font-size:.875rem;font-weight:500;color:var(--text-primary)}.loading-container[_ngcontent-%COMP%], .empty-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:3rem 1.5rem;background:var(--bg-secondary);border-radius:var(--radius-lg)}.spinner[_ngcontent-%COMP%]{width:36px;height:36px;border:3px solid var(--border-color);border-top-color:var(--primary-color);border-radius:50%;animation:_ngcontent-%COMP%_spin .8s linear infinite}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.table-container[_ngcontent-%COMP%]{background:var(--bg-secondary);border-radius:var(--radius-lg);box-shadow:var(--shadow-sm);overflow-x:auto}.data-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.data-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .data-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:1rem 1.25rem;text-align:left}.data-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-size:.75rem;font-weight:600;text-transform:uppercase;letter-spacing:.5px;color:var(--text-secondary);background:var(--bg-primary)}.data-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:.875rem;color:var(--text-primary);border-bottom:1px solid var(--border-light);vertical-align:middle}.data-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{transition:background-color .15s ease}.data-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:var(--bg-primary)}.data-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:last-child   td[_ngcontent-%COMP%]{border-bottom:none}.data-table[_ngcontent-%COMP%]   .product-name[_ngcontent-%COMP%]{font-weight:600}.data-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:last-child{display:flex;gap:.5rem;align-items:center}"]})}}return o})();export{_t as TenantProductsComponent};
