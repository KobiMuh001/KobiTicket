import{a as Z}from"./chunk-UMNY3Y7R.js";import{a as X}from"./chunk-3N6C6DMK.js";import{b as W,c as B,d as R,e as A,f as U,g as q,i as Y,j as H,k as J,n as K,r as Q}from"./chunk-ZUNVM5YC.js";import{c as L,e as G,f as D,i as j}from"./chunk-SYWROKNQ.js";import{La as M,Na as x,Sa as C,Ub as N,Va as w,Wa as S,Xa as e,Ya as i,Z as F,Za as p,ab as v,bb as y,cb as m,fa as g,ga as u,ha as f,hb as a,ia as O,ib as T,jb as E,kb as I,mb as h,nb as k,ob as P,qb as z,ua as V,ya as l,za as b}from"./chunk-CSHUE4LK.js";var $=(o,s)=>s.value,ee=(o,s)=>s.id;function te(o,s){if(o&1&&(e(0,"div",6),f(),e(1,"svg",37),p(2,"path",38)(3,"polyline",39),i(),a(4),i()),o&2){let t=m();l(4),E(" ",t.successMessage," ")}}function ne(o,s){if(o&1&&(e(0,"div",7),f(),e(1,"svg",37),p(2,"circle",40)(3,"line",41)(4,"line",42),i(),a(5),i()),o&2){let t=m();l(5),E(" ",t.errorMessage," ")}}function ie(o,s){if(o&1){let t=v();e(0,"div",26),f(),e(1,"svg",4),p(2,"path",38)(3,"polyline",39),i(),O(),e(4,"span"),a(5),i(),e(6,"button",43),y("click",function(){g(t);let n=m();return u(n.clearFile())}),a(7,"\u2715"),i()()}if(o&2){let t=m();l(5),T(t.selectedFileName)}}function oe(o,s){if(o&1&&(e(0,"div",27),p(1,"img",44),i()),o&2){let t=m();l(),x("src",t.imagePreviewUrl,V)}}function re(o,s){if(o&1&&(e(0,"option",31),a(1),i()),o&2){let t=s.$implicit;x("value",t.value),l(),T(t.label)}}function ae(o,s){o&1&&(e(0,"select",33)(1,"option"),a(2,"Y\xFCkleniyor..."),i()())}function le(o,s){if(o&1&&(e(0,"option",46),a(1),i()),o&2){let t=s.$implicit;x("ngValue",t.id),l(),I("",t.name," (",t.serialNumber,")")}}function se(o,s){if(o&1){let t=v();e(0,"select",45),P("ngModelChange",function(n){g(t);let c=m();return k(c.ticket.assetId,n)||(c.ticket.assetId=n),u(n)}),e(1,"option",46),a(2,"Varl\u0131k Se\xE7in (Opsiyonel)"),i(),w(3,le,2,3,"option",46,ee),i()}if(o&2){let t=m();h("ngModel",t.ticket.assetId),l(),x("ngValue",null),l(2),S(t.assets)}}function ce(o,s){o&1&&(p(0,"span",47),a(1," G\xF6nderiliyor... "))}function de(o,s){o&1&&(f(),e(0,"svg",4),p(1,"line",48)(2,"polygon",49),i(),a(3," Talebi G\xF6nder "))}var be=(()=>{class o{constructor(t,r,n,c){this.ticketService=t,this.assetService=r,this.router=n,this.route=c,this.ticket={title:"",description:"",priority:2,assetId:null},this.assets=[],this.isLoading=!1,this.isSubmitting=!1,this.errorMessage="",this.successMessage="",this.selectedFile=null,this.selectedFileName="",this.imagePreviewUrl=null,this.priorities=[{value:1,label:"D\xFC\u015F\xFCk"},{value:2,label:"Orta"},{value:3,label:"Y\xFCksek"},{value:4,label:"Kritik"}]}ngOnInit(){this.loadAssets(),this.route.queryParams.subscribe(t=>{t.assetId&&(this.ticket.assetId=t.assetId)})}loadAssets(){this.isLoading=!0,this.assetService.getMyAssets().subscribe({next:t=>{let r=t.data||t||[];this.assets=r.map(n=>({id:n.id,name:n.productName||n.name,serialNumber:n.serialNumber})),this.isLoading=!1},error:()=>{this.isLoading=!1}})}onSubmit(){if(!this.ticket.title||!this.ticket.description){this.errorMessage="L\xFCtfen ba\u015Fl\u0131k ve a\xE7\u0131klama alanlar\u0131n\u0131 doldurun.";return}this.isSubmitting=!0,this.errorMessage="";let t={title:this.ticket.title,description:this.ticket.description,priority:this.ticket.priority,assetId:this.ticket.assetId||void 0};this.ticketService.createTicket(t).subscribe({next:r=>{let n=r.ticketId;this.selectedFile&&n?this.uploadImage(n):(this.successMessage="Destek talebiniz ba\u015Far\u0131yla olu\u015Fturuldu!",this.isSubmitting=!1,setTimeout(()=>{this.router.navigate(["/customer/tickets"])},1500))},error:r=>{this.errorMessage=r.error?.message||"Talep olu\u015Fturulurken bir hata olu\u015Ftu.",this.isSubmitting=!1}})}onFileSelected(t){let r=t.target.files[0];if(r){if(r.size>5*1024*1024){this.errorMessage="Dosya boyutu 5MB'\u0131 ge\xE7emez.";return}if(!["image/jpeg","image/png","image/gif","image/webp"].includes(r.type)){this.errorMessage="Yaln\u0131zca JPG, PNG, GIF ve WebP dosyalar\u0131 y\xFCklenebilir.";return}this.selectedFile=r,this.selectedFileName=r.name,this.errorMessage="";let c=new FileReader;c.onload=_=>{this.imagePreviewUrl=_.target.result},c.readAsDataURL(r)}}clearFile(){this.selectedFile=null,this.selectedFileName="",this.imagePreviewUrl=null}uploadImage(t){if(!this.selectedFile)return;let r=new FormData;r.append("file",this.selectedFile),this.ticketService.uploadTicketImage(t,r).subscribe({next:()=>{this.successMessage="Destek talebiniz ve resim ba\u015Far\u0131yla y\xFCklendi!",this.isSubmitting=!1,this.clearFile(),setTimeout(()=>{this.router.navigate(["/customer/tickets"])},1500)},error:n=>{this.successMessage="Destek talebiniz olu\u015Fturuldu ancak resim y\xFCklenemedi.",this.isSubmitting=!1,setTimeout(()=>{this.router.navigate(["/customer/tickets"])},1500)}})}static{this.\u0275fac=function(r){return new(r||o)(b(X),b(Z),b(G),b(L))}}static{this.\u0275cmp=F({type:o,selectors:[["app-customer-ticket-create"]],standalone:!0,features:[z],decls:61,vars:10,consts:[["fileInput",""],[1,"customer-ticket-create"],[1,"page-header"],["routerLink","/customer/tickets",1,"back-link"],["width","18","height","18","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2"],["points","15 18 9 12 15 6"],[1,"alert","alert-success"],[1,"alert","alert-error"],[1,"form-card"],[3,"ngSubmit"],[1,"form-group"],["for","title"],[1,"required"],["type","text","id","title","name","title","placeholder","Sorununuzu k\u0131saca a\xE7\u0131klayan bir ba\u015Fl\u0131k yaz\u0131n","required","",3,"ngModelChange","ngModel"],["for","description"],["id","description","name","description","rows","6","placeholder","Sorununuzu detayl\u0131 \u015Fekilde a\xE7\u0131klay\u0131n. Ne zaman ba\u015Flad\u0131, ne s\u0131kl\u0131kla oluyor, hangi hata mesajlar\u0131n\u0131 g\xF6r\xFCyorsunuz?","required","",3,"ngModelChange","ngModel"],["for","image"],[1,"file-upload-container"],["type","file","id","image","accept","image/*",1,"file-input",3,"change"],["for","image",1,"file-upload-label"],["width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2"],["d","M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"],["points","17 8 12 3 7 8"],["x1","12","y1","3","x2","12","y2","15"],[1,"file-text"],[1,"file-hint"],[1,"file-selected"],[1,"image-preview"],[1,"form-row"],["for","priority"],["id","priority","name","priority",3,"ngModelChange","ngModel"],[3,"value"],["for","asset"],["id","asset","disabled",""],[1,"form-actions"],["routerLink","/customer/tickets",1,"btn-cancel"],["type","submit",1,"btn-submit",3,"disabled"],["width","20","height","20","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2"],["d","M22 11.08V12a10 10 0 1 1-5.93-9.14"],["points","22 4 12 14.01 9 11.01"],["cx","12","cy","12","r","10"],["x1","15","y1","9","x2","9","y2","15"],["x1","9","y1","9","x2","15","y2","15"],["type","button",1,"clear-file",3,"click"],["alt","Resim \xF6nizlemesi",3,"src"],["id","asset","name","assetId",3,"ngModelChange","ngModel"],[3,"ngValue"],[1,"spinner"],["x1","22","y1","2","x2","11","y2","13"],["points","22 2 15 22 11 13 2 9 22 2"]],template:function(r,n){if(r&1){let c=v();e(0,"div",1)(1,"div",2)(2,"a",3),f(),e(3,"svg",4),p(4,"polyline",5),i(),a(5," Geri D\xF6n "),i(),O(),e(6,"h1"),a(7,"Yeni Destek Talebi"),i(),e(8,"p"),a(9,"Yeni bir destek talebi olu\u015Fturmak i\xE7in a\u015Fa\u011F\u0131daki formu doldurun."),i()(),M(10,te,5,1,"div",6)(11,ne,6,1,"div",7),e(12,"div",8)(13,"form",9),y("ngSubmit",function(){return g(c),u(n.onSubmit())}),e(14,"div",10)(15,"label",11),a(16,"Ba\u015Fl\u0131k "),e(17,"span",12),a(18,"*"),i()(),e(19,"input",13),P("ngModelChange",function(d){return g(c),k(n.ticket.title,d)||(n.ticket.title=d),u(d)}),i()(),e(20,"div",10)(21,"label",14),a(22,"A\xE7\u0131klama "),e(23,"span",12),a(24,"*"),i()(),e(25,"textarea",15),P("ngModelChange",function(d){return g(c),k(n.ticket.description,d)||(n.ticket.description=d),u(d)}),i()(),e(26,"div",10)(27,"label",16),a(28,"Resim Ekle (Opsiyonel)"),i(),e(29,"div",17)(30,"input",18,0),y("change",function(d){return g(c),u(n.onFileSelected(d))}),i(),e(32,"label",19),f(),e(33,"svg",20),p(34,"path",21)(35,"polyline",22)(36,"line",23),i(),O(),e(37,"span",24),a(38,"Resim se\xE7mek i\xE7in t\u0131klay\u0131n veya s\xFCr\xFCkleyin"),i(),e(39,"span",25),a(40,"(JPG, PNG, GIF, WebP - Max 5MB)"),i()()(),M(41,ie,8,1,"div",26)(42,oe,2,1,"div",27),i(),e(43,"div",28)(44,"div",10)(45,"label",29),a(46,"\xD6ncelik"),i(),e(47,"select",30),P("ngModelChange",function(d){return g(c),k(n.ticket.priority,d)||(n.ticket.priority=d),u(d)}),w(48,re,2,2,"option",31,$),i()(),e(50,"div",10)(51,"label",32),a(52,"\u0130lgili Varl\u0131k (Opsiyonel)"),i(),M(53,ae,3,0,"select",33)(54,se,5,2),i()(),e(55,"div",34)(56,"a",35),a(57,"\u0130ptal"),i(),e(58,"button",36),M(59,ce,2,0)(60,de,4,0),i()()()()()}r&2&&(l(10),C(10,n.successMessage?10:-1),l(),C(11,n.errorMessage?11:-1),l(8),h("ngModel",n.ticket.title),l(6),h("ngModel",n.ticket.description),l(16),C(41,n.selectedFileName?41:-1),l(),C(42,n.imagePreviewUrl?42:-1),l(5),h("ngModel",n.ticket.priority),l(),S(n.priorities),l(5),C(53,n.isLoading?53:54),l(5),x("disabled",n.isSubmitting),l(),C(59,n.isSubmitting?59:60))},dependencies:[N,j,D,Q,q,H,J,W,Y,B,R,K,U,A],styles:[`.customer-ticket-create[_ngcontent-%COMP%]{max-width:800px;margin:0 auto}.page-header[_ngcontent-%COMP%]{margin-bottom:25px}.page-header[_ngcontent-%COMP%]   .back-link[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:6px;color:#6c757d;text-decoration:none;font-size:14px;margin-bottom:15px;transition:color .2s}.page-header[_ngcontent-%COMP%]   .back-link[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{stroke-linecap:round;stroke-linejoin:round}.page-header[_ngcontent-%COMP%]   .back-link[_ngcontent-%COMP%]:hover{color:#0a6847}.page-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:26px;font-weight:600;color:#1a1a2e;margin:0 0 6px}.page-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#6c757d;font-size:14px;margin:0}.alert[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:15px 20px;border-radius:10px;margin-bottom:20px;font-size:14px}.alert[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{flex-shrink:0;stroke-linecap:round;stroke-linejoin:round}.alert-success[_ngcontent-%COMP%]{background:#d1fae5;color:#065f46;border:1px solid #a7f3d0}.alert-error[_ngcontent-%COMP%]{background:#fee2e2;color:#991b1b;border:1px solid #fecaca}.form-card[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:30px;box-shadow:0 2px 8px #0000000f}.form-group[_ngcontent-%COMP%]{margin-bottom:22px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;font-size:14px;font-weight:500;color:#374151;margin-bottom:8px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   .required[_ngcontent-%COMP%]{color:#ef4444}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;padding:12px 15px;border:2px solid #e5e7eb;border-radius:10px;font-size:14px;font-family:inherit;transition:all .2s;background:#fff}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none;border-color:#0a6847;box-shadow:0 0 0 3px #0a68471a}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::placeholder, .form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]::placeholder, .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]::placeholder{color:#9ca3af}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:disabled, .form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:disabled, .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:disabled{background:#f3f4f6;cursor:not-allowed}.form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{resize:vertical;min-height:120px;line-height:1.5}.form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{cursor:pointer;background:#fff url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='%236b7280' stroke-width='2'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E") no-repeat right 15px center;appearance:none;padding-right:40px}.form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:20px}.file-upload-container[_ngcontent-%COMP%]{position:relative;display:block;margin-bottom:12px}.file-upload-container[_ngcontent-%COMP%]   .file-input[_ngcontent-%COMP%]{display:none}.file-upload-container[_ngcontent-%COMP%]   .file-upload-label[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;gap:12px;padding:30px;border:2px dashed #d1d5db;border-radius:10px;background:linear-gradient(135deg,#f9fafb,#f3f4f6);cursor:pointer;transition:all .3s}.file-upload-container[_ngcontent-%COMP%]   .file-upload-label[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{color:#6b7280;stroke-width:1.5}.file-upload-container[_ngcontent-%COMP%]   .file-upload-label[_ngcontent-%COMP%]   .file-text[_ngcontent-%COMP%]{font-weight:500;color:#374151;text-align:center}.file-upload-container[_ngcontent-%COMP%]   .file-upload-label[_ngcontent-%COMP%]   .file-hint[_ngcontent-%COMP%]{font-size:12px;color:#9ca3af}.file-upload-container[_ngcontent-%COMP%]   .file-upload-label[_ngcontent-%COMP%]:hover{border-color:#0a6847;background:linear-gradient(135deg,#ecfdf5,#d1fae5)}.file-upload-container[_ngcontent-%COMP%]   .file-upload-label[_ngcontent-%COMP%]:hover   svg[_ngcontent-%COMP%]{color:#0a6847}.file-upload-container[_ngcontent-%COMP%]   .file-upload-label[_ngcontent-%COMP%]:hover   .file-text[_ngcontent-%COMP%]{color:#0a6847}.file-selected[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;padding:12px 15px;background:#d1fae5;border:1px solid #a7f3d0;border-radius:8px;color:#065f46;font-size:14px;margin-bottom:12px}.file-selected[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{flex-shrink:0;stroke-linecap:round;stroke-linejoin:round}.file-selected[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{flex:1;word-break:break-word}.file-selected[_ngcontent-%COMP%]   .clear-file[_ngcontent-%COMP%]{background:none;border:none;color:#065f46;cursor:pointer;font-size:16px;padding:4px 8px;flex-shrink:0;transition:all .2s;border-radius:4px}.file-selected[_ngcontent-%COMP%]   .clear-file[_ngcontent-%COMP%]:hover{background:#065f461a}.image-preview[_ngcontent-%COMP%]{margin-top:12px;border-radius:10px;overflow:hidden;border:2px solid #e5e7eb;max-height:300px}.image-preview[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:100%;height:auto;display:block}.form-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:12px;margin-top:30px;padding-top:20px;border-top:1px solid #f1f3f4}.btn-cancel[_ngcontent-%COMP%]{display:inline-flex;align-items:center;justify-content:center;padding:12px 24px;background:#f3f4f6;color:#4b5563;border:none;border-radius:10px;font-size:14px;font-weight:500;text-decoration:none;cursor:pointer;transition:all .2s}.btn-cancel[_ngcontent-%COMP%]:hover{background:#e5e7eb}.btn-submit[_ngcontent-%COMP%]{display:inline-flex;align-items:center;justify-content:center;gap:8px;padding:12px 28px;background:linear-gradient(135deg,#0a6847,#0d8b5e);color:#fff;border:none;border-radius:10px;font-size:14px;font-weight:500;cursor:pointer;transition:all .2s}.btn-submit[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{stroke-linecap:round;stroke-linejoin:round}.btn-submit[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-1px);box-shadow:0 4px 15px #0a68474d}.btn-submit[_ngcontent-%COMP%]:disabled{opacity:.7;cursor:not-allowed}.btn-submit[_ngcontent-%COMP%]   .spinner[_ngcontent-%COMP%]{width:16px;height:16px;border:2px solid rgba(255,255,255,.3);border-top-color:#fff;border-radius:50%;animation:_ngcontent-%COMP%_spin .8s linear infinite}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}@media (max-width: 768px){.form-card[_ngcontent-%COMP%]{padding:20px}.form-row[_ngcontent-%COMP%]{grid-template-columns:1fr}.form-actions[_ngcontent-%COMP%]{flex-direction:column-reverse}.btn-cancel[_ngcontent-%COMP%], .btn-submit[_ngcontent-%COMP%]{width:100%}.file-upload-label[_ngcontent-%COMP%]{padding:20px!important}}@media (max-width: 480px){.page-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:22px}}`]})}}return o})();export{be as CustomerTicketCreateComponent};
